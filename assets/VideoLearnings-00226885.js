import{h as z,j as U,A as q,r as c,B,k as e,q as x,X as g,D as y,L as C,E as T,l as V,G as P,T as $}from"./index-1fe3a1ef.js";import{u as J}from"./index-180e19ab.js";import{u as M}from"./useVideoLearnings-3ce11622.js";import{u as G}from"./useVideoPlaylists-b6c4c69e.js";import{u as H}from"./useCategories-ec204ac9.js";import{f as S}from"./dateUtils-19c0cc10.js";import{e as R,g as X}from"./videoUtils-df590320.js";import{S as I}from"./ScrollToTopButton-906ef78e.js";import"./useMutation-31c06883.js";const le=()=>{const{settings:K,loading:E}=z(),{t:n,i18n:F}=U(),o=F.language,{data:m=[],isLoading:A}=M(),{data:u=[],isLoading:Q}=G(),f=q(),[b,k]=J({triggerOnce:!0,threshold:.1}),[d,v]=c.useState(()=>{var t;return((t=f.state)==null?void 0:t.previousTab)||"individual"}),[i,h]=c.useState("all");B(),c.useEffect(()=>{var a;const t=(a=f.state)==null?void 0:a.scrollPosition;t&&(window.scrollTo(0,t),window.history.replaceState({},document.title))},[]);const{data:p=[],isLoading:W}=H(),N=c.useMemo(()=>{const t=m||[];return i==="all"?t:t.filter(a=>{var r;return!a.categoryIds||a.categoryIds.length===0?((r=a.category)==null?void 0:r.toLowerCase())===i:a.categoryIds.some(s=>(typeof s=="string"?s:s==null?void 0:s._id)===i)})},[m,i]),w=c.useMemo(()=>{const t=u||[];return i==="all"?t:t.filter(a=>{var r;return!a.categoryIds||a.categoryIds.length===0?((r=a.category)==null?void 0:r.toLowerCase())===i:a.categoryIds.some(s=>(typeof s=="string"?s:s==null?void 0:s._id)===i)})},[u,i]),Y=E||A,j={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2}}},L={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return Y?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("section",{className:"section-padding bg-white dark:bg-dark-900 min-h-screen",children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsxs("h1",{className:"text-4xl md:text-5xl font-bold mb-4 text-gray-900 dark:text-white flex items-center justify-center gap-3",children:[e.jsx(g,{className:"text-red-600"}),n("videoLearnings.title")]}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400",children:n("videoLearnings.subtitle")})]}),e.jsxs("div",{className:"flex gap-4 mb-8 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>v("individual"),className:`px-6 py-3 font-medium transition-all ${d==="individual"?"border-b-2 border-primary-600 text-primary-600 dark:text-primary-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:n("videoLearnings.individual")}),e.jsx("button",{onClick:()=>v("playlist"),className:`px-6 py-3 font-medium transition-all ${d==="playlist"?"border-b-2 border-primary-600 text-primary-600 dark:text-primary-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:n("videoLearnings.playlist")})]}),d==="individual"&&e.jsxs("div",{ref:b,className:"flex gap-2 mb-8 overflow-x-auto pb-2",children:[e.jsxs("button",{onClick:()=>h("all"),className:`px-6 py-2 rounded-full transition-colors font-medium whitespace-nowrap ${i==="all"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-dark-700 text-dark-700 dark:text-dark-300 hover:bg-gray-300 dark:hover:bg-dark-600"}`,children:[n("videoLearnings.all")," (",m.length,")"]}),p.map(t=>{const a=m.filter(r=>!r.categoryIds||r.categoryIds.length===0?r.category===t.name:r.categoryIds.some(s=>(typeof s=="string"?s:s==null?void 0:s._id)===t._id)).length;return e.jsxs("button",{onClick:()=>h(t._id),className:`px-6 py-2 rounded-full transition-colors font-medium whitespace-nowrap ${i===t._id?"bg-primary-600 text-white":"bg-gray-200 dark:bg-dark-700 text-dark-700 dark:text-dark-300 hover:bg-gray-300 dark:hover:bg-dark-600"}`,children:[y(o,t)," (",a,")"]},t._id)})]}),d==="playlist"&&e.jsxs("div",{ref:b,className:"flex gap-2 mb-8 overflow-x-auto pb-2",children:[e.jsxs("button",{onClick:()=>h("all"),className:`px-6 py-2 rounded-full transition-colors font-medium whitespace-nowrap ${i==="all"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-dark-700 text-dark-700 dark:text-dark-300 hover:bg-gray-300 dark:hover:bg-dark-600"}`,children:[n("videoLearnings.all")," (",u.length,")"]}),p.map(t=>{const a=u.filter(r=>!r.categoryIds||r.categoryIds.length===0?r.category===t.name:r.categoryIds.some(s=>(typeof s=="string"?s:s==null?void 0:s._id)===t._id)).length;return e.jsxs("button",{onClick:()=>h(t._id),className:`px-6 py-2 rounded-full transition-colors font-medium whitespace-nowrap ${i===t._id?"bg-primary-600 text-white":"bg-gray-200 dark:bg-dark-700 text-dark-700 dark:text-dark-300 hover:bg-gray-300 dark:hover:bg-dark-600"}`,children:[y(o,t)," (",a,")"]},t._id)})]}),d==="individual"&&e.jsx(x.div,{variants:j,initial:"hidden",animate:k?"visible":"hidden",className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:N.map(t=>{const a=t.videoId||(t.videoUrl?R(t.videoUrl):null),r=a?X(a,"hqdefault"):null;return e.jsx(x.div,{variants:L,children:e.jsxs(C,{to:`/video-learnings/${t._id}`,state:{previousTab:d,scrollPosition:window.scrollY},className:"block bg-white dark:bg-dark-800 rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow border border-gray-200 dark:border-dark-700",children:[r?e.jsxs("div",{className:"relative aspect-video bg-gray-200 dark:bg-gray-700",children:[e.jsx("img",{src:r,alt:t.title,className:"w-full h-full object-cover",loading:"lazy",decoding:"async",width:"640",height:"360"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 hover:bg-black/10 transition-colors"}),e.jsx("div",{className:"absolute top-2 right-2 bg-red-600 px-2 py-1 rounded text-white text-xs font-bold",children:"YouTube"})]}):e.jsx("div",{className:"aspect-video bg-gradient-to-br from-red-400 to-pink-500 flex items-center justify-center",children:e.jsx(g,{className:"text-white text-6xl"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:t.categoryIds&&t.categoryIds.length>0?t.categoryIds.map(s=>{const l=typeof s=="string"?s:s==null?void 0:s._id,_=typeof s=="string"?p.find(D=>D._id===l):s;return _?e.jsx("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full text-sm font-medium",children:y(o,_)},l):null}):t.category&&e.jsx("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full text-sm font-medium",children:t.category})}),t.rating&&e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(s,l)=>e.jsx(T,{className:`text-sm ${l<t.rating?"text-yellow-500":"text-gray-300 dark:text-gray-600"}`},l))})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-2",children:V(o,t.title,t.titleEn,t.titleJa)}),t.purpose&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 line-clamp-2 text-sm",children:t.purpose}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"text-xs"}),e.jsx("span",{children:S(t.watchDate)})]}),t.skillIds&&t.skillIds.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"text-xs"}),e.jsxs("span",{children:[t.skillIds.length,"개 스킬"]})]})]})]})]})},t._id)})}),d==="playlist"&&e.jsx(x.div,{variants:j,initial:"hidden",animate:k?"visible":"hidden",className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:w.map(t=>e.jsx(x.div,{variants:L,children:e.jsxs(C,{to:`/video-playlists/${t._id}`,state:{previousTab:d,scrollPosition:window.scrollY},className:"block bg-white dark:bg-dark-800 rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow border border-gray-200 dark:border-dark-700",children:[e.jsxs("div",{className:"relative aspect-video bg-gradient-to-br from-purple-400 to-pink-500 flex items-center justify-center",children:[e.jsx(g,{className:"text-white text-6xl"}),e.jsx("div",{className:"absolute top-2 right-2 bg-red-600 px-2 py-1 rounded text-white text-xs font-bold",children:"재생목록"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:t.categoryIds&&t.categoryIds.length>0?t.categoryIds.map(a=>{const r=typeof a=="string"?a:a==null?void 0:a._id,s=typeof a=="string"?p.find(l=>l._id===r):a;return s?e.jsx("span",{className:"px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded-full text-sm font-medium",children:y(o,s)},r):null}):t.category&&e.jsx("span",{className:"px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded-full text-sm font-medium",children:t.category})}),t.rating&&e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(a,r)=>e.jsx(T,{className:`text-sm ${r<t.rating?"text-yellow-500":"text-gray-300 dark:text-gray-600"}`},r))})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-2",children:V(o,t.title,t.titleEn,t.titleJa)}),t.purpose&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 line-clamp-2 text-sm",children:t.purpose}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"text-xs"}),e.jsx("span",{children:S(t.watchDate)})]}),t.skillIds&&t.skillIds.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"text-xs"}),e.jsxs("span",{children:[t.skillIds.length,"개 스킬"]})]})]})]})]})},t._id))}),d==="playlist"&&w.length===0&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(g,{className:"text-6xl text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:n(i==="all"?"videoLearnings.noPlaylists":"videoLearnings.noPlaylistsInCategory")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:n("videoLearnings.addPlaylistHint")})]}),d==="individual"&&N.length===0&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(g,{className:"text-6xl text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:n(i==="all"?"videoLearnings.noVideos":"videoLearnings.noVideosInCategory")})]})]}),e.jsx(I,{})]})};export{le as default};
