import{k as e,y as Be,ai as Dt,az as Ir,aB as Pa,aC as Ja,r as d,a1 as Ne,E as Ze,a0 as xe,j as Qr,C as se,a4 as $t,V as cr,K as be,N as ie,U as Ue,q as me,aD as Dr,aE as Tr,aF as rr,aA as ct,W as Xe,I as Gt,aG as Zr,X as Qe,a2 as Xt,a3 as _a,aw as oe,aH as dt,F as $a,ak as Ua,al as Ba,ac as za,n as Va,o as qa,am as Ha,an as Oa,ao as Wa,aI as Ut,ap as gt,af as ut,Q as dr,aJ as Ve,H as ke,aK as Ka,aq as Nt,aL as Ga,G as Xa,aM as Lr,aN as qe,ay as ea,aO as Ar,aP as Ya,h as Qa,aQ as Fr,aR as Za,aS as es,aT as ts,B as rs,A as as,aU as ss}from"./index-1fe3a1ef.js";import{A as ns,v as ls,n as os,G as is,F as cs,T as ds,P as gs,a as us,f as xs,d as gr,E as hs}from"./detector-bcdba050.js";import{u as et}from"./useSkills-77227ec9.js";import{u as Bt,a as ps,b as ms}from"./useCategories-ec204ac9.js";import{L as Je}from"./LanguageTabs-5b8d5eb3.js";import{f as mt}from"./dateUtils-19c0cc10.js";import{u as ze}from"./useToast-1773be8d.js";import{d as ys}from"./useVideoLearnings-3ce11622.js";import{e as ur,g as Tt,a as bs,b as fs}from"./videoUtils-df590320.js";import{e as ks,b as vs,f as js,d as ws,g as Ns}from"./useVideoPlaylists-b6c4c69e.js";import{R as Ct}from"./RichTextEditor-fcc52ff1.js";import{u as Se}from"./useMutation-31c06883.js";const Cs=({counts:t})=>{const r={recentUpdates:[{type:"book",typeName:"책",title:"최신 도서 추가",updatedAt:new Date},{type:"project",typeName:"프로젝트",title:"새 프로젝트 완료",updatedAt:new Date},{type:"experience",typeName:"경력",title:"경력 정보 업데이트",updatedAt:new Date}],weeklyStats:{booksAdded:2,projectsCompleted:1,experiencesUpdated:3}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"관리자 설정"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"📊 콘텐츠 통계"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("button",{className:"bg-orange-50 dark:bg-orange-900/20 p-6 rounded-lg border border-orange-200 dark:border-orange-800 hover:bg-orange-100 dark:hover:bg-orange-900/30 transition-colors text-left w-full",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600 dark:text-orange-400",children:"등록된 책"}),e.jsx("p",{className:"text-3xl font-bold text-orange-900 dark:text-orange-100",children:t.books}),e.jsx("p",{className:"text-xs text-orange-500 dark:text-orange-400 mt-1",children:"권"})]}),e.jsx(Be,{className:"text-orange-500 text-3xl"})]})}),e.jsx("button",{className:"bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors text-left w-full",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:"등록된 경력"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900 dark:text-blue-100",children:t.experiences}),e.jsx("p",{className:"text-xs text-blue-500 dark:text-blue-400 mt-1",children:"개"})]}),e.jsx(Dt,{className:"text-blue-500 text-3xl"})]})}),e.jsx("button",{className:"bg-green-50 dark:bg-green-900/20 p-6 rounded-lg border border-green-200 dark:border-green-800 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors text-left w-full",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"등록된 프로젝트"}),e.jsx("p",{className:"text-3xl font-bold text-green-900 dark:text-green-100",children:t.projects}),e.jsx("p",{className:"text-xs text-green-500 dark:text-green-400 mt-1",children:"개"})]}),e.jsx(Ir,{className:"text-green-500 text-3xl"})]})})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"📊 사이트 활동"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Pa,{className:"text-purple-500 text-xl"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"최근 업데이트"})]}),e.jsx("div",{className:"space-y-3",children:r.recentUpdates.length>0?r.recentUpdates.map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s===0?"bg-green-500":s===1?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.typeName})]})]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:a.updatedAt.toLocaleDateString("ko-KR")})]},`${a.type}-${s}`)):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"최근 업데이트된 콘텐츠가 없습니다."})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Ja,{className:"text-indigo-500 text-xl"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"이번 주 활동"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:"text-orange-500"}),e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:"새로 추가된 책"})]}),e.jsx("span",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:r.weeklyStats.booksAdded})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ir,{className:"text-green-500"}),e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:"완료된 프로젝트"})]}),e.jsx("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:r.weeklyStats.projectsCompleted})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Dt,{className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:"업데이트된 경력"})]}),e.jsx("span",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:r.weeklyStats.experiencesUpdated})]})]})]})]})]})]})};function ta(t){if(!t||t.trim().length===0)return{isNotion:!1,confidence:0,features:[]};let r=0;const a=[],s=[/notion-/,/notion-page/,/notion-selectable/,/notion-table/,/notion-toggle/],n=[/data-notion/,/data-block-id/,/data-page-id/],l=[/notion\.so/,/notion-static\.com/,/secure\.notion-static\.com/,/amazonaws\.com.*notion/],o=[/<div[^>]*class="[^"]*notion[^"]*"/,/<div[^>]*data-notion/,/<span[^>]*class="[^"]*notion[^"]*"/];for(const h of s)if(h.test(t)){r+=.2,a.push("노션 클래스명 감지");break}for(const h of n)if(h.test(t)){r+=.2,a.push("노션 데이터 속성 감지");break}for(const h of l)if(h.test(t)){r+=.15,a.push("노션 이미지 URL 감지");break}for(const h of o)if(h.test(t)){r+=.1,a.push("노션 HTML 구조 감지");break}["notion-page","notion-text","notion-heading","notion-toggle","notion-table","notion-image","notion-list","notion-code"].some(h=>t.includes(`class="${h}"`)||t.includes(`data-block-type="${h}"`))&&(r+=.2,a.push("노션 블록 타입 감지"));const x=[/font-family:\s*ui-sans-serif/,/color:\s*rgb\(55,\s*53,\s*47\)/,/background-color:\s*rgb\(255,\s*255,\s*255\)/];for(const h of x)if(h.test(t)){r+=.05,a.push("노션 스타일 감지");break}return t.includes("notion")&&t.includes("page")&&(r+=.1,a.push("노션 페이지 메타데이터")),{isNotion:r>=.3,confidence:Math.min(r,1),features:a}}function Ss(t){const r=[],a=/<img[^>]+src="([^"]+)"/g;let s;for(;(s=a.exec(t))!==null;){const l=s[1];Rr(l)&&r.push(l)}const n=/background-image:\s*url\(['"]?([^'"]+)['"]?\)/g;for(;(s=n.exec(t))!==null;){const l=s[1];Rr(l)&&r.push(l)}return[...new Set(r)]}function Rr(t){return t?[/notion\.so/,/notion-static\.com/,/secure\.notion-static\.com/,/amazonaws\.com.*notion/,/s3\.us-west-2\.amazonaws\.com.*notion/].some(a=>a.test(t)):!1}function Es(t){try{const s=new DOMParser().parseFromString(t,"text/html").body.textContent||"";return s.substring(0,100)+(s.length>100?"...":"")}catch(r){return console.error("노션 미리보기 생성 실패:",r),"미리보기를 생성할 수 없습니다."}}function Is(t,r={}){const{preserveFormatting:a=!0,cleanText:s=!0}=r;let n=t.textContent||t.innerText||"";return s&&(n=n.replace(/\s+/g," ").trim()),a&&(n=Ds(t)),{type:"paragraph",data:{text:n||"빈 단락"}}}function Ds(t){let r=t.innerHTML;return r=r.replace(/<strong[^>]*>(.*?)<\/strong>/g,"**$1**").replace(/<b[^>]*>(.*?)<\/b>/g,"**$1**").replace(/<em[^>]*>(.*?)<\/em>/g,"*$1*").replace(/<i[^>]*>(.*?)<\/i>/g,"*$1*").replace(/<u[^>]*>(.*?)<\/u>/g,"__$1__").replace(/<code[^>]*>(.*?)<\/code>/g,"`$1`").replace(/<a[^>]*href="([^"]*)"[^>]*>(.*?)<\/a>/g,"[$2]($1)").replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'"),r.trim()}function Ts(t,r={}){var o;const{detectLevel:a=!0,fallbackLevel:s=2}=r;let n=s,l=((o=t.textContent)==null?void 0:o.trim())||"";return a&&(n=Ls(t)),l=As(l),{type:"header",data:{text:l||"제목",level:n}}}function Ls(t){const r=t.tagName.toLowerCase();if(["h1","h2","h3"].includes(r))return parseInt(r[1]);const a=t.className.toLowerCase();if(a.includes("h1")||a.includes("heading-1"))return 1;if(a.includes("h2")||a.includes("heading-2"))return 2;if(a.includes("h3")||a.includes("heading-3"))return 3;if(a.includes("notion-h1")||a.includes("page-title"))return 1;if(a.includes("notion-h2")||a.includes("section-title"))return 2;if(a.includes("notion-h3")||a.includes("subsection-title"))return 3;const s=window.getComputedStyle(t),n=parseFloat(s.fontSize);return n>=24?1:n>=20?2:n>=18?3:2}function As(t){return t.replace(/^#+\s*/,"").replace(/\s+/g," ").trim()}function Fs(t){const r=t.tagName.toLowerCase(),a=t.className.toLowerCase();return["h1","h2","h3","h4","h5","h6"].includes(r)?!0:["heading","title","header","notion-h1","notion-h2","notion-h3","page-title","section-title","subsection-title"].some(n=>a.includes(n))}async function Rs(t,r={}){const{folder:a="portfolio/notion",onProgress:s,timeout:n=3e4}=r;try{if(!Ms(t))return{success:!1,error:"유효하지 않은 노션 이미지 URL입니다."};const l=await Ps(t,{timeout:n});if(!l)return{success:!1,error:"노션 이미지를 가져올 수 없습니다."};const o=new File([l],"notion-image.jpg",{type:l.type}),i=await _s(o,a,s);return{success:!0,url:i.url,publicId:i.public_id}}catch(l){return console.error("노션 이미지 업로드 실패:",l),{success:!1,error:l instanceof Error?l.message:"알 수 없는 오류가 발생했습니다."}}}function Ms(t){return!t||typeof t!="string"?!1:[/notion\.so/,/notion-static\.com/,/secure\.notion-static\.com/,/amazonaws\.com.*notion/,/s3\.us-west-2\.amazonaws\.com.*notion/].some(a=>a.test(t))}async function Ps(t,r){const{timeout:a}=r;try{const s=new AbortController,n=setTimeout(()=>s.abort(),a),l=await fetch(t,{method:"GET",signal:s.signal,headers:{Accept:"image/*","User-Agent":"Mozilla/5.0 (compatible; PortfolioBot/1.0)"}});if(clearTimeout(n),!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const o=l.headers.get("content-type");if(!o||!o.startsWith("image/"))throw new Error("응답이 이미지가 아닙니다.");return await l.blob()}catch(s){if(console.error("노션 이미지 가져오기 실패:",s),s instanceof Error&&s.name==="TypeError")return await Js(t,r);throw s}}async function Js(t,r){const{timeout:a}=r;try{const s=`/api/proxy-image?url=${encodeURIComponent(t)}`,n=new AbortController,l=setTimeout(()=>n.abort(),a),o=await fetch(s,{method:"GET",signal:n.signal,credentials:"include"});if(clearTimeout(l),!o.ok)throw new Error(`프록시 요청 실패: ${o.status}`);return await o.blob()}catch(s){return console.error("프록시를 통한 노션 이미지 가져오기 실패:",s),null}}async function _s(t,r,a){const s=new FormData;s.append("image",t),s.append("folder",r);const n=await fetch("/api/upload/image",{method:"POST",body:s,credentials:"include"});if(!n.ok){const o=await n.json();throw new Error(o.message||"이미지 업로드 실패")}const l=await n.json();if(l.success!==1)throw new Error(l.message||"이미지 업로드 실패");return l.file}async function $s(t,r={}){const a=new Map,{onProgress:s}=r,n=5,l=[];for(let i=0;i<t.length;i+=n)l.push(t.slice(i,i+n));let o=0;for(const i of l){const u=i.map(async x=>{const c=await Rs(x,r);return a.set(x,c),o++,s&&s(Math.round(o/t.length*100)),c});await Promise.allSettled(u)}return a}function Us(t){const r=new Map;for(const[a,s]of t)s.success&&s.url&&r.set(a,s.url);return r}function Bs(t){if(t.tagName.toLowerCase()==="img"||t.querySelector("img"))return!0;const a=t.style.backgroundImage;if(a&&a.includes("url("))return!0;const s=t.className.toLowerCase();return!!(s.includes("notion-image")||s.includes("image-block"))}function zs(t,r={}){const{detectLevel:a=!0,preserveContent:s=!0}=r,n=Vs(t),l=a?qs(t):0,o=s?Hs(t):[];return{type:"toggle",data:{text:n||"토글 제목",items:o,level:l}}}function Vs(t){const r=[".notion-toggle__title",".toggle-title",".notion-block__content",'[data-block-type="toggle"] > div:first-child'];for(const l of r){const o=t.querySelector(l);if(o!=null&&o.textContent)return Yt(o.textContent)}const a=Os(t);if(a)return Yt(a);const n=(t.textContent||"").split(`
`)[0];return n?Yt(n):"토글 제목"}function qs(t){const r=t.className.toLowerCase();if(r.includes("notion-h1")||r.includes("toggle-h1"))return 1;if(r.includes("notion-h2")||r.includes("toggle-h2"))return 2;if(r.includes("notion-h3")||r.includes("toggle-h3"))return 3;const a=window.getComputedStyle(t),s=parseFloat(a.fontSize),n=a.fontWeight;return s>=24||n==="bold"||n==="700"?1:s>=20?2:s>=18?3:0}function Hs(t){var n;const r=[],a=[".notion-toggle__content",".toggle-content",".notion-block__children",'[data-block-type="toggle"] > div:not(:first-child)'];let s=null;for(const l of a)if(s=t.querySelector(l),s)break;if(!s){const l=Array.from(t.children);l.length>1&&(s=l.slice(1).reduce((o,i)=>(o.appendChild(i.cloneNode(!0)),o),document.createElement("div")))}if(s){const l=(n=s.textContent)==null?void 0:n.trim();l&&r.push({type:"paragraph",data:{text:l}})}return r}function Yt(t){return t.replace(/^[▶▼]\s*/,"").replace(/\s+/g," ").trim()}function Os(t){var s;const a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:n=>{var o;return((o=n.textContent)==null?void 0:o.trim())?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}).nextNode();return((s=a==null?void 0:a.textContent)==null?void 0:s.trim())||null}function Ws(t){const r=t.className.toLowerCase();return t.tagName.toLowerCase(),!!(r.includes("notion-toggle")||r.includes("toggle-block")||t.getAttribute("data-block-type")==="toggle"||(t.textContent||"").match(/^[▶▼]/))}function Ks(t,r={}){const{preserveHeaders:a=!0,maxRows:s=50,maxCols:n=10}=r,l=Gs(t,{maxRows:s,maxCols:n});return{type:"table",data:{withHeadings:a&&l.content.length>0,content:l.content}}}function Gs(t,r){const{maxRows:a,maxCols:s}=r,n=t.tagName.toLowerCase()==="table"?t:t.querySelector("table");if(!n)return{content:[["표를 찾을 수 없습니다"]]};const l=[],o=n.querySelectorAll("tr");for(let i=0;i<Math.min(o.length,a);i++){const u=o[i];if(!u)continue;const x=u.querySelectorAll("td, th"),c=[];for(let h=0;h<Math.min(x.length,s);h++){const g=x[h];if(g){const N=Xs(g.textContent||"");c.push(N)}}c.some(h=>h.trim().length>0)&&l.push(c)}return l.length===0&&l.push(["빈 표"]),{content:l}}function Xs(t){return t.replace(/\s+/g," ").replace(/\n+/g," ").trim()}function Ys(t){const r=t.tagName.toLowerCase(),a=t.className.toLowerCase();return!!(r==="table"||a.includes("notion-table")||a.includes("table-block")||t.querySelector("table"))}function Qs(t,r={}){const{preserveOrder:a=!0,maxItems:s=100}=r,n=Zs(t),l=en(t,{maxItems:s});return{type:"list",data:{style:n,items:l}}}function Zs(t){const r=t.tagName.toLowerCase(),a=t.className.toLowerCase();return r==="ol"||a.includes("ordered")||a.includes("numbered")?"ordered":r==="ul"||a.includes("unordered")||a.includes("bulleted")?"unordered":a.includes("notion-list-numbered")||a.includes("numbered-list")?"ordered":(a.includes("notion-list-bulleted")||a.includes("bulleted-list"),"unordered")}function en(t,r){const{maxItems:a}=r,s=[],n=t.querySelectorAll("li");for(let l=0;l<Math.min(n.length,a);l++){const o=n[l],i=Mr(o.textContent||"");i.trim().length>0&&s.push(i)}if(s.length===0){const o=(t.textContent||"").split(`
`).filter(i=>i.trim().length>0);for(let i=0;i<Math.min(o.length,a);i++){const u=Mr(o[i]);u.trim().length>0&&s.push(u)}}return s}function Mr(t){return t.replace(/^[\d\-\*\•]\s*/,"").replace(/\s+/g," ").trim()}function tn(t){const r=t.tagName.toLowerCase(),a=t.className.toLowerCase();return!!(["ul","ol"].includes(r)||a.includes("notion-list")||a.includes("list-block")||t.querySelectorAll("li").length>0)}async function rn(t,r={}){const{uploadImages:a=!0,folder:s="portfolio/notion",onProgress:n}=r,l=[],o=[];try{if(n==null||n({current:1,total:10,step:"노션 콘텐츠 감지 중..."}),!ta(t).isNotion)return{success:!1,blocks:[],errors:["노션 콘텐츠가 아닙니다."],imageCount:0,uploadedImages:0};n==null||n({current:2,total:10,step:"HTML 파싱 중..."});const x=new DOMParser().parseFromString(t,"text/html"),c=Array.from(x.body.children);let h=new Map,g=0,N=0;if(a){n==null||n({current:3,total:10,step:"이미지 추출 중..."});const f=Ss(t);if(g=f.length,f.length>0){n==null||n({current:4,total:10,step:`이미지 업로드 중... (${f.length}개)`});const p=await $s(f,{folder:s,onProgress:w=>{n==null||n({current:4+Math.round(w/100*3),total:10,step:`이미지 업로드 중... ${w}%`})}});h=Us(p),N=h.size}}n==null||n({current:7,total:10,step:"블록 변환 중..."});for(let f=0;f<c.length;f++){const p=c[f];try{const w=await an(p,h);w&&o.push(w)}catch(w){console.error(`요소 ${f} 변환 실패:`,w),l.push(`요소 ${f} 변환 실패: ${w instanceof Error?w.message:"알 수 없는 오류"}`)}}n==null||n({current:9,total:10,step:"최종 정리 중..."});const m=o.filter(f=>!on(f));return n==null||n({current:10,total:10,step:"완료!"}),{success:!0,blocks:m,errors:l,imageCount:g,uploadedImages:N}}catch(i){return console.error("노션 HTML 파싱 실패:",i),{success:!1,blocks:[],errors:[i instanceof Error?i.message:"알 수 없는 오류가 발생했습니다."],imageCount:0,uploadedImages:0}}}async function an(t,r){return ln(t)?null:Fs(t)?Ts(t):Bs(t)?await sn(t,r):Ws(t)?zs(t):Ys(t)?Ks(t):tn(t)?Qs(t):Is(t)}async function sn(t,r){const a=t.querySelector("img"),s=(a==null?void 0:a.src)||"",n=r.get(s)||s,l=nn(t);return{type:"image",data:{file:{url:n},caption:l||"",withBorder:!1,withBackground:!1,stretched:!1}}}function nn(t){var s;const r=[".caption",".image-caption",".notion-image-caption","figcaption"];for(const n of r){const l=t.querySelector(n);if(l!=null&&l.textContent)return l.textContent.trim()}const a=t.querySelector("img");return((s=a==null?void 0:a.alt)==null?void 0:s.trim())||""}function ln(t){var a;const r=((a=t.textContent)==null?void 0:a.trim())||"";return!!(r.length===0||r.match(/^\s*$/)||r.match(/^[\s\u00A0\u2000-\u200F\u2028-\u202F\u205F-\u206F\u3000]*$/))}function on(t){var r;switch(t.type){case"paragraph":return!t.data.text||t.data.text.trim().length===0;case"header":return!t.data.text||t.data.text.trim().length===0;case"image":return!((r=t.data.file)!=null&&r.url);case"list":return!t.data.items||t.data.items.length===0;case"table":return!t.data.content||t.data.content.length===0;case"toggle":return!t.data.text||t.data.text.trim().length===0;default:return!1}}async function cn(t,r={}){const a=await rn(t,r);return{time:Date.now(),blocks:a.blocks,version:"2.28.2"}}function dn(t,r={}){const{uploadImages:a=!0,folder:s="portfolio/notion",onProgress:n,onComplete:l,showPreview:o=!0}=r,i=t.configuration.holder;if(!i){console.error("Editor.js holder element not found");return}const u=async x=>{try{const c=x.clipboardData;if(!c)return;const h=c.getData("text/html");if(!h)return;const g=ta(h);if(!g.isNotion)return;if(x.preventDefault(),console.log("노션 콘텐츠 감지됨:",g),o){const m=Es(h);if(!await gn(m))return}n==null||n({current:1,total:10,step:"노션 콘텐츠 변환 시작..."});const N=await cn(h,{uploadImages:a,folder:s,onProgress:n});N.blocks.length>0?(await un(t,N.blocks),l==null||l({success:!0,blocksCount:N.blocks.length,errors:[]}),console.log(`노션 콘텐츠 변환 완료: ${N.blocks.length}개 블록`)):l==null||l({success:!1,blocksCount:0,errors:["변환된 블록이 없습니다."]})}catch(c){console.error("노션 붙여넣기 처리 실패:",c),l==null||l({success:!1,blocksCount:0,errors:[c instanceof Error?c.message:"알 수 없는 오류가 발생했습니다."]}),xn(x)}};return i.addEventListener("paste",u,!0),()=>{i.removeEventListener("paste",u,!0)}}async function gn(t){return new Promise(r=>{const a=`
노션 콘텐츠를 감지했습니다:

제목: ${t.title}
블록 수: ${t.blockCount}개
이미지: ${t.imageCount}개
표: ${t.hasTable?"있음":"없음"}
토글: ${t.hasToggle?"있음":"없음"}
복잡도: ${t.complexity}

이 콘텐츠를 변환하시겠습니까?
    `,s=confirm(a);r(s)})}async function un(t,r){try{const a=t.blocks.getCurrentBlockIndex();for(let n=0;n<r.length;n++){const l=r[n];await t.blocks.insert(l.type,l.data,{},a+n+1)}const s=a+r.length;t.caret.setToBlock(s,"end")}catch(a){throw console.error("블록 삽입 실패:",a),a}}function xn(t){const r=t.target;r&&r.contentEditable==="true"&&document.execCommand("paste")}function hn(){const t=document.createElement("style");t.textContent=`
    .notion-paste-progress {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      min-width: 300px;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #f0f0f0;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 8px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #4CAF50, #8BC34A);
      transition: width 0.3s ease;
    }

    .progress-text {
      font-size: 14px;
      color: #666;
      text-align: center;
    }

    .notion-paste-success {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
      border-radius: 8px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      animation: slideIn 0.3s ease;
    }

    .notion-paste-error {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
      border-radius: 8px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
  `,document.head.appendChild(t)}function pn(t,r={}){return hn(),dn(t,r)}function mn(){const[t,r]=d.useState({isUploading:!1,progress:0,error:null}),a=d.useCallback(()=>{r({isUploading:!0,progress:0,error:null})},[]),s=d.useCallback(i=>{r(u=>({...u,progress:Math.min(100,Math.max(0,i))}))},[]),n=d.useCallback(()=>{r(i=>({...i,isUploading:!1,progress:100}))},[]),l=d.useCallback(i=>{r({isUploading:!1,progress:0,error:i})},[]),o=d.useCallback(()=>{r({isUploading:!1,progress:0,error:null})},[]);return{uploadProgress:t,startUpload:a,updateProgress:s,completeUpload:n,setError:l,reset:o}}const yn=({uploadProgress:t,className:r=""})=>!t.isUploading&&!t.error?null:e.jsxs("div",{className:`upload-progress-indicator ${r}`,children:[t.isUploading&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"이미지 업로드 중..."}),e.jsxs("span",{className:"text-xs text-blue-700 dark:text-blue-300",children:[t.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${t.progress}%`}})})]})]}),t.error&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"업로드 실패"}),e.jsx("p",{className:"text-xs text-red-700 dark:text-red-300 mt-1",children:t.error})]})]})]}),te=({value:t,onChange:r,placeholder:a="내용을 입력하세요",className:s="",readOnly:n=!1})=>{const l=d.useRef(null),o=d.useRef(null),[i,u]=d.useState(!1),x=d.useRef(null),{uploadProgress:c,startUpload:h,updateProgress:g,completeUpload:N,setError:m}=mn();return d.useEffect(()=>{if(!o.current)return;const f=new ns({holder:o.current,readOnly:n,placeholder:a,tools:{header:{class:ls,config:{placeholder:"제목을 입력하세요",levels:[1,2,3],defaultLevel:2}},paragraph:{class:os,inlineToolbar:!0,config:{placeholder:"텍스트를 입력하세요"}},list:{class:is,inlineToolbar:!0,config:{defaultStyle:"unordered"}},table:{class:cs,inlineToolbar:!0,config:{rows:2,cols:3,withHeadings:!0}},toggle:{class:ds,config:{placeholder:"토글 제목을 입력하세요"}},image:{class:gs,config:{endpoints:{byFile:"/api/upload/image"},field:"image",types:"image/*",additionalRequestData:{folder:"portfolio/editorjs"},uploader:{uploadByFile:async p=>{try{h(),g(10);const w=new FormData;w.append("image",p),w.append("folder","portfolio/editorjs"),g(30);const j=await fetch("/api/upload/image",{method:"POST",body:w,credentials:"include"});if(g(70),!j.ok){const S=await j.json();throw new Error(S.error||"이미지 업로드 실패")}const E=await j.json();if(g(90),E.success===1)return N(),{success:1,file:{url:E.file.url,publicId:E.file.publicId}};throw new Error(E.error||"이미지 업로드 실패")}catch(w){console.error("이미지 업로드 실패:",w);const j=w instanceof Error?w.message:"업로드 실패";return m(j),{success:0,error:j}}}}}},code:{class:us,config:{placeholder:"코드를 입력하세요"}},checklist:{class:xs,inlineToolbar:!0}},data:t?JSON.parse(t):void 0,onChange:async p=>{try{const w=await p.saver.save();r(JSON.stringify(w))}catch(w){console.error("Editor.js 저장 오류:",w)}},onReady:()=>{u(!0),console.log("Editor.js 준비 완료"),l.current&&!n&&(x.current=pn(l.current,{uploadImages:!0,folder:"portfolio/notion",onProgress:p=>{console.log(`노션 변환 진행률: ${p.current}/${p.total} - ${p.step}`)},onComplete:p=>{p.success?console.log(`노션 콘텐츠 변환 완료: ${p.blocksCount}개 블록`):console.error("노션 콘텐츠 변환 실패:",p.errors)}}))}});return l.current=f,()=>{x.current&&(x.current(),x.current=null),l.current&&(l.current.destroy(),l.current=null)}},[n,a]),d.useEffect(()=>{if(!(!l.current||!i))try{const f=l.current.saver.save(),p=t?JSON.parse(t):{blocks:[]};JSON.stringify(f)!==JSON.stringify(p)&&l.current.render(p)}catch(f){console.error("Editor.js 데이터 업데이트 오류:",f)}},[t,i]),e.jsxs("div",{className:`editorjs-container ${s}`,children:[e.jsx("div",{ref:o,className:"editorjs-editor",style:{minHeight:"200px"}}),!i&&e.jsxs("div",{className:"editorjs-loading",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"에디터 로딩 중..."})]}),e.jsx(yn,{uploadProgress:c,className:"mt-3"})]})},bn=({data:t,onSave:r,onCancel:a,isSaving:s=!1,availableCategories:n=["PLC","데이터분석","로봇공학","IoT","기타"]})=>{const[l,o]=d.useState("ko");d.useState(!0);const{skillCategories:i,loading:u}=et(),{data:x=[],isLoading:c}=Bt(),h=t!=null&&t.readDate&&!isNaN(new Date(t.readDate).getTime())?new Date(t.readDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],g=t!=null&&t.categoryIds?t.categoryIds.map(y=>typeof y=="string"?y:y._id).filter(Boolean):[],N=t!=null&&t.skillIds?t.skillIds.map(y=>typeof y=="string"?y:y._id).filter(Boolean):[],[m,f]=d.useState(t?{title:t.title,titleEn:t.titleEn||"",titleJa:t.titleJa||"",author:t.author,authorEn:t.authorEn||"",authorJa:t.authorJa||"",category:t.category,categoryIds:g,coverImage:t.coverImage||"",readDate:h,rating:t.rating,skillIds:N,learningContent:t.learningContent||"",learningContentEn:t.learningContentEn||"",learningContentJa:t.learningContentJa||""}:{title:"",titleEn:"",titleJa:"",author:"",authorEn:"",authorJa:"",category:n[0]||"PLC",categoryIds:[],coverImage:"",readDate:h,rating:5,skillIds:[],learningContent:"",learningContentEn:"",learningContentJa:""}),p=y=>{const b=m.categoryIds||[],R=b.includes(y)?b.filter($=>$!==y):[...b,y];f({...m,categoryIds:R})},w=y=>{const b=m.skillIds||[],R=b.includes(y)?b.filter($=>$!==y):[...b,y];f({...m,skillIds:R})},j=y=>{const b=(y.skills||[]).map(V=>V._id).filter(Boolean),F=m.skillIds||[],R=b.every(V=>F.includes(V));let $;if(R)$=F.filter(V=>!b.includes(V));else{const V=new Set([...F,...b]);$=Array.from(V)}f({...m,skillIds:$})},E=()=>{switch(l){case"ko":return m.learningContent||"";case"en":return m.learningContentEn||"";case"ja":return m.learningContentJa||"";default:return""}},S=y=>{switch(l){case"ko":f({...m,learningContent:y});break;case"en":f({...m,learningContentEn:y});break;case"ja":f({...m,learningContentJa:y});break}},v=m.title.trim()!==""&&m.author.trim()!==""&&m.category.trim()!=="",T=y=>{if(y.preventDefault(),!v){alert("필수 필드(제목, 저자, 카테고리)를 모두 입력해주세요.");return}console.log("📚 서적 저장 시작:",m),console.log("🔗 선택된 스킬 IDs:",m.skillIds);const b=Array.from(new Set((m.skillIds||[]).map(J=>typeof J=="string"?J:J==null?void 0:J._id).filter(Boolean))),F=Array.from(new Set((m.categoryIds||[]).map(J=>typeof J=="string"?J:J==null?void 0:J._id).filter(Boolean))),{title:R,titleEn:$,titleJa:V,author:z,authorEn:W,authorJa:X,category:Q,coverImage:L,readDate:k,rating:_,learningContent:I,learningContentEn:P,learningContentJa:C}=m,M={title:R,titleEn:$,titleJa:V,author:z,authorEn:W,authorJa:X,category:Q,coverImage:L||"",readDate:k,rating:_,learningContent:I||"",learningContentEn:P||"",learningContentJa:C||"",skillIds:b,categoryIds:F};console.log("📤 최종 전송 데이터:",M),r(M)};return e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:t?"서적 수정":"서적 추가"}),e.jsx(Je,{activeLanguage:l,onChange:o}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["제목 ",l==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",l==="ko"?"🇰🇷 한국어":l==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),l==="ko"&&e.jsx("input",{type:"text",value:m.title,onChange:y=>f({...m,title:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"서적 제목"}),l==="en"&&e.jsx("input",{type:"text",value:m.titleEn||"",onChange:y=>f({...m,titleEn:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Book title"}),l==="ja"&&e.jsx("input",{type:"text",value:m.titleJa||"",onChange:y=>f({...m,titleJa:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"本のタイトル"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["저자 ",l==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",l==="ko"?"🇰🇷 한국어":l==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),l==="ko"&&e.jsx("input",{type:"text",value:m.author,onChange:y=>f({...m,author:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"저자 이름"}),l==="en"&&e.jsx("input",{type:"text",value:m.authorEn||"",onChange:y=>f({...m,authorEn:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Author name"}),l==="ja"&&e.jsx("input",{type:"text",value:m.authorJa||"",onChange:y=>f({...m,authorJa:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"著者名"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"카테고리 선택 📂 (다중 선택 가능)"}),m.categoryIds&&m.categoryIds.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:m.categoryIds.map(y=>{const b=x.find(F=>F._id===y);return b?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded-full text-sm",children:[b.name,e.jsx("button",{type:"button",onClick:()=>p(y),className:"hover:bg-blue-700 rounded-full p-0.5",children:e.jsx(Ne,{className:"text-xs"})})]},y):null})}),c?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"카테고리 로딩 중..."}):x.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:x.map(y=>{const b=(m.categoryIds||[]).includes(y._id);return e.jsxs("label",{className:`flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all ${b?"border-primary-600 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("input",{type:"checkbox",checked:b,onChange:()=>p(y._id),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:y.name})]},y._id)})}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'등록된 카테고리가 없습니다. 관리자 메뉴의 "카테고리 관리"에서 추가하세요.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"평점"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(y=>e.jsx("button",{type:"button",onClick:()=>f({...m,rating:y}),className:`text-2xl transition-colors ${y<=m.rating?"text-yellow-500 hover:text-yellow-600":"text-gray-300 hover:text-gray-400"}`,children:e.jsx(Ze,{})},y))}),e.jsx("input",{type:"number",min:"1",max:"5",step:"0.5",value:m.rating,onChange:y=>{const b=y.target.value,F=b===""?0:parseFloat(b);f({...m,rating:isNaN(F)?m.rating:Math.max(1,Math.min(5,F))})},className:"w-20 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"읽은 날짜"}),e.jsx("input",{type:"date",value:m.readDate,onChange:y=>f({...m,readDate:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"표지 이미지 URL"}),e.jsx("input",{type:"text",value:m.coverImage,onChange:y=>f({...m,coverImage:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"https://..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"이 서적에서 다루는 핵심 스킬 🔗"}),m.skillIds&&m.skillIds.length>0&&e.jsxs("span",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/30 px-2 py-1 rounded",children:["✓ ",m.skillIds.length,"개 선택됨"]})]}),u?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-2",children:"스킬 목록을 불러오는 중입니다..."}):i.length===0?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-4 text-center border border-gray-300 dark:border-gray-600 rounded-lg",children:"등록된 스킬이 없습니다. 먼저 스킬을 추가해주세요."}):e.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 bg-gray-50 dark:bg-gray-800 max-h-[400px] overflow-y-auto",children:i.map(y=>{const b=(y.skills||[]).map(z=>z._id).filter(Boolean),F=m.skillIds||[],R=b.filter(z=>F.includes(z)).length,$=b.length>0&&R===b.length,V=R>0&&R<b.length;return e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-gray-300 dark:border-gray-600 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded",onClick:()=>j(y),children:[e.jsx("input",{type:"checkbox",checked:$,ref:z=>{z&&(z.indeterminate=V)},onChange:()=>j(y),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",onClick:z=>z.stopPropagation()}),e.jsxs("label",{className:"font-semibold text-gray-900 dark:text-white flex-1 cursor-pointer",style:{color:y.color||"#3B82F6"},children:[y.title,R>0&&e.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-500 dark:text-gray-400",children:["(",R,"/",b.length,")"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-6",children:(y.skills||[]).map(z=>{const X=(m.skillIds||[]).includes(z._id);return e.jsxs("label",{className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors ${X?"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-700":"hover:bg-gray-100 dark:hover:bg-gray-700 border border-transparent"}`,children:[e.jsx("input",{type:"checkbox",checked:X,onChange:()=>w(z._id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:`text-sm ${X?"font-semibold text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300"}`,children:z.name})]},z._id)})})]},y._id)})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"💡 이 서적에서 주요하게 다루는 스킬을 선택하세요. 개별 학습 내용에서도 추가로 스킬을 연결할 수 있습니다."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"📚 학습 내용 (Editor.js)"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(te,{value:E(),onChange:S,placeholder:"이 책을 통해 학습한 내용을 정리해보세요...",className:"min-h-[200px]"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"💡 Editor.js 에디터를 사용하여 서식을 적용할 수 있습니다. Notion에서 복사한 내용도 자동으로 변환됩니다."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:s||!v,className:`flex-1 flex items-center justify-center gap-2 bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 rounded-lg transition-colors ${s||!v?"opacity-50 cursor-not-allowed":""}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"저장 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{})," 저장"]})}),e.jsx("button",{type:"button",onClick:a,className:"flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium py-2 rounded-lg transition-colors",children:"취소"})]})]})},fn=({chapter:t,onSave:r,onCancel:a,maxOrder:s=0})=>{const[n,l]=d.useState(""),[o,i]=d.useState(0),[u,x]=d.useState(!1);d.useEffect(()=>{t?(l(t.title),i(t.order)):(l(""),i(s))},[t,s]);const c=async h=>{if(h.preventDefault(),!n.trim()){alert("목차 제목을 입력해주세요.");return}try{x(!0),await r({title:n.trim(),order:o})}catch(g){console.error("목차 저장 실패:",g)}finally{x(!1)}};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t?"목차 수정":"목차 추가"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(Ne,{className:"text-gray-500 dark:text-gray-400"})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"목차 제목"}),e.jsx("input",{type:"text",id:"title",value:n,onChange:h=>l(h.target.value),placeholder:"목차 제목을 입력하세요",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"순서"}),e.jsx("input",{type:"number",id:"order",value:o,onChange:h=>i(parseInt(h.target.value)||0),min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{type:"submit",disabled:u||!n.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:[e.jsx(xe,{}),u?"저장 중...":t?"수정":"추가"]}),e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"취소"})]})]})]})};function kn(t){if(!t||t.trim()==="")return{blocks:[],time:Date.now(),version:"2.28.2"};const a=new DOMParser().parseFromString(t,"text/html"),s=[],n=o=>{switch(o.tagName.toLowerCase()){case"h1":s.push({type:"header",data:{text:o.textContent||"",level:1}});break;case"h2":s.push({type:"header",data:{text:o.textContent||"",level:2}});break;case"h3":s.push({type:"header",data:{text:o.textContent||"",level:3}});break;case"p":const u=o.innerHTML||o.textContent||"";u.trim()&&s.push({type:"paragraph",data:{text:u}});break;case"ul":const x=[];o.querySelectorAll("li").forEach(g=>{x.push(g.innerHTML||g.textContent||"")}),x.length>0&&s.push({type:"list",data:{style:"unordered",items:x}});break;case"ol":const c=[];o.querySelectorAll("li").forEach(g=>{c.push(g.innerHTML||g.textContent||"")}),c.length>0&&s.push({type:"list",data:{style:"ordered",items:c}});break;case"blockquote":s.push({type:"quote",data:{text:o.innerHTML||o.textContent||"",caption:"",alignment:"left"}});break;case"pre":const h=o.querySelector("code");s.push({type:"code",data:{code:h?h.textContent||"":o.textContent||""}});break;case"img":s.push({type:"image",data:{file:{url:o.getAttribute("src")||""},caption:o.getAttribute("alt")||"",withBorder:!1,withBackground:!1,stretched:!1}});break;default:o.textContent&&o.textContent.trim()&&s.push({type:"paragraph",data:{text:o.innerHTML||o.textContent||""}});break}},l=a.body;if(l){Array.from(l.children).forEach(n);const o=Array.from(l.childNodes).filter(i=>{var u;return i.nodeType===Node.TEXT_NODE&&((u=i.textContent)==null?void 0:u.trim())});if(o.length>0&&s.length===0){const i=o.map(u=>u.textContent).join("").trim();i&&s.push({type:"paragraph",data:{text:i}})}}return s.length===0&&s.push({type:"paragraph",data:{text:""}}),{blocks:s,time:Date.now(),version:"2.28.2"}}function vn(t){return!t||t.trim()===""?{blocks:[{type:"paragraph",data:{text:""}}],time:Date.now(),version:"2.28.2"}:{blocks:[{type:"paragraph",data:{text:t.trim()}}],time:Date.now(),version:"2.28.2"}}const jn=({learning:t,onSave:r,onCancel:a})=>{const[s,n]=d.useState(""),[l,o]=d.useState(""),[i,u]=d.useState(!1);d.useEffect(()=>{if(t){n(t.topic);const h=gr(t.content);if(h.type==="editorjs")o(t.content);else if(h.type==="markdown"){const g=kn(t.content);o(g)}else{const g=vn(t.content);o(g)}}else n(""),o("")},[t]);const x=h=>typeof h=="string"?h.trim():!h||!h.blocks||h.blocks.length===0?"":h.blocks.map(g=>{switch(g.type){case"paragraph":return g.data.text||"";case"header":return g.data.text||"";case"list":return g.data.items?g.data.items.join(" "):"";case"quote":return g.data.text||"";case"code":return g.data.code||"";default:return""}}).join(" ").trim(),c=async h=>{if(h.preventDefault(),!s.trim()){alert("학습 주제를 입력해주세요.");return}if(!x(l)){alert("학습 내용을 입력해주세요.");return}try{u(!0);const N=typeof l=="string"?l:JSON.stringify(l);await r({topic:s.trim(),content:N})}catch(N){console.error("학습 내용 저장 실패:",N)}finally{u(!1)}};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t?"학습 내용 수정":"학습 내용 추가"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(Ne,{className:"text-gray-500 dark:text-gray-400"})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"topic",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"학습 주제"}),e.jsx("input",{type:"text",id:"topic",value:s,onChange:h=>n(h.target.value),placeholder:"학습 주제를 입력하세요",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["학습 내용",e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Editor.js 블록 에디터 - Notion 스타일)"})]}),e.jsx("div",{className:"rich-text-editor-container",children:e.jsx(te,{value:l,onChange:o,placeholder:"학습 내용을 입력하세요...",className:"min-h-[200px]"})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{type:"submit",disabled:i||!s.trim()||!x(l),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:[e.jsx(xe,{}),i?"저장 중...":t?"수정":"추가"]}),e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"취소"})]})]})]})},wn=({chapters:t,onAddChapter:r,onEditChapter:a,onDeleteChapter:s,onAddLearning:n,onEditLearning:l,onDeleteLearning:o,isAuthenticated:i=!0})=>{const{t:u}=Qr(),[x,c]=d.useState(new Set(t.map(m=>m._id))),h=m=>{c(f=>{const p=new Set(f);return p.has(m)?p.delete(m):p.add(m),p})},g=()=>{c(new Set(t.map(m=>m._id)))},N=()=>{c(new Set)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between sticky top-0 bg-white dark:bg-gray-800 z-10 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"📚 목차별 학습 내용"}),t.length>0&&e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsx("button",{onClick:g,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline",children:"모두 펼치기"}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("button",{onClick:N,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline",children:"모두 접기"})]})]}),i&&e.jsxs("button",{onClick:r,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 text-sm shadow-md",children:[e.jsx(se,{}),"목차 추가"]})]}),t.length>0?e.jsx("div",{className:"space-y-3",children:t.sort((m,f)=>m.order-f.order).map(m=>{var w;const f=x.has(m._id),p=((w=m.learnings)==null?void 0:w.length)||0;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border-2 border-gray-200 dark:border-gray-700 shadow-sm overflow-hidden transition-all hover:shadow-md",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-700 dark:to-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("button",{onClick:()=>h(m._id),className:"flex items-center gap-3 flex-1 text-left hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"flex-shrink-0",children:f?e.jsx($t,{className:"text-blue-600 dark:text-blue-400 w-5 h-5"}):e.jsx(cr,{className:"text-gray-400 w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/50 px-2 py-0.5 rounded",children:["Chapter ",m.order+1]}),e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white text-lg truncate",children:m.title})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["📝 ",p,"개의 학습 내용"]})]})]}),i&&e.jsxs("div",{className:"flex gap-2 ml-3 flex-shrink-0",children:[e.jsx("button",{onClick:j=>{j.stopPropagation(),n(m._id)},className:"p-2 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded-lg transition-colors",title:"학습 내용 추가",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("button",{onClick:j=>{j.stopPropagation(),a(m)},className:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors",title:"목차 수정",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:j=>{j.stopPropagation(),confirm(`"${m.title}" 목차를 삭제하시겠습니까?
관련 학습 내용 ${p}개도 모두 삭제됩니다.`)&&s(m)},className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"목차 삭제",children:e.jsx(ie,{className:"w-4 h-4"})})]})]})}),f&&e.jsx("div",{className:"p-5 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-700",children:p>0?e.jsx("div",{className:"space-y-4",children:(m.learnings||[]).sort((j,E)=>new Date(E.createdAt).getTime()-new Date(j.createdAt).getTime()).map((j,E)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-lg border border-gray-200 dark:border-gray-600 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("span",{className:"flex-shrink-0 text-xs font-bold text-white bg-blue-600 dark:bg-blue-500 px-2 py-1 rounded-full",children:["#",E+1]}),e.jsx("h5",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:j.topic})]}),i&&e.jsxs("div",{className:"flex gap-1 flex-shrink-0 ml-2",children:[e.jsx("button",{onClick:()=>l(j,m._id),className:"p-1.5 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded transition-colors",title:"수정",children:e.jsx(be,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>{confirm(`"${j.topic}" 학습 내용을 삭제하시겠습니까?`)&&o(j,m._id)},className:"p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded transition-colors",title:"삭제",children:e.jsx(ie,{className:"w-3.5 h-3.5"})})]})]}),e.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert text-gray-700 dark:text-gray-300",children:(()=>gr(j.content)==="editorjs"?e.jsx(hs,{data:j.content,className:"min-h-[50px]"}):e.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert text-gray-700 dark:text-gray-300\r
                                          prose-headings:text-gray-900 dark:prose-headings:text-white\r
                                          prose-p:text-gray-700 dark:prose-p:text-gray-300\r
                                          prose-code:bg-gray-200 dark:prose-code:bg-gray-700 prose-code:text-red-600 dark:prose-code:text-red-400 prose-code:px-1 prose-code:rounded\r
                                          prose-pre:bg-gray-900 dark:prose-pre:bg-gray-950 prose-pre:text-gray-100\r
                                          prose-a:text-blue-600 dark:prose-a:text-blue-400`,dangerouslySetInnerHTML:{__html:j.content}}))()}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["📅 ",u("book.createdAt")," ",mt(j.createdAt)]}),j.updatedAt&&j.updatedAt!==j.createdAt&&e.jsxs("span",{children:["✏️ ",u("book.updatedAt")," ",mt(j.updatedAt)]})]})]},j._id))}):e.jsxs("div",{className:"text-center py-10 bg-white dark:bg-gray-800 rounded-lg border border-dashed border-gray-300 dark:border-gray-600",children:[e.jsx(Be,{className:"mx-auto text-3xl mb-3 text-gray-400 opacity-50"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-3",children:"이 목차에 아직 학습 내용이 없습니다."}),i&&e.jsxs("button",{onClick:()=>n(m._id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors inline-flex items-center gap-2",children:[e.jsx(se,{}),"첫 번째 학습 내용 추가하기"]})]})})]},m._id)})}):e.jsxs("div",{className:"text-center py-16 bg-gray-50 dark:bg-gray-800 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600",children:[e.jsx(Be,{className:"mx-auto text-5xl mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 mb-2 font-medium",children:"아직 목차가 없습니다."}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mb-6",children:"먼저 목차를 추가하고, 각 목차에 학습 내용을 기록하세요."}),i&&e.jsxs("button",{onClick:r,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors inline-flex items-center gap-2 shadow-md",children:[e.jsx(se,{}),"첫 번째 목차 추가하기"]})]})]})},Nn=({toast:t,onClose:r})=>{const a=()=>{switch(t.type){case"success":return e.jsx(rr,{className:"text-green-500"});case"error":return e.jsx(Tr,{className:"text-red-500"});case"warning":return e.jsx(Tr,{className:"text-yellow-500"});case"info":return e.jsx(Dr,{className:"text-blue-500"});default:return e.jsx(Dr,{className:"text-blue-500"})}},s=()=>{switch(t.type){case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"info":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800";default:return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-800"}};return e.jsxs(me.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.2},className:`
        relative flex items-start gap-3 p-4 rounded-lg border shadow-lg
        ${s()}
        max-w-md w-full
      `,children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.title}),t.message&&e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-300",children:t.message})]}),e.jsx("button",{onClick:()=>r(t.id),className:"flex-shrink-0 p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(Ne,{className:"w-3 h-3 text-gray-400"})})]})},ra=({toasts:t,onClose:r})=>e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.jsx(Ue,{children:t.map(a=>e.jsx(Nn,{toast:a,onClose:r},a.id))})});function aa(){var n;const t=d.useRef(null),r=d.useCallback(()=>(t.current&&t.current.abort(),t.current=new AbortController,t.current),[]),a=d.useCallback(()=>(t.current||(t.current=new AbortController),t.current),[]),s=d.useCallback(()=>{t.current&&(t.current.abort(),t.current=null)},[]);return d.useEffect(()=>()=>{t.current&&t.current.abort()},[]),{createAbortController:r,getAbortController:a,abort:s,signal:(n=t.current)==null?void 0:n.signal}}function Cn(t,r={}){const[a,s]=d.useState(t),[n,l]=d.useState(!1),o=d.useRef(t),{onSuccess:i,onError:u,onRollback:x}=r,c=d.useCallback(async(N,m)=>{o.current=a,s(f=>typeof N=="function"?N(f):N),l(!0);try{const f=await m();return s(f),l(!1),i==null||i(f),f}catch(f){s(o.current),l(!1);const p=()=>{s(o.current),x==null||x(o.current)};throw u==null||u(f,p),f}},[a,i,u,x]),h=d.useCallback(N=>{s(m=>typeof N=="function"?N(m):N)},[]),g=d.useCallback(N=>{s(N),o.current=N,l(!1)},[]);return{data:a,isOptimistic:n,optimisticUpdate:c,updateData:h,resetData:g}}function sa(t,r={}){const{data:a,isOptimistic:s,optimisticUpdate:n,updateData:l,resetData:o}=Cn(t,r),i=d.useCallback(async(h,g)=>n(N=>[...N,{...h,_id:`temp_${Date.now()}`}],async()=>{const N=await g();return l(m=>m.map(f=>f._id.startsWith("temp_")?N:f)),[...a.filter(m=>!m._id.startsWith("temp_")),N]}),[n,l,a]),u=d.useCallback(async(h,g,N)=>n(m=>m.map(f=>f._id===h?{...f,...g}:f),async()=>{const m=await N();return l(f=>f.map(p=>p._id===h?m:p)),a.map(f=>f._id===h?m:f)}),[n,l,a]),x=d.useCallback(async(h,g)=>{if(a.find(m=>m._id===h))return n(m=>m.filter(f=>f._id!==h),async()=>(await g(),a.filter(m=>m._id!==h)))},[n,a]),c=d.useCallback(async(h,g)=>n(h,async()=>await g()),[n]);return{data:a,isOptimistic:s,optimisticAdd:i,optimisticUpdateItem:u,optimisticDelete:x,optimisticReorder:c,updateData:l,resetData:o}}function Sn(){const[t,r]=d.useState(!0),[a,s]=d.useState(null),{createAbortController:n}=aa(),{success:l,error:o}=ze(),{data:i,isOptimistic:u,optimisticAdd:x,optimisticUpdateItem:c,optimisticDelete:h,resetData:g}=sa([]),N=d.useCallback(async()=>{var w;try{r(!0),s(null);const j=n(),E=await ct.getAll();j.signal.aborted||g(E.data.data||[])}catch(j){if(!((w=j.name)!=null&&w.includes("AbortError"))){const E="서적 목록을 불러오는데 실패했습니다.";s(E),o("로드 실패",E)}}finally{r(!1)}},[n,g,o]),m=d.useCallback(async w=>{try{const j={...w,_id:`temp_${Date.now()}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},E=await x(j,()=>ct.create(w).then(S=>S.data));return l("서적 추가 완료",`${w.title}이(가) 성공적으로 추가되었습니다.`),E}catch(j){throw o("서적 추가 실패",j instanceof Error?j.message:"알 수 없는 오류가 발생했습니다."),j}},[x,l,o]),f=d.useCallback(async(w,j)=>{try{const E=await c(w,j,()=>ct.update(w,j).then(S=>S.data));return l("서적 수정 완료","서적 정보가 성공적으로 수정되었습니다."),E}catch(E){throw o("서적 수정 실패",E instanceof Error?E.message:"알 수 없는 오류가 발생했습니다."),E}},[c,l,o]),p=d.useCallback(async w=>{try{const j=await h(w,()=>ct.delete(w).then(()=>{}));return l("서적 삭제 완료","서적이 성공적으로 삭제되었습니다."),j}catch(j){throw o("서적 삭제 실패",j instanceof Error?j.message:"알 수 없는 오류가 발생했습니다."),j}},[h,l,o]);return d.useEffect(()=>{N()},[]),{books:i,isLoading:t,error:a,isOptimistic:u,createBook:m,updateBook:f,deleteBook:p,refetch:N}}function zt({onSave:t,onDelete:r,onSuccess:a,onError:s}){const[n,l]=d.useState(!1),[o,i]=d.useState(null),[u,x]=d.useState(!1),[c,h]=d.useState(!1),g=d.useCallback(()=>{i(null),l(!0)},[]),N=d.useCallback(E=>{i(E),l(!0)},[]),m=d.useCallback(()=>{l(!1),i(null),x(!1),h(!1)},[]),f=d.useCallback(async E=>{if(!u)try{x(!0),await t(E,o),m(),a==null||a()}catch(S){console.error("저장 실패:",S),s==null||s(S)}finally{x(!1)}},[u,o,t,a,s,m]),p=d.useCallback(async E=>{if(!(c||!window.confirm(`정말 "${E.title||E.name||"이 항목"}"을(를) 삭제하시겠습니까?`)))try{h(!0),await r(E),a==null||a()}catch(v){console.error("삭제 실패:",v),s==null||s(v)}finally{h(!1)}},[c,r,a,s]);return[{showForm:n,editingItem:o,isSaving:u,isDeleting:c},{handleCreate:g,handleEdit:N,handleCancel:m,handleSave:f,handleDelete:p,setShowForm:l,setEditingItem:i}]}const En=({bookFilter:t="all",bookSearchTerm:r="",selectedBookCategory:a="",initialEditId:s})=>{const{books:n,isLoading:l,createBook:o,updateBook:i,deleteBook:u}=Sn(),{success:x,error:c}=ze(),{createAbortController:h}=aa(),{toasts:g,hideToast:N}=ze(),[m,f]=zt({onSave:async(A,H)=>{if(console.log("📚 BookManager - 저장 시작:",A),console.log("🔗 skillIds:",A.skillIds),H){console.log("✏️ 서적 수정 모드:",H._id);const q=await i(H._id,A);console.log("✅ 수정 결과:",q),x("서적 수정 완료","서적 정보가 성공적으로 수정되었습니다.")}else{console.log("➕ 서적 생성 모드");const q=await o(A);console.log("✅ 생성 결과:",q),x("서적 추가 완료","새로운 서적이 성공적으로 추가되었습니다.")}},onDelete:async A=>{await u(A._id),x("서적 삭제 완료",`${A.title}이(가) 삭제되었습니다.`)},onError:A=>{console.error("❌ 서적 저장 실패:",A),c("작업 실패",A.message||"알 수 없는 오류가 발생했습니다.")}}),{data:p,optimisticAdd:w,optimisticUpdateItem:j,optimisticDelete:E,resetData:S}=sa([]),[v,T]=d.useState(!1),[y,b]=d.useState(null),[F,R]=d.useState(null),[$,V]=d.useState(!1),[z,W]=d.useState(null),[X,Q]=d.useState(!1),[L,k]=d.useState(null),[_,I]=d.useState(!1);d.useEffect(()=>{if(s&&n.length>0&&!_){const A=n.find(H=>H._id===s);A&&(console.log("🎯 자동 수정 모드 활성화:",A.title),f.handleEdit(A),I(!0))}},[s,n,_,f]);const P=d.useMemo(()=>{let A=[...n];if(t==="five-star"?A=A.filter(H=>H.rating===5):t==="category"&&a&&(A=A.filter(H=>H.category===a)),r){const H=r.toLowerCase();A=A.filter(q=>q.title.toLowerCase().includes(H)||q.author.toLowerCase().includes(H)||q.category.toLowerCase().includes(H))}return A.sort((H,q)=>new Date(q.createdAt).getTime()-new Date(H.createdAt).getTime())},[n,t,r,a]),C=d.useCallback(async A=>{var H;b(A),T(!0),R(null);try{const q=h(),Z=await Xe.getByBook(A._id);q.signal.aborted||S(Z.data||[])}catch(q){(H=q.name)!=null&&H.includes("AbortError")||c("데이터 로드 실패","서적 정보를 불러오는데 실패했습니다.")}},[h,S,c]),M=d.useCallback(async A=>{if(y)try{z?(await j(z._id,A,()=>Xe.update(y._id,z._id,A).then(H=>H.data)),x("목차 수정 완료","목차가 성공적으로 수정되었습니다."),V(!1),W(null)):(await w({...A,_id:"",learnings:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},()=>Xe.create(y._id,A).then(H=>H.data)),x("목차 추가 완료","새로운 목차가 추가되었습니다."),V(!1))}catch{c("목차 작업 실패","목차 작업에 실패했습니다.")}},[y,z,w,j,x,c]),J=d.useCallback(async A=>{if(y)try{await E(A._id,()=>Xe.delete(y._id,A._id).then(()=>{})),x("목차 삭제 완료","목차가 삭제되었습니다.")}catch{c("목차 삭제 실패","목차 삭제에 실패했습니다.")}},[y,E,x,c]),G=d.useCallback(A=>{R(A),Q(!0),k(null)},[]),D=d.useCallback((A,H)=>{R(H),k(A),Q(!0)},[]),U=d.useCallback(async(A,H)=>{if(y)try{await Gt.deleteForChapter(y._id,H,A._id);const q=await Xe.getByBook(y._id);S(q.data||[]),x("학습 내용 삭제 완료","학습 내용이 삭제되었습니다.")}catch{c("학습 내용 삭제 실패","학습 내용 삭제에 실패했습니다.")}},[y,S,x,c]),B=d.useCallback(async A=>{if(!(!y||!F))try{L?(await Gt.updateForChapter(y._id,F,L._id,A),x("학습 내용 수정 완료","학습 내용이 성공적으로 수정되었습니다.")):(await Gt.createForChapter(y._id,F,A),x("학습 내용 추가 완료","새로운 학습 내용이 추가되었습니다."));const H=await Xe.getByBook(y._id);S(H.data||[]),Q(!1),k(null),R(null)}catch{c("작업 실패","학습 내용 저장에 실패했습니다.")}},[y,F,L,S,x,c]),O=A=>e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5},(H,q)=>e.jsx(Ze,{className:`text-sm ${q<A?"text-yellow-500":"text-gray-300 dark:text-gray-600"}`},q))});return l?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs(e.Fragment,{children:[e.jsx(ra,{toasts:g,onClose:N}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"서적 관리"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["총 ",P.length,"권의 서적"]})]}),e.jsxs("button",{onClick:f.handleCreate,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[e.jsx(se,{}),"서적 추가"]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:P.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Be,{className:"text-6xl text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-2",children:"등록된 서적이 없습니다"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:"상단의 '서적 추가' 버튼을 눌러 새로운 서적을 등록하세요"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"서적 정보"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"저자"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"카테고리"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"평점"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"읽은 날짜"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"관리"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:P.map(A=>{var H;return e.jsxs("tr",{onClick:()=>C(A),className:"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[A.coverImage?e.jsx("img",{src:A.coverImage,alt:A.title,className:"w-12 h-16 object-cover rounded shadow-sm"}):e.jsx("div",{className:"w-12 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded flex items-center justify-center shadow-sm",children:e.jsx(Be,{className:"text-white text-lg"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:A.title}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[((H=A.learnings)==null?void 0:H.length)||0,"개의 학습 내용"]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-300",children:A.author})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:A.category})}),e.jsx("td",{className:"px-6 py-4",children:O(A.rating)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-300",children:mt(A.readDate)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:q=>{q.stopPropagation(),C(A)},className:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900 rounded-lg transition-colors",title:"상세보기",children:e.jsx(Zr,{})}),e.jsx("button",{onClick:q=>{q.stopPropagation(),f.handleEdit(A)},className:"p-2 text-yellow-600 hover:bg-yellow-100 dark:hover:bg-yellow-900 rounded-lg transition-colors",title:"수정",children:e.jsx(be,{})}),e.jsx("button",{onClick:q=>{q.stopPropagation(),f.handleDelete(A)},disabled:m.isDeleting,className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-lg transition-colors disabled:opacity-50",title:"삭제",children:e.jsx(ie,{})})]})})]},A._id)})})]})})}),m.showForm&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:m.editingItem?"서적 수정":"서적 추가"}),e.jsx("button",{onClick:f.handleCancel,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(Ne,{})})]}),e.jsx(bn,{data:m.editingItem,onSave:f.handleSave,onCancel:f.handleCancel,isSaving:m.isSaving})]})})}),v&&y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-6xl w-full max-h-[90vh] flex flex-col shadow-2xl",children:[e.jsx("div",{className:"flex-shrink-0 border-b border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[y.coverImage?e.jsx("img",{src:y.coverImage,alt:y.title,className:"w-20 h-28 object-cover rounded shadow-lg flex-shrink-0"}):e.jsx("div",{className:"w-20 h-28 bg-gradient-to-br from-blue-400 to-blue-600 rounded flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx(Be,{className:"text-white text-2xl"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2 truncate",children:y.title}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:["저자: ",y.author]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:y.category}),O(y.rating)]})]})]}),e.jsx("button",{onClick:()=>{T(!1),R(null)},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors flex-shrink-0",children:e.jsx(Ne,{className:"text-xl"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx(wn,{chapters:p,onAddChapter:()=>{V(!0),W(null)},onEditChapter:A=>{W(A),V(!0)},onDeleteChapter:J,onAddLearning:G,onEditLearning:D,onDeleteLearning:U,isAuthenticated:!0})})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[60]",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full mx-4 shadow-2xl",children:e.jsx(fn,{chapter:z,onSave:M,onCancel:()=>{V(!1),W(null)}})})}),X&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:e.jsx(jn,{learning:L,onSave:B,onCancel:()=>{Q(!1),k(null),R(null)}})})})]})]})},xr=({checked:t,onChange:r,disabled:a=!1,className:s=""})=>e.jsx("div",{className:`editor-switch ${s}`,children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:n=>r(n.target.checked),disabled:a,className:"sr-only"}),e.jsx("div",{className:`w-12 h-6 rounded-full transition-colors duration-200 ${t?"bg-blue-600":"bg-gray-300"} ${a?"opacity-50":""}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 ${t?"transform translate-x-6":""}`})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-sm font-medium ${t?"text-blue-600":"text-gray-600"}`,children:t?"✨ Editor.js (노션 스타일)":"📝 마크다운"}),e.jsx("span",{className:"text-xs text-gray-500",children:t?"노션에서 복사-붙여넣기 지원":"기존 마크다운 에디터"})]})]})}),hr=({show:t,onConfirm:r,onCancel:a,title:s="에디터 변경",message:n="에디터를 변경하면 현재 편집 중인 내용이 사라질 수 있습니다. 계속하시겠습니까?"})=>t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-sm text-gray-600",children:n})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"취소"}),e.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"변경"})]})]})}):null,pr=({show:t,current:r,total:a,step:s,onCancel:n})=>{if(!t)return null;const l=a>0?Math.round(r/a*100):0;return e.jsxs("div",{className:"fixed top-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50 min-w-80",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"노션 이미지 업로드"}),n&&e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:s}),e.jsxs("span",{children:[r,"/",a]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${l}%`}})})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l,"% 완료"]})]})},In=({data:t,onSave:r,onCancel:a,isSaving:s=!1,availableCategories:n=["PLC","데이터분석","로봇공학","IoT","기타"]})=>{const[l,o]=d.useState(!0),[i,u]=d.useState(!1),[x,c]=d.useState(null),[h,g]=d.useState({show:!1,current:0,total:0,step:""}),{skillCategories:N,loading:m}=et(),{data:f=[],isLoading:p}=Bt(),w=t!=null&&t.watchDate&&!isNaN(new Date(t.watchDate).getTime())?new Date(t.watchDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],[j,E]=d.useState(()=>t!=null&&t.videoId?`https://www.youtube.com/watch?v=${t.videoId}`:t!=null&&t.videoUrl?t.videoUrl:""),S=t!=null&&t.skillIds?t.skillIds.map(C=>typeof C=="string"?C:C._id).filter(Boolean):[],v=t!=null&&t.categoryIds?t.categoryIds.map(C=>typeof C=="string"?C:C._id).filter(Boolean):[];console.log("🎬 VideoLearningForm 초기화:",{hasData:!!t,rawSkillIds:t==null?void 0:t.skillIds,extractedSkillIds:S,rawCategoryIds:t==null?void 0:t.categoryIds,extractedCategoryIds:v});const[T,y]=d.useState("ko"),[b,F]=d.useState(t?{title:t.title,titleEn:t.titleEn||"",titleJa:t.titleJa||"",description:t.description||"",descriptionEn:t.descriptionEn||"",descriptionJa:t.descriptionJa||"",category:t.category,categoryIds:v,watchDate:w,rating:t.rating||3,purpose:t.purpose||"",purposeEn:t.purposeEn||"",purposeJa:t.purposeJa||"",keyTakeaways:t.keyTakeaways||"",keyTakeawaysEn:t.keyTakeawaysEn||"",keyTakeawaysJa:t.keyTakeawaysJa||"",application:t.application||"",applicationEn:t.applicationEn||"",applicationJa:t.applicationJa||"",skillIds:S,order:t.order||0}:{title:"",titleEn:"",titleJa:"",description:"",descriptionEn:"",descriptionJa:"",category:n[0]||"PLC",categoryIds:[],watchDate:w,rating:3,purpose:"",purposeEn:"",purposeJa:"",keyTakeaways:"",keyTakeawaysEn:"",keyTakeawaysJa:"",application:"",applicationEn:"",applicationJa:"",skillIds:[],order:0}),R=d.useMemo(()=>{const C=ur(j);return console.log("🎬 VideoForm: URL 파싱 결과 -",{inputUrl:j,extractedId:C}),C},[j]),$=d.useMemo(()=>R?Tt(R):null,[R]),V=d.useMemo(()=>R!==null,[R]),z=C=>{const M=b.categoryIds||[],G=M.includes(C)?M.filter(D=>D!==C):[...M,C];F({...b,categoryIds:G})},W=C=>{const M=b.skillIds||[],G=M.includes(C)?M.filter(D=>D!==C):[...M,C];F({...b,skillIds:G})},X=C=>{const M=(C.skills||[]).map(U=>U._id).filter(Boolean),J=b.skillIds||[],G=M.every(U=>J.includes(U));let D;if(G)D=J.filter(U=>!M.includes(U));else{const U=new Set([...J,...M]);D=Array.from(U)}F({...b,skillIds:D})},Q=C=>{var J;((J=b.keyTakeaways)==null?void 0:J.trim().length)>0?(c(C),u(!0)):o(C)},L=()=>{x!==null&&(o(x),c(null)),u(!1)},k=()=>{c(null),u(!1)},_=C=>{if(C.preventDefault(),!b.title.trim()||!j.trim()){alert("필수 필드(제목, 영상 URL)를 모두 입력해주세요.");return}if(!V||!R){alert("❌ 올바른 유튜브 URL을 입력해주세요.");return}console.log("📹 영상 학습 저장 시작:",b),console.log("🎬 추출된 영상 ID:",R),console.log("🔗 선택된 스킬 IDs:",b.skillIds);const{title:M,titleEn:J,titleJa:G,description:D,descriptionEn:U,descriptionJa:B,category:O,categoryIds:A,watchDate:H,rating:q,purpose:Z,purposeEn:Y,purposeJa:ee,keyTakeaways:ve,keyTakeawaysEn:He,keyTakeawaysJa:Oe,application:$e,applicationEn:he,applicationJa:Te,skillIds:Ee,order:wt}=b;r({title:M,titleEn:J,titleJa:G,description:D,descriptionEn:U,descriptionJa:B,videoId:R,category:O,categoryIds:A,watchDate:H,...q!==void 0&&{rating:q},purpose:Z,purposeEn:Y,purposeJa:ee,keyTakeaways:ve,keyTakeawaysEn:He,keyTakeawaysJa:Oe,application:$e,applicationEn:he,applicationJa:Te,skillIds:Ee||[],order:wt||0})},I=b.title.trim()&&j.trim()&&V,P=()=>Array.from({length:5},(C,M)=>{const J=M+1;return e.jsx("button",{type:"button",onClick:()=>F({...b,rating:J}),className:`text-3xl transition-colors ${J<=(b.rating||0)?"text-yellow-500 hover:text-yellow-600":"text-gray-300 dark:text-gray-600 hover:text-gray-400"}`,children:e.jsx(Ze,{})},M)});return e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700 pb-2",children:[e.jsx("button",{type:"button",onClick:()=>y("ko"),className:`px-4 py-2 rounded-t-lg font-medium transition-colors ${T==="ko"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"🇰🇷 한국어"}),e.jsx("button",{type:"button",onClick:()=>y("en"),className:`px-4 py-2 rounded-t-lg font-medium transition-colors ${T==="en"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"🇺🇸 English"}),e.jsx("button",{type:"button",onClick:()=>y("ja"),className:`px-4 py-2 rounded-t-lg font-medium transition-colors ${T==="ja"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"🇯🇵 日本語"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["제목 ",T==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),T==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:" (Optional)"}),T==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:" (任意)"})]}),T==="ko"&&e.jsx("input",{type:"text",value:b.title,onChange:C=>F({...b,title:C.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"영상 제목을 입력하세요",required:!0}),T==="en"&&e.jsx("input",{type:"text",value:b.titleEn,onChange:C=>F({...b,titleEn:C.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter video title in English"}),T==="ja"&&e.jsx("input",{type:"text",value:b.titleJa,onChange:C=>F({...b,titleJa:C.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"日本語でビデオタイトルを入力してください"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["설명 ",T==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),T==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),T==="ko"&&e.jsx("textarea",{value:b.description,onChange:C=>F({...b,description:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"영상에 대한 간단한 설명을 입력하세요..."}),T==="en"&&e.jsx("textarea",{value:b.descriptionEn,onChange:C=>F({...b,descriptionEn:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"Enter a brief description of the video..."}),T==="ja"&&e.jsx("textarea",{value:b.descriptionJa,onChange:C=>F({...b,descriptionJa:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"ビデオの簡単な説明を入力してください..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["영상 URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:j,onChange:C=>E(C.target.value),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white ${j&&!V?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"https://www.youtube.com/watch?v=...",required:!0}),j&&!V&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"올바른 유튜브 URL을 입력해주세요"}),R&&e.jsxs("p",{className:"text-green-600 text-sm mt-1",children:["✅ 영상 ID: ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:R})]}),$&&V&&e.jsxs("div",{className:"mt-3",children:[e.jsx("img",{src:$,alt:"영상 썸네일",className:"w-full max-w-md rounded-lg shadow-md",onError:C=>{const M=C.target;M.src.includes("maxresdefault")&&(M.src=Tt(R,"hqdefault"))}}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-2",children:"✓ 유효한 유튜브 URL"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"카테고리 선택 📂 (다중 선택 가능)"}),b.categoryIds&&b.categoryIds.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:b.categoryIds.map(C=>{const M=f.find(J=>J._id===C);return M?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded-full text-sm",children:[M.name,e.jsx("button",{type:"button",onClick:()=>z(C),className:"hover:bg-blue-700 rounded-full p-0.5",children:e.jsx(Ne,{className:"text-xs"})})]},C):null})}),p?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"카테고리 로딩 중..."}):f.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:f.map(C=>{const M=(b.categoryIds||[]).includes(C._id);return e.jsxs("label",{className:`flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all ${M?"border-primary-600 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("input",{type:"checkbox",checked:M,onChange:()=>z(C._id),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:C.name})]},C._id)})}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'등록된 카테고리가 없습니다. 관리자 메뉴의 "카테고리 관리"에서 추가하세요.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"시청 날짜"}),e.jsx("input",{type:"date",value:b.watchDate,onChange:C=>F({...b,watchDate:C.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"이해도 평점"}),e.jsxs("div",{className:"flex items-center gap-2",children:[P(),e.jsxs("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:[b.rating,"/5"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["시청 목적 ",T==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),T==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),T==="ko"&&e.jsx("textarea",{value:b.purpose,onChange:C=>F({...b,purpose:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"이 영상을 왜 시청했는지, 어떤 문제를 해결하기 위해서인지 작성하세요..."}),T==="en"&&e.jsx("textarea",{value:b.purposeEn,onChange:C=>F({...b,purposeEn:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"Why did you watch this video and what problem were you trying to solve..."}),T==="ja"&&e.jsx("textarea",{value:b.purposeJa,onChange:C=>F({...b,purposeJa:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"このビデオを視聴した理由と解決しようとした問題を書いてください..."}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"최대 1000자"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["핵심 배움 ",T==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),T==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),e.jsx(xr,{checked:l,onChange:Q,disabled:s})]}),e.jsxs("div",{className:"space-y-3",children:[l?e.jsxs(e.Fragment,{children:[T==="ko"&&e.jsx(te,{value:b.keyTakeaways||"",onChange:C=>F({...b,keyTakeaways:C}),placeholder:"영상에서 얻은 핵심 지식 3-5가지를 정리하세요...",className:"min-h-[200px]"}),T==="en"&&e.jsx(te,{value:b.keyTakeawaysEn||"",onChange:C=>F({...b,keyTakeawaysEn:C}),placeholder:"Summarize 3-5 key learnings from the video...",className:"min-h-[200px]"}),T==="ja"&&e.jsx(te,{value:b.keyTakeawaysJa||"",onChange:C=>F({...b,keyTakeawaysJa:C}),placeholder:"ビデオから得た重要な学び3～5つをまとめてください...",className:"min-h-[200px]"})]}):e.jsxs(e.Fragment,{children:[T==="ko"&&e.jsx(te,{value:b.keyTakeaways||"",onChange:C=>F({...b,keyTakeaways:C}),placeholder:"영상에서 얻은 핵심 지식 3-5가지를 정리하세요...",className:"min-h-[200px]"}),T==="en"&&e.jsx(te,{value:b.keyTakeawaysEn||"",onChange:C=>F({...b,keyTakeawaysEn:C}),placeholder:"Summarize 3-5 key learnings from the video...",className:"min-h-[200px]"}),T==="ja"&&e.jsx(te,{value:b.keyTakeawaysJa||"",onChange:C=>F({...b,keyTakeawaysJa:C}),placeholder:"ビデオから得た重要な学び3～5つをまとめてください...",className:"min-h-[200px]"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["💡 ",l?"Editor.js":"마크다운"," 에디터를 사용하여 서식을 적용할 수 있습니다.",l&&" Notion에서 복사한 내용도 자동으로 변환됩니다.",!l&&" 타임스탬프 형식: [MM:SS] 또는 [H:MM:SS]"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["적용 계획 (마크다운 지원) ",T==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),T==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),T==="ko"&&e.jsx("textarea",{value:b.application,onChange:C=>F({...b,application:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical font-mono text-sm",rows:5,placeholder:"이 지식을 어떻게 활용할 계획인지, 또는 이미 적용한 경험을 작성하세요..."}),T==="en"&&e.jsx("textarea",{value:b.applicationEn,onChange:C=>F({...b,applicationEn:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical font-mono text-sm",rows:5,placeholder:"How do you plan to apply this knowledge, or describe experiences where you've already applied it..."}),T==="ja"&&e.jsx("textarea",{value:b.applicationJa,onChange:C=>F({...b,applicationJa:C.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical font-mono text-sm",rows:5,placeholder:"この知識をどのように活用する予定か、またはすでに適用した経験を書いてください..."}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"최대 3000자"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"관련 기술 연동 🔗"}),m?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-2",children:"스킬 목록을 불러오는 중입니다..."}):e.jsxs(e.Fragment,{children:[(b.skillIds||[]).length>0&&e.jsx("div",{className:"mb-3 px-3 py-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("span",{className:"text-sm text-blue-700 dark:text-blue-300 font-medium",children:["✓ ",(b.skillIds||[]).length,"개 선택됨"]})}),e.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 max-h-[400px] overflow-y-auto bg-gray-50 dark:bg-gray-800/50",children:N.map(C=>{const M=C.skills||[],J=M.map(B=>B._id).filter(Boolean),G=J.filter(B=>(b.skillIds||[]).includes(B)),D=J.length>0&&G.length===J.length,U=G.length>0&&!D;return e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsxs("div",{onClick:()=>X(C),className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors mb-2",children:[e.jsx("input",{type:"checkbox",checked:D,ref:B=>{B&&(B.indeterminate=U)},onChange:()=>{},className:"w-5 h-5 text-primary-600 rounded focus:ring-2 focus:ring-primary-500"}),e.jsxs("label",{className:"font-bold text-base cursor-pointer flex-1",style:{color:C.color||"#3B82F6"},children:[C.title," (",G.length,"/",M.length,")"]})]}),e.jsx("div",{className:"ml-8 space-y-2",children:M.map(B=>{const O=(b.skillIds||[]).includes(B._id);return e.jsxs("div",{onClick:()=>W(B._id),className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-all ${O?"bg-blue-100 dark:bg-blue-900/30 font-medium":"hover:bg-gray-100 dark:hover:bg-gray-600"}`,children:[e.jsx("input",{type:"checkbox",checked:O,onChange:()=>{},className:"w-4 h-4 text-primary-600 rounded focus:ring-2 focus:ring-primary-500"}),e.jsx("label",{className:"cursor-pointer flex-1 text-sm",style:{color:O?B.color:void 0},children:B.name})]},B._id)})})]},C._id)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"순서 (낮을수록 먼저 표시)"}),e.jsx("input",{type:"number",value:b.order,onChange:C=>F({...b,order:parseInt(C.target.value)||0}),className:"w-32 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0"})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs("button",{type:"submit",disabled:s||!I||!V,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:[e.jsx(xe,{})," ",s?"저장 중...":"저장"]}),e.jsx("button",{type:"button",onClick:a,className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"취소"})]}),h.show&&e.jsx(pr,{current:h.current,total:h.total,step:h.step}),e.jsx(hr,{isOpen:i,onConfirm:L,onCancel:k,fromEditor:l?"Editor.js":"마크다운",toEditor:x?"Editor.js":"마크다운"})]})},Dn=t=>{const r=new Set;return r.add("all"),t.forEach(a=>{a.category&&r.add(a.category.toLowerCase())}),Array.from(r).sort()},Tn=({initialEditId:t})=>{const{success:r,error:a}=ze(),{videoLearnings:s,isLoading:n,createVideoLearning:l,updateVideoLearning:o,deleteVideoLearning:i}=ys(),[u,x]=zt({onSave:async(p,w)=>{if(console.log("📹 VideoLearningManager - 저장 시작:",p),console.log("🔗 skillIds:",p.skillIds),w){console.log("✏️ 영상 학습 수정 모드:",w._id);const j=await o(w._id,p);console.log("✅ 수정 결과:",j),j.success&&r("영상 학습 수정 완료","영상 학습 정보가 성공적으로 수정되었습니다.")}else{console.log("➕ 영상 학습 생성 모드");const j=await l(p);console.log("✅ 생성 결과:",j),j.success&&r("영상 학습 추가 완료","새로운 영상 학습이 성공적으로 추가되었습니다.")}},onDelete:async p=>{await i(p._id),r("영상 학습 삭제 완료",`${p.title}이(가) 삭제되었습니다.`)},onError:p=>{a("작업 실패",p.message||"알 수 없는 오류가 발생했습니다.")}}),[c,h]=d.useState("all"),[g,N]=d.useState(!1),m=d.useMemo(()=>Dn(s),[s]),f=d.useMemo(()=>c==="all"?s:s.filter(p=>p.category===c),[s,c]);return d.useEffect(()=>{if(t&&s.length>0&&!g){const p=s.find(w=>w._id===t);p&&(console.log("🎯 자동 수정 모드 활성화:",p.title),x.handleEdit(p),N(!0))}},[t,s,g,x]),n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Qe,{className:"text-red-600"})," 영상 학습 관리"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"유튜브 영상을 통한 학습 기록을 관리합니다"})]}),!u.showForm&&e.jsxs("button",{onClick:x.handleCreate,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(se,{})," 새 영상 추가"]})]}),!u.showForm&&m.length>0&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>h("all"),className:`px-4 py-2 rounded-lg transition-colors font-medium ${c==="all"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:["전체 (",s.length,")"]}),m.map(p=>{const w=s.filter(j=>j.category===p).length;return e.jsxs("button",{onClick:()=>h(p),className:`px-4 py-2 rounded-lg transition-colors font-medium ${c===p?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:[p," (",w,")"]},p)})]}),u.showForm&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6",children:u.editingItem?"영상 학습 수정":"새 영상 학습 추가"}),e.jsx(In,{data:u.editingItem||void 0,onSave:x.handleSave,onCancel:x.handleCancel,isSaving:u.isSaving,availableCategories:m})]}),!u.showForm&&e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(p=>{const w=p.videoId,j=w?Tt(w,"hqdefault"):null;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow",children:[j&&e.jsxs("div",{className:"relative aspect-video bg-gray-200 dark:bg-gray-700",children:[e.jsx("img",{src:j,alt:p.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2 bg-black/70 px-2 py-1 rounded text-white text-xs font-medium",children:"YouTube"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded text-xs font-medium",children:p.category}),p.rating&&e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(E,S)=>e.jsx(Ze,{className:`text-xs ${S<p.rating?"text-yellow-500":"text-gray-300 dark:text-gray-600"}`},S))})]}),e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white mb-2 line-clamp-2",children:p.title}),p.purpose&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:p.purpose}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-4",children:[e.jsx("span",{children:mt(p.watchDate)}),p.skillIds&&p.skillIds.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:["스킬 ",p.skillIds.length,"개"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>x.handleEdit(p),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(be,{})," 수정"]}),e.jsxs("button",{onClick:()=>x.handleDelete(p),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(ie,{})," 삭제"]})]})]})]},p._id)})}),!u.showForm&&f.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Qe,{className:"text-6xl text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-4",children:c==="all"?"아직 등록된 영상 학습이 없습니다":`${c} 카테고리에 영상 학습이 없습니다`}),e.jsxs("button",{onClick:x.handleCreate,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(se,{})," 첫 영상 추가하기"]})]})]})},Pr=({data:t,onSave:r,onCancel:a,isSaving:s=!1,availableCategories:n=["PLC","데이터분석","로봇공학","IoT","기타"]})=>{const[l,o]=d.useState(!0),[i,u]=d.useState(!1),[x,c]=d.useState(null),[h,g]=d.useState({show:!1,current:0,total:0,step:""}),{skillCategories:N,loading:m}=et(),{data:f=[],isLoading:p}=Bt(),w=t!=null&&t.watchDate&&!isNaN(new Date(t.watchDate).getTime())?new Date(t.watchDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],[j,E]=d.useState(()=>t!=null&&t.playlistId?`https://www.youtube.com/playlist?list=${t.playlistId}`:""),S=t!=null&&t.categoryIds?t.categoryIds.map(I=>typeof I=="string"?I:I._id).filter(Boolean):[],[v,T]=d.useState("ko"),[y,b]=d.useState(t?{title:t.title,titleEn:t.titleEn||"",titleJa:t.titleJa||"",description:t.description||"",descriptionEn:t.descriptionEn||"",descriptionJa:t.descriptionJa||"",category:t.category,categoryIds:S,watchDate:w,rating:t.rating||3,purpose:t.purpose||"",purposeEn:t.purposeEn||"",purposeJa:t.purposeJa||"",application:t.application||"",applicationEn:t.applicationEn||"",applicationJa:t.applicationJa||"",keyTakeaways:t.keyTakeaways||"",keyTakeawaysEn:t.keyTakeawaysEn||"",keyTakeawaysJa:t.keyTakeawaysJa||"",skillIds:(t.skillIds||[]).map(I=>typeof I=="string"?I:I._id).filter(Boolean),order:t.order||0}:{title:"",titleEn:"",titleJa:"",description:"",descriptionEn:"",descriptionJa:"",category:n[0]||"PLC",categoryIds:[],watchDate:w,rating:3,purpose:"",purposeEn:"",purposeJa:"",application:"",applicationEn:"",applicationJa:"",keyTakeaways:"",keyTakeawaysEn:"",keyTakeawaysJa:"",skillIds:[],order:0}),F=d.useMemo(()=>{const I=bs(j);return console.log("🎬 PlaylistForm: URL 파싱 결과 -",{inputUrl:j,extractedId:I}),I},[j]);d.useMemo(()=>F?fs():null,[F]);const R=d.useMemo(()=>F!==null,[F]),$=I=>{const P=y.categoryIds||[],M=P.includes(I)?P.filter(J=>J!==I):[...P,I];b({...y,categoryIds:M})},V=I=>{const P=y.skillIds||[],M=P.includes(I)?P.filter(J=>J!==I):[...P,I];b({...y,skillIds:M})},z=I=>{Q().trim().length>0?(c(I),u(!0)):o(I)},W=()=>{x!==null&&(o(x),c(null)),u(!1)},X=()=>{c(null),u(!1)},Q=()=>{switch(v){case"ko":return y.keyTakeaways||"";case"en":return y.keyTakeawaysEn||"";case"ja":return y.keyTakeawaysJa||"";default:return""}},L=I=>{if(I.preventDefault(),!y.title.trim()||!j.trim()){alert("필수 필드(제목, 재생 목록 URL)를 모두 입력해주세요.");return}if(!R||!F){alert("❌ 올바른 유튜브 재생 목록 URL을 입력해주세요.");return}const{title:P,titleEn:C,titleJa:M,description:J,descriptionEn:G,descriptionJa:D,category:U,categoryIds:B,watchDate:O,rating:A,purpose:H,purposeEn:q,purposeJa:Z,application:Y,applicationEn:ee,applicationJa:ve,keyTakeaways:He,keyTakeawaysEn:Oe,keyTakeawaysJa:$e,skillIds:he,order:Te}=y,Ee={title:P,titleEn:C,titleJa:M,description:J,descriptionEn:G,descriptionJa:D,playlistId:F,category:U,categoryIds:B||[],watchDate:O,...A!==void 0&&{rating:A},purpose:H,purposeEn:q,purposeJa:Z,application:Y,applicationEn:ee,applicationJa:ve,keyTakeaways:He||"",keyTakeawaysEn:Oe||"",keyTakeawaysJa:$e||"",skillIds:he||[],order:Te||0};console.log("📝 VideoPlaylistForm: 저장 데이터 전송",Ee),r(Ee)},k=y.title.trim()&&j.trim()&&R,_=()=>Array.from({length:5},(I,P)=>{const C=P+1;return e.jsx("button",{type:"button",onClick:()=>b({...y,rating:C}),className:`text-3xl transition-colors ${C<=(y.rating||0)?"text-yellow-500 hover:text-yellow-600":"text-gray-300 dark:text-gray-600 hover:text-gray-400"}`,children:e.jsx(Ze,{})},P)});return e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700 pb-2",children:[e.jsx("button",{type:"button",onClick:()=>T("ko"),className:`px-4 py-2 rounded-t-lg font-medium transition-colors ${v==="ko"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"🇰🇷 한국어"}),e.jsx("button",{type:"button",onClick:()=>T("en"),className:`px-4 py-2 rounded-t-lg font-medium transition-colors ${v==="en"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"🇺🇸 English"}),e.jsx("button",{type:"button",onClick:()=>T("ja"),className:`px-4 py-2 rounded-t-lg font-medium transition-colors ${v==="ja"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:"🇯🇵 日本語"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["제목 ",v==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),v==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:" (Optional)"}),v==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:" (任意)"})]}),v==="ko"&&e.jsx("input",{type:"text",value:y.title,onChange:I=>b({...y,title:I.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"재생 목록 제목을 입력하세요",required:!0}),v==="en"&&e.jsx("input",{type:"text",value:y.titleEn,onChange:I=>b({...y,titleEn:I.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter playlist title in English"}),v==="ja"&&e.jsx("input",{type:"text",value:y.titleJa,onChange:I=>b({...y,titleJa:I.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"日本語でプレイリストタイトルを入力してください"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["설명 ",v==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),v==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),v==="ko"&&e.jsx("textarea",{value:y.description,onChange:I=>b({...y,description:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"재생 목록에 대한 간단한 설명을 입력하세요..."}),v==="en"&&e.jsx("textarea",{value:y.descriptionEn,onChange:I=>b({...y,descriptionEn:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"Enter a brief description of the playlist..."}),v==="ja"&&e.jsx("textarea",{value:y.descriptionJa,onChange:I=>b({...y,descriptionJa:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"プレイリストの簡単な説明を入力してください..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["재생 목록 URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:j,onChange:I=>E(I.target.value),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white ${j&&!R?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"https://www.youtube.com/playlist?list=...",required:!0}),j&&!R&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"올바른 유튜브 재생 목록 URL을 입력해주세요"}),F&&e.jsxs("p",{className:"text-green-600 text-sm mt-1",children:["✅ 재생 목록 ID: ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:F})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"카테고리 선택 📂 (다중 선택 가능)"}),y.categoryIds&&y.categoryIds.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:y.categoryIds.map(I=>{const P=f.find(C=>C._id===I);return P?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded-full text-sm",children:[P.name,e.jsx("button",{type:"button",onClick:()=>$(I),className:"hover:bg-blue-700 rounded-full p-0.5",children:e.jsx(Ne,{className:"text-xs"})})]},I):null})}),p?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"카테고리 로딩 중..."}):f.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:f.map(I=>{const P=(y.categoryIds||[]).includes(I._id);return e.jsxs("label",{className:`flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all ${P?"border-primary-600 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("input",{type:"checkbox",checked:P,onChange:()=>$(I._id),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:I.name})]},I._id)})}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'등록된 카테고리가 없습니다. 관리자 메뉴의 "카테고리 관리"에서 추가하세요.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"시청 날짜"}),e.jsx("input",{type:"date",value:y.watchDate,onChange:I=>b({...y,watchDate:I.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"평점"}),e.jsxs("div",{className:"flex items-center gap-2",children:[_(),e.jsxs("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:[y.rating,"/5"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["시청 목적 ",v==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),v==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),v==="ko"&&e.jsx("textarea",{value:y.purpose,onChange:I=>b({...y,purpose:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"이 재생 목록을 왜 시청했는지 작성하세요..."}),v==="en"&&e.jsx("textarea",{value:y.purposeEn,onChange:I=>b({...y,purposeEn:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"Why did you watch this playlist..."}),v==="ja"&&e.jsx("textarea",{value:y.purposeJa,onChange:I=>b({...y,purposeJa:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"このプレイリストを視聴した理由を書いてください..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["통합 적용 계획 (마크다운 지원) ",v==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),v==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),v==="ko"&&e.jsx("textarea",{value:y.application,onChange:I=>b({...y,application:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical font-mono text-sm",rows:5,placeholder:"이 지식을 어떻게 활용할 계획인지 작성하세요..."}),v==="en"&&e.jsx("textarea",{value:y.applicationEn,onChange:I=>b({...y,applicationEn:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical font-mono text-sm",rows:5,placeholder:"How do you plan to apply this knowledge..."}),v==="ja"&&e.jsx("textarea",{value:y.applicationJa,onChange:I=>b({...y,applicationJa:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical font-mono text-sm",rows:5,placeholder:"この知識をどのように活用する予定ですか..."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["핵심 배움 ",v==="en"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Optional)"}),v==="ja"&&e.jsx("span",{className:"text-sm text-gray-500",children:"(任意)"})]}),e.jsx(xr,{checked:l,onChange:z,disabled:s})]}),e.jsxs("div",{className:"space-y-3",children:[l?e.jsxs(e.Fragment,{children:[v==="ko"&&e.jsx(te,{value:y.keyTakeaways||"",onChange:I=>b({...y,keyTakeaways:I}),placeholder:"이 재생 목록을 통해 학습한 핵심 내용을 정리해보세요...",className:"min-h-[200px]"}),v==="en"&&e.jsx(te,{value:y.keyTakeawaysEn||"",onChange:I=>b({...y,keyTakeawaysEn:I}),placeholder:"Summarize the key learnings from this playlist...",className:"min-h-[200px]"}),v==="ja"&&e.jsx(te,{value:y.keyTakeawaysJa||"",onChange:I=>b({...y,keyTakeawaysJa:I}),placeholder:"このプレイリストから学んだ重要な内容をまとめてください...",className:"min-h-[200px]"})]}):e.jsxs(e.Fragment,{children:[v==="ko"&&e.jsx(te,{value:y.keyTakeaways||"",onChange:I=>b({...y,keyTakeaways:I}),placeholder:"이 재생 목록을 통해 학습한 핵심 내용을 정리해보세요...",className:"min-h-[200px]"}),v==="en"&&e.jsx(te,{value:y.keyTakeawaysEn||"",onChange:I=>b({...y,keyTakeawaysEn:I}),placeholder:"Summarize the key learnings from this playlist...",className:"min-h-[200px]"}),v==="ja"&&e.jsx(te,{value:y.keyTakeawaysJa||"",onChange:I=>b({...y,keyTakeawaysJa:I}),placeholder:"このプレイリストから学んだ重要な内容をまとめてください...",className:"min-h-[200px]"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["💡 ",l?"Editor.js":"마크다운"," 에디터를 사용하여 서식을 적용할 수 있습니다.",l&&" Notion에서 복사한 내용도 자동으로 변환됩니다."]})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"관련 기술 연동 🔗"}),m?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-2",children:"스킬 목록을 불러오는 중입니다..."}):e.jsxs(e.Fragment,{children:[(y.skillIds||[]).length>0&&e.jsx("div",{className:"mb-3 px-3 py-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("span",{className:"text-sm text-blue-700 dark:text-blue-300 font-medium",children:["✓ ",(y.skillIds||[]).length,"개 선택됨"]})}),e.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 max-h-[300px] overflow-y-auto bg-gray-50 dark:bg-gray-800/50",children:N.map(I=>e.jsxs("div",{className:"mb-3 last:mb-0",children:[e.jsx("label",{className:"font-bold text-sm block mb-2",style:{color:I.color||"#3B82F6"},children:I.title}),e.jsx("div",{className:"ml-4 space-y-1",children:(I.skills||[]).map(P=>{const C=(y.skillIds||[]).includes(P._id);return e.jsxs("div",{onClick:()=>V(P._id),className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-all ${C?"bg-blue-100 dark:bg-blue-900/30 font-medium":"hover:bg-gray-100 dark:hover:bg-gray-600"}`,children:[e.jsx("input",{type:"checkbox",checked:C,onChange:()=>{},className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:P.name})]},P._id)})})]},I._id))})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs("button",{type:"submit",disabled:s||!k||!R,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:[e.jsx(xe,{})," ",s?"저장 중...":"저장"]}),e.jsx("button",{type:"button",onClick:a,className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"취소"})]}),h.show&&e.jsx(pr,{current:h.current,total:h.total,step:h.step}),e.jsx(hr,{isOpen:i,onConfirm:W,onCancel:X,fromEditor:l?"Editor.js":"마크다운",toEditor:x?"Editor.js":"마크다운"})]})},Ln=({playlistId:t,data:r,onSave:a,onCancel:s,isSaving:n=!1})=>{const[l,o]=d.useState(()=>r!=null&&r.videoId?`https://www.youtube.com/watch?v=${r.videoId}`:""),[i,u]=d.useState(r?{title:r.title,keyTakeaways:r.keyTakeaways||"",order:r.order||0}:{title:"",keyTakeaways:"",order:0}),x=d.useMemo(()=>ur(l),[l]),c=d.useMemo(()=>x?Tt(x):null,[x]),h=d.useMemo(()=>x!==null,[x]),g=m=>{if(m.preventDefault(),!i.title.trim()||!l.trim()){alert("필수 필드(제목, 영상 URL)를 모두 입력해주세요.");return}if(!h||!x){alert("❌ 올바른 유튜브 영상 URL을 입력해주세요.");return}a({playlistId:t,videoId:x,title:i.title,keyTakeaways:i.keyTakeaways||"",order:i.order||0})},N=i.title.trim()&&l.trim()&&h;return e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["영상 URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:l,onChange:m=>o(m.target.value),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white ${l&&!h?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"https://www.youtube.com/watch?v=...",required:!0}),l&&!h&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"올바른 유튜브 URL을 입력해주세요"}),x&&e.jsxs("p",{className:"text-green-600 text-sm mt-1",children:["✅ 영상 ID: ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:x})]}),c&&h&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:c,alt:"영상 썸네일",className:"w-full max-w-xs rounded-lg shadow-md"})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["영상 제목 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.title,onChange:m=>u({...i,title:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"영상 제목을 입력하세요",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"핵심 배움 (마크다운 지원)"}),e.jsx("textarea",{value:i.keyTakeaways,onChange:m=>u({...i,keyTakeaways:m.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical font-mono text-sm",rows:6,placeholder:`예시:
- [2:30] React Query의 staleTime 이해
- [5:15] 캐시 무효화 전략
- [8:45] Optimistic Updates`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"타임스탬프 형식: [MM:SS] 또는 [H:MM:SS]"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsxs("button",{type:"submit",disabled:n||!N,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:[e.jsx(xe,{})," ",n?"저장 중...":"저장"]}),e.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"취소"})]})]})},An=()=>{const{success:t,error:r}=ze(),{playlists:a,isLoading:s,createPlaylist:n,updatePlaylist:l,deletePlaylist:o}=ks(),[i,u]=d.useState(null),[x,c]=d.useState(!1),[h,g]=d.useState(null),[N,m]=d.useState(!1),[f,p]=d.useState(""),{data:w=[]}=vs(i||void 0),j=js(),E=ws(),S=Ns(),[v,T]=zt({onSave:async(R,$)=>{$?(await l($._id,R)).success&&t("재생 목록 수정 완료","재생 목록이 성공적으로 수정되었습니다."):(await n(R)).success&&t("재생 목록 추가 완료","새로운 재생 목록이 추가되었습니다.")},onDelete:async R=>{await o(R._id),t("재생 목록 삭제 완료",`${R.title}이(가) 삭제되었습니다.`)},onError:R=>{r("작업 실패",R.message||"알 수 없는 오류가 발생했습니다.")}}),y=async R=>{try{h?(await E.mutateAsync({id:h._id,data:R}),t("영상 수정 완료","영상 학습 기록이 수정되었습니다.")):(await j.mutateAsync(R),t("영상 추가 완료","새로운 영상 학습 기록이 추가되었습니다.")),c(!1),g(null)}catch{r("영상 저장 실패","영상 저장 중 오류가 발생했습니다.")}},b=async R=>{if(confirm("이 영상 학습 기록을 삭제하시겠습니까?"))try{await S.mutateAsync(R),t("영상 삭제 완료","영상 학습 기록이 삭제되었습니다.")}catch{r("영상 삭제 실패","영상 삭제 중 오류가 발생했습니다.")}},F=async()=>{if(!f.trim()||!i){alert("영상 URL을 입력해주세요");return}const R=f.split(`
`).map($=>$.trim()).filter($=>!!$);if(R.length===0){alert("유효한 URL이 없습니다");return}try{let $=0;for(const V of R){if(!V)continue;const z=ur(V);if(!z){console.warn(`유효하지 않은 URL: ${V}`);continue}const W={playlistId:i,videoId:z,title:`영상 ${w.length+$+1}`,keyTakeaways:"",order:w.length+$};await j.mutateAsync(W),$++}p(""),m(!1),t("일괄 추가 완료",`${$}개의 영상이 추가되었습니다. 각 영상의 제목과 핵심 배움을 수정해주세요.`)}catch{r("일괄 추가 실패","영상 추가 중 오류가 발생했습니다.")}};return s?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Xt,{className:"text-red-600"}),"재생 목록 관리"]}),e.jsxs("button",{onClick:T.handleCreate,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[e.jsx(se,{}),"재생 목록 추가"]})]}),v.showForm&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:v.editingItem?"재생 목록 수정":"재생 목록 추가"}),v.editingItem?e.jsx(Pr,{data:v.editingItem,onSave:T.handleSave,onCancel:T.handleCancel,isSaving:v.isSaving}):e.jsx(Pr,{onSave:T.handleSave,onCancel:T.handleCancel,isSaving:v.isSaving})]})})}),x&&i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:h?"영상 학습 기록 수정":"영상 학습 기록 추가"}),e.jsx(Ln,{playlistId:i,data:h,onSave:y,onCancel:()=>{c(!1),g(null)},isSaving:j.isPending||E.isPending})]})})}),e.jsxs("div",{className:"grid gap-4",children:[a.map(R=>{const $=i===R._id,V=$?w:[];return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:R.title}),e.jsx("button",{onClick:()=>u($?null:R._id),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",title:$?"영상 목록 접기":"영상 목록 펼치기",children:$?e.jsx(_a,{}):e.jsx($t,{})})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-600 dark:text-gray-400 mb-2",children:[R.categoryIds&&R.categoryIds.length>0?R.categoryIds.map(z=>{const W=typeof z=="string"?z:z==null?void 0:z.name;return W?e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded",children:W},typeof z=="string"?z:z==null?void 0:z._id):null}):R.category&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded",children:R.category}),R.rating&&e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(z,W)=>e.jsx(Ze,{className:`text-sm ${W<R.rating?"text-yellow-500":"text-gray-300"}`},W))}),e.jsxs("span",{children:["시청일: ",mt(R.watchDate)]})]}),R.purpose&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:R.purpose})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>T.handleEdit(R),className:"p-2 text-yellow-600 hover:bg-yellow-100 dark:hover:bg-yellow-900 rounded-lg transition-colors",title:"재생 목록 수정",children:e.jsx(be,{})}),e.jsx("button",{onClick:()=>T.handleDelete(R),disabled:v.isDeleting,className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-lg transition-colors",title:"재생 목록 삭제",children:e.jsx(ie,{})})]})]})}),$&&e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Qe,{})," 영상 관리 (",V.length,"개)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>m(!N),className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[e.jsx(Xt,{})," 영상 일괄 추가"]}),e.jsxs("button",{onClick:()=>{g(null),c(!0)},className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(se,{})," 영상 추가"]})]})]}),N&&e.jsxs("div",{className:"mb-4 p-4 border-2 border-green-500 rounded-lg bg-white dark:bg-gray-800",children:[e.jsx("h5",{className:"font-bold text-gray-900 dark:text-white mb-2",children:"📝 영상 URL 일괄 추가"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"재생 목록의 각 영상 URL을 한 줄에 하나씩 입력하세요. 위에서부터 순서대로 추가됩니다."}),e.jsx("textarea",{value:f,onChange:z=>p(z.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm mb-3",rows:6,placeholder:`https://www.youtube.com/watch?v=VIDEO_ID_1
https://www.youtube.com/watch?v=VIDEO_ID_2
https://www.youtube.com/watch?v=VIDEO_ID_3`}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:F,disabled:j.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm font-medium",children:j.isPending?"추가 중...":"일괄 추가"}),e.jsx("button",{onClick:()=>{m(!1),p("")},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm font-medium",children:"취소"})]})]}),V.length>0?e.jsx("div",{className:"space-y-2",children:V.map((z,W)=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-sm font-bold text-primary-600 dark:text-primary-400",children:["#",W+1]}),e.jsx("h5",{className:"font-semibold text-gray-900 dark:text-white",children:z.title})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",z.videoId]}),z.keyTakeaways&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 line-clamp-2",children:z.keyTakeaways})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>{g(z),c(!0)},className:"p-2 text-yellow-600 hover:bg-yellow-100 dark:hover:bg-yellow-900 rounded transition-colors",title:"영상 수정",children:e.jsx(be,{})}),e.jsx("button",{onClick:()=>b(z._id),className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded transition-colors",title:"영상 삭제",children:e.jsx(ie,{})})]})]})},z._id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 rounded-lg",children:[e.jsx(Qe,{className:"text-4xl mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"이 재생 목록에 등록된 영상이 없습니다"}),e.jsx("p",{className:"text-xs mt-1",children:'위의 "영상 일괄 추가" 버튼을 사용하세요'})]})]})]},R._id)}),a.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(Xt,{className:"text-6xl mx-auto mb-4 opacity-30"}),e.jsx("p",{children:"아직 등록된 재생 목록이 없습니다"})]})]})]})};function Fn(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return d.useMemo(()=>s=>{r.forEach(n=>n(s))},r)}const Vt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function tt(t){const r=Object.prototype.toString.call(t);return r==="[object Window]"||r==="[object global]"}function mr(t){return"nodeType"in t}function ce(t){var r,a;return t?tt(t)?t:mr(t)&&(r=(a=t.ownerDocument)==null?void 0:a.defaultView)!=null?r:window:window}function yr(t){const{Document:r}=ce(t);return t instanceof r}function kt(t){return tt(t)?!1:t instanceof ce(t).HTMLElement}function na(t){return t instanceof ce(t).SVGElement}function rt(t){return t?tt(t)?t.document:mr(t)?yr(t)?t:kt(t)||na(t)?t.ownerDocument:document:document:document}const Ce=Vt?d.useLayoutEffect:d.useEffect;function br(t){const r=d.useRef(t);return Ce(()=>{r.current=t}),d.useCallback(function(){for(var a=arguments.length,s=new Array(a),n=0;n<a;n++)s[n]=arguments[n];return r.current==null?void 0:r.current(...s)},[])}function Rn(){const t=d.useRef(null),r=d.useCallback((s,n)=>{t.current=setInterval(s,n)},[]),a=d.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[r,a]}function yt(t,r){r===void 0&&(r=[t]);const a=d.useRef(t);return Ce(()=>{a.current!==t&&(a.current=t)},r),a}function vt(t,r){const a=d.useRef();return d.useMemo(()=>{const s=t(a.current);return a.current=s,s},[...r])}function Lt(t){const r=br(t),a=d.useRef(null),s=d.useCallback(n=>{n!==a.current&&(r==null||r(n,a.current)),a.current=n},[]);return[a,s]}function ar(t){const r=d.useRef();return d.useEffect(()=>{r.current=t},[t]),r.current}let Qt={};function jt(t,r){return d.useMemo(()=>{if(r)return r;const a=Qt[t]==null?0:Qt[t]+1;return Qt[t]=a,t+"-"+a},[t,r])}function la(t){return function(r){for(var a=arguments.length,s=new Array(a>1?a-1:0),n=1;n<a;n++)s[n-1]=arguments[n];return s.reduce((l,o)=>{const i=Object.entries(o);for(const[u,x]of i){const c=l[u];c!=null&&(l[u]=c+t*x)}return l},{...r})}}const Ye=la(1),At=la(-1);function Mn(t){return"clientX"in t&&"clientY"in t}function fr(t){if(!t)return!1;const{KeyboardEvent:r}=ce(t.target);return r&&t instanceof r}function Pn(t){if(!t)return!1;const{TouchEvent:r}=ce(t.target);return r&&t instanceof r}function sr(t){if(Pn(t)){if(t.touches&&t.touches.length){const{clientX:r,clientY:a}=t.touches[0];return{x:r,y:a}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:r,clientY:a}=t.changedTouches[0];return{x:r,y:a}}}return Mn(t)?{x:t.clientX,y:t.clientY}:null}const _e=Object.freeze({Translate:{toString(t){if(!t)return;const{x:r,y:a}=t;return"translate3d("+(r?Math.round(r):0)+"px, "+(a?Math.round(a):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:r,scaleY:a}=t;return"scaleX("+r+") scaleY("+a+")"}},Transform:{toString(t){if(t)return[_e.Translate.toString(t),_e.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:r,duration:a,easing:s}=t;return r+" "+a+"ms "+s}}}),Jr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Jn(t){return t.matches(Jr)?t:t.querySelector(Jr)}const _n={display:"none"};function $n(t){let{id:r,value:a}=t;return oe.createElement("div",{id:r,style:_n},a)}function Un(t){let{id:r,announcement:a,ariaLiveType:s="assertive"}=t;const n={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return oe.createElement("div",{id:r,style:n,role:"status","aria-live":s,"aria-atomic":!0},a)}function Bn(){const[t,r]=d.useState("");return{announce:d.useCallback(s=>{s!=null&&r(s)},[]),announcement:t}}const oa=d.createContext(null);function zn(t){const r=d.useContext(oa);d.useEffect(()=>{if(!r)throw new Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r])}function Vn(){const[t]=d.useState(()=>new Set),r=d.useCallback(s=>(t.add(s),()=>t.delete(s)),[t]);return[d.useCallback(s=>{let{type:n,event:l}=s;t.forEach(o=>{var i;return(i=o[n])==null?void 0:i.call(o,l)})},[t]),r]}const qn={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Hn={onDragStart(t){let{active:r}=t;return"Picked up draggable item "+r.id+"."},onDragOver(t){let{active:r,over:a}=t;return a?"Draggable item "+r.id+" was moved over droppable area "+a.id+".":"Draggable item "+r.id+" is no longer over a droppable area."},onDragEnd(t){let{active:r,over:a}=t;return a?"Draggable item "+r.id+" was dropped over droppable area "+a.id:"Draggable item "+r.id+" was dropped."},onDragCancel(t){let{active:r}=t;return"Dragging was cancelled. Draggable item "+r.id+" was dropped."}};function On(t){let{announcements:r=Hn,container:a,hiddenTextDescribedById:s,screenReaderInstructions:n=qn}=t;const{announce:l,announcement:o}=Bn(),i=jt("DndLiveRegion"),[u,x]=d.useState(!1);if(d.useEffect(()=>{x(!0)},[]),zn(d.useMemo(()=>({onDragStart(h){let{active:g}=h;l(r.onDragStart({active:g}))},onDragMove(h){let{active:g,over:N}=h;r.onDragMove&&l(r.onDragMove({active:g,over:N}))},onDragOver(h){let{active:g,over:N}=h;l(r.onDragOver({active:g,over:N}))},onDragEnd(h){let{active:g,over:N}=h;l(r.onDragEnd({active:g,over:N}))},onDragCancel(h){let{active:g,over:N}=h;l(r.onDragCancel({active:g,over:N}))}}),[l,r])),!u)return null;const c=oe.createElement(oe.Fragment,null,oe.createElement($n,{id:s,value:n.draggable}),oe.createElement(Un,{id:i,announcement:o}));return a?dt.createPortal(c,a):c}var re;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(re||(re={}));function Ft(){}const fe=Object.freeze({x:0,y:0});function Wn(t,r){return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))}function Kn(t,r){let{data:{value:a}}=t,{data:{value:s}}=r;return a-s}function Gn(t,r){let{data:{value:a}}=t,{data:{value:s}}=r;return s-a}function Xn(t,r){if(!t||t.length===0)return null;const[a]=t;return r?a[r]:a}function _r(t,r,a){return r===void 0&&(r=t.left),a===void 0&&(a=t.top),{x:r+t.width*.5,y:a+t.height*.5}}const Rt=t=>{let{collisionRect:r,droppableRects:a,droppableContainers:s}=t;const n=_r(r,r.left,r.top),l=[];for(const o of s){const{id:i}=o,u=a.get(i);if(u){const x=Wn(_r(u),n);l.push({id:i,data:{droppableContainer:o,value:x}})}}return l.sort(Kn)};function Yn(t,r){const a=Math.max(r.top,t.top),s=Math.max(r.left,t.left),n=Math.min(r.left+r.width,t.left+t.width),l=Math.min(r.top+r.height,t.top+t.height),o=n-s,i=l-a;if(s<n&&a<l){const u=r.width*r.height,x=t.width*t.height,c=o*i,h=c/(u+x-c);return Number(h.toFixed(4))}return 0}const Qn=t=>{let{collisionRect:r,droppableRects:a,droppableContainers:s}=t;const n=[];for(const l of s){const{id:o}=l,i=a.get(o);if(i){const u=Yn(i,r);u>0&&n.push({id:o,data:{droppableContainer:l,value:u}})}}return n.sort(Gn)};function Zn(t,r,a){return{...t,scaleX:r&&a?r.width/a.width:1,scaleY:r&&a?r.height/a.height:1}}function ia(t,r){return t&&r?{x:t.left-r.left,y:t.top-r.top}:fe}function el(t){return function(a){for(var s=arguments.length,n=new Array(s>1?s-1:0),l=1;l<s;l++)n[l-1]=arguments[l];return n.reduce((o,i)=>({...o,top:o.top+t*i.y,bottom:o.bottom+t*i.y,left:o.left+t*i.x,right:o.right+t*i.x}),{...a})}}const tl=el(1);function rl(t){if(t.startsWith("matrix3d(")){const r=t.slice(9,-1).split(/, /);return{x:+r[12],y:+r[13],scaleX:+r[0],scaleY:+r[5]}}else if(t.startsWith("matrix(")){const r=t.slice(7,-1).split(/, /);return{x:+r[4],y:+r[5],scaleX:+r[0],scaleY:+r[3]}}return null}function al(t,r,a){const s=rl(r);if(!s)return t;const{scaleX:n,scaleY:l,x:o,y:i}=s,u=t.left-o-(1-n)*parseFloat(a),x=t.top-i-(1-l)*parseFloat(a.slice(a.indexOf(" ")+1)),c=n?t.width/n:t.width,h=l?t.height/l:t.height;return{width:c,height:h,top:x,right:u+c,bottom:x+h,left:u}}const sl={ignoreTransform:!1};function at(t,r){r===void 0&&(r=sl);let a=t.getBoundingClientRect();if(r.ignoreTransform){const{transform:x,transformOrigin:c}=ce(t).getComputedStyle(t);x&&(a=al(a,x,c))}const{top:s,left:n,width:l,height:o,bottom:i,right:u}=a;return{top:s,left:n,width:l,height:o,bottom:i,right:u}}function $r(t){return at(t,{ignoreTransform:!0})}function nl(t){const r=t.innerWidth,a=t.innerHeight;return{top:0,left:0,right:r,bottom:a,width:r,height:a}}function ll(t,r){return r===void 0&&(r=ce(t).getComputedStyle(t)),r.position==="fixed"}function ol(t,r){r===void 0&&(r=ce(t).getComputedStyle(t));const a=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(n=>{const l=r[n];return typeof l=="string"?a.test(l):!1})}function kr(t,r){const a=[];function s(n){if(r!=null&&a.length>=r||!n)return a;if(yr(n)&&n.scrollingElement!=null&&!a.includes(n.scrollingElement))return a.push(n.scrollingElement),a;if(!kt(n)||na(n)||a.includes(n))return a;const l=ce(t).getComputedStyle(n);return n!==t&&ol(n,l)&&a.push(n),ll(n,l)?a:s(n.parentNode)}return t?s(t):a}function ca(t){const[r]=kr(t,1);return r??null}function Zt(t){return!Vt||!t?null:tt(t)?t:mr(t)?yr(t)||t===rt(t).scrollingElement?window:kt(t)?t:null:null}function da(t){return tt(t)?t.scrollX:t.scrollLeft}function ga(t){return tt(t)?t.scrollY:t.scrollTop}function nr(t){return{x:da(t),y:ga(t)}}var ae;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(ae||(ae={}));function ua(t){return!Vt||!t?!1:t===document.scrollingElement}function xa(t){const r={x:0,y:0},a=ua(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},s={x:t.scrollWidth-a.width,y:t.scrollHeight-a.height},n=t.scrollTop<=r.y,l=t.scrollLeft<=r.x,o=t.scrollTop>=s.y,i=t.scrollLeft>=s.x;return{isTop:n,isLeft:l,isBottom:o,isRight:i,maxScroll:s,minScroll:r}}const il={x:.2,y:.2};function cl(t,r,a,s,n){let{top:l,left:o,right:i,bottom:u}=a;s===void 0&&(s=10),n===void 0&&(n=il);const{isTop:x,isBottom:c,isLeft:h,isRight:g}=xa(t),N={x:0,y:0},m={x:0,y:0},f={height:r.height*n.y,width:r.width*n.x};return!x&&l<=r.top+f.height?(N.y=ae.Backward,m.y=s*Math.abs((r.top+f.height-l)/f.height)):!c&&u>=r.bottom-f.height&&(N.y=ae.Forward,m.y=s*Math.abs((r.bottom-f.height-u)/f.height)),!g&&i>=r.right-f.width?(N.x=ae.Forward,m.x=s*Math.abs((r.right-f.width-i)/f.width)):!h&&o<=r.left+f.width&&(N.x=ae.Backward,m.x=s*Math.abs((r.left+f.width-o)/f.width)),{direction:N,speed:m}}function dl(t){if(t===document.scrollingElement){const{innerWidth:l,innerHeight:o}=window;return{top:0,left:0,right:l,bottom:o,width:l,height:o}}const{top:r,left:a,right:s,bottom:n}=t.getBoundingClientRect();return{top:r,left:a,right:s,bottom:n,width:t.clientWidth,height:t.clientHeight}}function ha(t){return t.reduce((r,a)=>Ye(r,nr(a)),fe)}function gl(t){return t.reduce((r,a)=>r+da(a),0)}function ul(t){return t.reduce((r,a)=>r+ga(a),0)}function xl(t,r){if(r===void 0&&(r=at),!t)return;const{top:a,left:s,bottom:n,right:l}=r(t);ca(t)&&(n<=0||l<=0||a>=window.innerHeight||s>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const hl=[["x",["left","right"],gl],["y",["top","bottom"],ul]];class vr{constructor(r,a){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=kr(a),n=ha(s);this.rect={...r},this.width=r.width,this.height=r.height;for(const[l,o,i]of hl)for(const u of o)Object.defineProperty(this,u,{get:()=>{const x=i(s),c=n[l]-x;return this.rect[u]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class xt{constructor(r){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(a=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...a)})},this.target=r}add(r,a,s){var n;(n=this.target)==null||n.addEventListener(r,a,s),this.listeners.push([r,a,s])}}function pl(t){const{EventTarget:r}=ce(t);return t instanceof r?t:rt(t)}function er(t,r){const a=Math.abs(t.x),s=Math.abs(t.y);return typeof r=="number"?Math.sqrt(a**2+s**2)>r:"x"in r&&"y"in r?a>r.x&&s>r.y:"x"in r?a>r.x:"y"in r?s>r.y:!1}var ye;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(ye||(ye={}));function Ur(t){t.preventDefault()}function ml(t){t.stopPropagation()}var K;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(K||(K={}));const pa={start:[K.Space,K.Enter],cancel:[K.Esc],end:[K.Space,K.Enter,K.Tab]},yl=(t,r)=>{let{currentCoordinates:a}=r;switch(t.code){case K.Right:return{...a,x:a.x+25};case K.Left:return{...a,x:a.x-25};case K.Down:return{...a,y:a.y+25};case K.Up:return{...a,y:a.y-25}}};class ma{constructor(r){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=r;const{event:{target:a}}=r;this.props=r,this.listeners=new xt(rt(a)),this.windowListeners=new xt(ce(a)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ye.Resize,this.handleCancel),this.windowListeners.add(ye.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ye.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:r,onStart:a}=this.props,s=r.node.current;s&&xl(s),a(fe)}handleKeyDown(r){if(fr(r)){const{active:a,context:s,options:n}=this.props,{keyboardCodes:l=pa,coordinateGetter:o=yl,scrollBehavior:i="smooth"}=n,{code:u}=r;if(l.end.includes(u)){this.handleEnd(r);return}if(l.cancel.includes(u)){this.handleCancel(r);return}const{collisionRect:x}=s.current,c=x?{x:x.left,y:x.top}:fe;this.referenceCoordinates||(this.referenceCoordinates=c);const h=o(r,{active:a,context:s.current,currentCoordinates:c});if(h){const g=At(h,c),N={x:0,y:0},{scrollableAncestors:m}=s.current;for(const f of m){const p=r.code,{isTop:w,isRight:j,isLeft:E,isBottom:S,maxScroll:v,minScroll:T}=xa(f),y=dl(f),b={x:Math.min(p===K.Right?y.right-y.width/2:y.right,Math.max(p===K.Right?y.left:y.left+y.width/2,h.x)),y:Math.min(p===K.Down?y.bottom-y.height/2:y.bottom,Math.max(p===K.Down?y.top:y.top+y.height/2,h.y))},F=p===K.Right&&!j||p===K.Left&&!E,R=p===K.Down&&!S||p===K.Up&&!w;if(F&&b.x!==h.x){const $=f.scrollLeft+g.x,V=p===K.Right&&$<=v.x||p===K.Left&&$>=T.x;if(V&&!g.y){f.scrollTo({left:$,behavior:i});return}V?N.x=f.scrollLeft-$:N.x=p===K.Right?f.scrollLeft-v.x:f.scrollLeft-T.x,N.x&&f.scrollBy({left:-N.x,behavior:i});break}else if(R&&b.y!==h.y){const $=f.scrollTop+g.y,V=p===K.Down&&$<=v.y||p===K.Up&&$>=T.y;if(V&&!g.x){f.scrollTo({top:$,behavior:i});return}V?N.y=f.scrollTop-$:N.y=p===K.Down?f.scrollTop-v.y:f.scrollTop-T.y,N.y&&f.scrollBy({top:-N.y,behavior:i});break}}this.handleMove(r,Ye(At(h,this.referenceCoordinates),N))}}}handleMove(r,a){const{onMove:s}=this.props;r.preventDefault(),s(a)}handleEnd(r){const{onEnd:a}=this.props;r.preventDefault(),this.detach(),a()}handleCancel(r){const{onCancel:a}=this.props;r.preventDefault(),this.detach(),a()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ma.activators=[{eventName:"onKeyDown",handler:(t,r,a)=>{let{keyboardCodes:s=pa,onActivation:n}=r,{active:l}=a;const{code:o}=t.nativeEvent;if(s.start.includes(o)){const i=l.activatorNode.current;return i&&t.target!==i?!1:(t.preventDefault(),n==null||n({event:t.nativeEvent}),!0)}return!1}}];function Br(t){return!!(t&&"distance"in t)}function zr(t){return!!(t&&"delay"in t)}class jr{constructor(r,a,s){var n;s===void 0&&(s=pl(r.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=r,this.events=a;const{event:l}=r,{target:o}=l;this.props=r,this.events=a,this.document=rt(o),this.documentListeners=new xt(this.document),this.listeners=new xt(s),this.windowListeners=new xt(ce(o)),this.initialCoordinates=(n=sr(l))!=null?n:fe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:r,props:{options:{activationConstraint:a,bypassActivationConstraint:s}}}=this;if(this.listeners.add(r.move.name,this.handleMove,{passive:!1}),this.listeners.add(r.end.name,this.handleEnd),r.cancel&&this.listeners.add(r.cancel.name,this.handleCancel),this.windowListeners.add(ye.Resize,this.handleCancel),this.windowListeners.add(ye.DragStart,Ur),this.windowListeners.add(ye.VisibilityChange,this.handleCancel),this.windowListeners.add(ye.ContextMenu,Ur),this.documentListeners.add(ye.Keydown,this.handleKeydown),a){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(zr(a)){this.timeoutId=setTimeout(this.handleStart,a.delay),this.handlePending(a);return}if(Br(a)){this.handlePending(a);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(r,a){const{active:s,onPending:n}=this.props;n(s,r,this.initialCoordinates,a)}handleStart(){const{initialCoordinates:r}=this,{onStart:a}=this.props;r&&(this.activated=!0,this.documentListeners.add(ye.Click,ml,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ye.SelectionChange,this.removeTextSelection),a(r))}handleMove(r){var a;const{activated:s,initialCoordinates:n,props:l}=this,{onMove:o,options:{activationConstraint:i}}=l;if(!n)return;const u=(a=sr(r))!=null?a:fe,x=At(n,u);if(!s&&i){if(Br(i)){if(i.tolerance!=null&&er(x,i.tolerance))return this.handleCancel();if(er(x,i.distance))return this.handleStart()}if(zr(i)&&er(x,i.tolerance))return this.handleCancel();this.handlePending(i,x);return}r.cancelable&&r.preventDefault(),o(u)}handleEnd(){const{onAbort:r,onEnd:a}=this.props;this.detach(),this.activated||r(this.props.active),a()}handleCancel(){const{onAbort:r,onCancel:a}=this.props;this.detach(),this.activated||r(this.props.active),a()}handleKeydown(r){r.code===K.Esc&&this.handleCancel()}removeTextSelection(){var r;(r=this.document.getSelection())==null||r.removeAllRanges()}}const bl={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ya extends jr{constructor(r){const{event:a}=r,s=rt(a.target);super(r,bl,s)}}ya.activators=[{eventName:"onPointerDown",handler:(t,r)=>{let{nativeEvent:a}=t,{onActivation:s}=r;return!a.isPrimary||a.button!==0?!1:(s==null||s({event:a}),!0)}}];const fl={move:{name:"mousemove"},end:{name:"mouseup"}};var lr;(function(t){t[t.RightClick=2]="RightClick"})(lr||(lr={}));class kl extends jr{constructor(r){super(r,fl,rt(r.event.target))}}kl.activators=[{eventName:"onMouseDown",handler:(t,r)=>{let{nativeEvent:a}=t,{onActivation:s}=r;return a.button===lr.RightClick?!1:(s==null||s({event:a}),!0)}}];const tr={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class vl extends jr{constructor(r){super(r,tr)}static setup(){return window.addEventListener(tr.move.name,r,{capture:!1,passive:!1}),function(){window.removeEventListener(tr.move.name,r)};function r(){}}}vl.activators=[{eventName:"onTouchStart",handler:(t,r)=>{let{nativeEvent:a}=t,{onActivation:s}=r;const{touches:n}=a;return n.length>1?!1:(s==null||s({event:a}),!0)}}];var ht;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(ht||(ht={}));var Mt;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Mt||(Mt={}));function jl(t){let{acceleration:r,activator:a=ht.Pointer,canScroll:s,draggingRect:n,enabled:l,interval:o=5,order:i=Mt.TreeOrder,pointerCoordinates:u,scrollableAncestors:x,scrollableAncestorRects:c,delta:h,threshold:g}=t;const N=Nl({delta:h,disabled:!l}),[m,f]=Rn(),p=d.useRef({x:0,y:0}),w=d.useRef({x:0,y:0}),j=d.useMemo(()=>{switch(a){case ht.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case ht.DraggableRect:return n}},[a,n,u]),E=d.useRef(null),S=d.useCallback(()=>{const T=E.current;if(!T)return;const y=p.current.x*w.current.x,b=p.current.y*w.current.y;T.scrollBy(y,b)},[]),v=d.useMemo(()=>i===Mt.TreeOrder?[...x].reverse():x,[i,x]);d.useEffect(()=>{if(!l||!x.length||!j){f();return}for(const T of v){if((s==null?void 0:s(T))===!1)continue;const y=x.indexOf(T),b=c[y];if(!b)continue;const{direction:F,speed:R}=cl(T,b,j,r,g);for(const $ of["x","y"])N[$][F[$]]||(R[$]=0,F[$]=0);if(R.x>0||R.y>0){f(),E.current=T,m(S,o),p.current=R,w.current=F;return}}p.current={x:0,y:0},w.current={x:0,y:0},f()},[r,S,s,f,l,o,JSON.stringify(j),JSON.stringify(N),m,x,v,c,JSON.stringify(g)])}const wl={x:{[ae.Backward]:!1,[ae.Forward]:!1},y:{[ae.Backward]:!1,[ae.Forward]:!1}};function Nl(t){let{delta:r,disabled:a}=t;const s=ar(r);return vt(n=>{if(a||!s||!n)return wl;const l={x:Math.sign(r.x-s.x),y:Math.sign(r.y-s.y)};return{x:{[ae.Backward]:n.x[ae.Backward]||l.x===-1,[ae.Forward]:n.x[ae.Forward]||l.x===1},y:{[ae.Backward]:n.y[ae.Backward]||l.y===-1,[ae.Forward]:n.y[ae.Forward]||l.y===1}}},[a,r,s])}function Cl(t,r){const a=r!=null?t.get(r):void 0,s=a?a.node.current:null;return vt(n=>{var l;return r==null?null:(l=s??n)!=null?l:null},[s,r])}function Sl(t,r){return d.useMemo(()=>t.reduce((a,s)=>{const{sensor:n}=s,l=n.activators.map(o=>({eventName:o.eventName,handler:r(o.handler,s)}));return[...a,...l]},[]),[t,r])}var bt;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(bt||(bt={}));var or;(function(t){t.Optimized="optimized"})(or||(or={}));const Vr=new Map;function El(t,r){let{dragging:a,dependencies:s,config:n}=r;const[l,o]=d.useState(null),{frequency:i,measure:u,strategy:x}=n,c=d.useRef(t),h=p(),g=yt(h),N=d.useCallback(function(w){w===void 0&&(w=[]),!g.current&&o(j=>j===null?w:j.concat(w.filter(E=>!j.includes(E))))},[g]),m=d.useRef(null),f=vt(w=>{if(h&&!a)return Vr;if(!w||w===Vr||c.current!==t||l!=null){const j=new Map;for(let E of t){if(!E)continue;if(l&&l.length>0&&!l.includes(E.id)&&E.rect.current){j.set(E.id,E.rect.current);continue}const S=E.node.current,v=S?new vr(u(S),S):null;E.rect.current=v,v&&j.set(E.id,v)}return j}return w},[t,l,a,h,u]);return d.useEffect(()=>{c.current=t},[t]),d.useEffect(()=>{h||N()},[a,h]),d.useEffect(()=>{l&&l.length>0&&o(null)},[JSON.stringify(l)]),d.useEffect(()=>{h||typeof i!="number"||m.current!==null||(m.current=setTimeout(()=>{N(),m.current=null},i))},[i,h,N,...s]),{droppableRects:f,measureDroppableContainers:N,measuringScheduled:l!=null};function p(){switch(x){case bt.Always:return!1;case bt.BeforeDragging:return a;default:return!a}}}function ba(t,r){return vt(a=>t?a||(typeof r=="function"?r(t):t):null,[r,t])}function Il(t,r){return ba(t,r)}function Dl(t){let{callback:r,disabled:a}=t;const s=br(r),n=d.useMemo(()=>{if(a||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:l}=window;return new l(s)},[s,a]);return d.useEffect(()=>()=>n==null?void 0:n.disconnect(),[n]),n}function qt(t){let{callback:r,disabled:a}=t;const s=br(r),n=d.useMemo(()=>{if(a||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:l}=window;return new l(s)},[a]);return d.useEffect(()=>()=>n==null?void 0:n.disconnect(),[n]),n}function Tl(t){return new vr(at(t),t)}function qr(t,r,a){r===void 0&&(r=Tl);const[s,n]=d.useState(null);function l(){n(u=>{if(!t)return null;if(t.isConnected===!1){var x;return(x=u??a)!=null?x:null}const c=r(t);return JSON.stringify(u)===JSON.stringify(c)?u:c})}const o=Dl({callback(u){if(t)for(const x of u){const{type:c,target:h}=x;if(c==="childList"&&h instanceof HTMLElement&&h.contains(t)){l();break}}}}),i=qt({callback:l});return Ce(()=>{l(),t?(i==null||i.observe(t),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(i==null||i.disconnect(),o==null||o.disconnect())},[t]),s}function Ll(t){const r=ba(t);return ia(t,r)}const Hr=[];function Al(t){const r=d.useRef(t),a=vt(s=>t?s&&s!==Hr&&t&&r.current&&t.parentNode===r.current.parentNode?s:kr(t):Hr,[t]);return d.useEffect(()=>{r.current=t},[t]),a}function Fl(t){const[r,a]=d.useState(null),s=d.useRef(t),n=d.useCallback(l=>{const o=Zt(l.target);o&&a(i=>i?(i.set(o,nr(o)),new Map(i)):null)},[]);return d.useEffect(()=>{const l=s.current;if(t!==l){o(l);const i=t.map(u=>{const x=Zt(u);return x?(x.addEventListener("scroll",n,{passive:!0}),[x,nr(x)]):null}).filter(u=>u!=null);a(i.length?new Map(i):null),s.current=t}return()=>{o(t),o(l)};function o(i){i.forEach(u=>{const x=Zt(u);x==null||x.removeEventListener("scroll",n)})}},[n,t]),d.useMemo(()=>t.length?r?Array.from(r.values()).reduce((l,o)=>Ye(l,o),fe):ha(t):fe,[t,r])}function Or(t,r){r===void 0&&(r=[]);const a=d.useRef(null);return d.useEffect(()=>{a.current=null},r),d.useEffect(()=>{const s=t!==fe;s&&!a.current&&(a.current=t),!s&&a.current&&(a.current=null)},[t]),a.current?At(t,a.current):fe}function Rl(t){d.useEffect(()=>{if(!Vt)return;const r=t.map(a=>{let{sensor:s}=a;return s.setup==null?void 0:s.setup()});return()=>{for(const a of r)a==null||a()}},t.map(r=>{let{sensor:a}=r;return a}))}function Ml(t,r){return d.useMemo(()=>t.reduce((a,s)=>{let{eventName:n,handler:l}=s;return a[n]=o=>{l(o,r)},a},{}),[t,r])}function fa(t){return d.useMemo(()=>t?nl(t):null,[t])}const Wr=[];function Pl(t,r){r===void 0&&(r=at);const[a]=t,s=fa(a?ce(a):null),[n,l]=d.useState(Wr);function o(){l(()=>t.length?t.map(u=>ua(u)?s:new vr(r(u),u)):Wr)}const i=qt({callback:o});return Ce(()=>{i==null||i.disconnect(),o(),t.forEach(u=>i==null?void 0:i.observe(u))},[t]),n}function Jl(t){if(!t)return null;if(t.children.length>1)return t;const r=t.children[0];return kt(r)?r:t}function _l(t){let{measure:r}=t;const[a,s]=d.useState(null),n=d.useCallback(x=>{for(const{target:c}of x)if(kt(c)){s(h=>{const g=r(c);return h?{...h,width:g.width,height:g.height}:g});break}},[r]),l=qt({callback:n}),o=d.useCallback(x=>{const c=Jl(x);l==null||l.disconnect(),c&&(l==null||l.observe(c)),s(c?r(c):null)},[r,l]),[i,u]=Lt(o);return d.useMemo(()=>({nodeRef:i,rect:a,setRef:u}),[a,i,u])}const $l=[{sensor:ya,options:{}},{sensor:ma,options:{}}],Ul={current:{}},It={draggable:{measure:$r},droppable:{measure:$r,strategy:bt.WhileDragging,frequency:or.Optimized},dragOverlay:{measure:at}};class pt extends Map{get(r){var a;return r!=null&&(a=super.get(r))!=null?a:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(r=>{let{disabled:a}=r;return!a})}getNodeFor(r){var a,s;return(a=(s=this.get(r))==null?void 0:s.node.current)!=null?a:void 0}}const Bl={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new pt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ft},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:It,measureDroppableContainers:Ft,windowRect:null,measuringScheduled:!1},zl={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ft,draggableNodes:new Map,over:null,measureDroppableContainers:Ft},Ht=d.createContext(zl),ka=d.createContext(Bl);function Vl(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new pt}}}function ql(t,r){switch(r.type){case re.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:r.initialCoordinates,active:r.active}};case re.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:r.coordinates.x-t.draggable.initialCoordinates.x,y:r.coordinates.y-t.draggable.initialCoordinates.y}}};case re.DragEnd:case re.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case re.RegisterDroppable:{const{element:a}=r,{id:s}=a,n=new pt(t.droppable.containers);return n.set(s,a),{...t,droppable:{...t.droppable,containers:n}}}case re.SetDroppableDisabled:{const{id:a,key:s,disabled:n}=r,l=t.droppable.containers.get(a);if(!l||s!==l.key)return t;const o=new pt(t.droppable.containers);return o.set(a,{...l,disabled:n}),{...t,droppable:{...t.droppable,containers:o}}}case re.UnregisterDroppable:{const{id:a,key:s}=r,n=t.droppable.containers.get(a);if(!n||s!==n.key)return t;const l=new pt(t.droppable.containers);return l.delete(a),{...t,droppable:{...t.droppable,containers:l}}}default:return t}}function Hl(t){let{disabled:r}=t;const{active:a,activatorEvent:s,draggableNodes:n}=d.useContext(Ht),l=ar(s),o=ar(a==null?void 0:a.id);return d.useEffect(()=>{if(!r&&!s&&l&&o!=null){if(!fr(l)||document.activeElement===l.target)return;const i=n.get(o);if(!i)return;const{activatorNode:u,node:x}=i;if(!u.current&&!x.current)return;requestAnimationFrame(()=>{for(const c of[u.current,x.current]){if(!c)continue;const h=Jn(c);if(h){h.focus();break}}})}},[s,r,n,o,l]),null}function Ol(t,r){let{transform:a,...s}=r;return t!=null&&t.length?t.reduce((n,l)=>l({transform:n,...s}),a):a}function Wl(t){return d.useMemo(()=>({draggable:{...It.draggable,...t==null?void 0:t.draggable},droppable:{...It.droppable,...t==null?void 0:t.droppable},dragOverlay:{...It.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function Kl(t){let{activeNode:r,measure:a,initialRect:s,config:n=!0}=t;const l=d.useRef(!1),{x:o,y:i}=typeof n=="boolean"?{x:n,y:n}:n;Ce(()=>{if(!o&&!i||!r){l.current=!1;return}if(l.current||!s)return;const x=r==null?void 0:r.node.current;if(!x||x.isConnected===!1)return;const c=a(x),h=ia(c,s);if(o||(h.x=0),i||(h.y=0),l.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const g=ca(x);g&&g.scrollBy({top:h.y,left:h.x})}},[r,o,i,s,a])}const va=d.createContext({...fe,scaleX:1,scaleY:1});var Pe;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Pe||(Pe={}));const Pt=d.memo(function(r){var a,s,n,l;let{id:o,accessibility:i,autoScroll:u=!0,children:x,sensors:c=$l,collisionDetection:h=Qn,measuring:g,modifiers:N,...m}=r;const f=d.useReducer(ql,void 0,Vl),[p,w]=f,[j,E]=Vn(),[S,v]=d.useState(Pe.Uninitialized),T=S===Pe.Initialized,{draggable:{active:y,nodes:b,translate:F},droppable:{containers:R}}=p,$=y!=null?b.get(y):null,V=d.useRef({initial:null,translated:null}),z=d.useMemo(()=>{var le;return y!=null?{id:y,data:(le=$==null?void 0:$.data)!=null?le:Ul,rect:V}:null},[y,$]),W=d.useRef(null),[X,Q]=d.useState(null),[L,k]=d.useState(null),_=yt(m,Object.values(m)),I=jt("DndDescribedBy",o),P=d.useMemo(()=>R.getEnabled(),[R]),C=Wl(g),{droppableRects:M,measureDroppableContainers:J,measuringScheduled:G}=El(P,{dragging:T,dependencies:[F.x,F.y],config:C.droppable}),D=Cl(b,y),U=d.useMemo(()=>L?sr(L):null,[L]),B=Ma(),O=Il(D,C.draggable.measure);Kl({activeNode:y!=null?b.get(y):null,config:B.layoutShiftCompensation,initialRect:O,measure:C.draggable.measure});const A=qr(D,C.draggable.measure,O),H=qr(D?D.parentElement:null),q=d.useRef({activatorEvent:null,active:null,activeNode:D,collisionRect:null,collisions:null,droppableRects:M,draggableNodes:b,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Z=R.getNodeFor((a=q.current.over)==null?void 0:a.id),Y=_l({measure:C.dragOverlay.measure}),ee=(s=Y.nodeRef.current)!=null?s:D,ve=T?(n=Y.rect)!=null?n:A:null,He=!!(Y.nodeRef.current&&Y.rect),Oe=Ll(He?null:A),$e=fa(ee?ce(ee):null),he=Al(T?Z??D:null),Te=Pl(he),Ee=Ol(N,{transform:{x:F.x-Oe.x,y:F.y-Oe.y,scaleX:1,scaleY:1},activatorEvent:L,active:z,activeNodeRect:A,containerNodeRect:H,draggingNodeRect:ve,over:q.current.over,overlayNodeRect:Y.rect,scrollableAncestors:he,scrollableAncestorRects:Te,windowRect:$e}),wt=U?Ye(U,F):null,wr=Fl(he),Ia=Or(wr),Da=Or(wr,[A]),We=Ye(Ee,Ia),Ke=ve?tl(ve,Ee):null,nt=z&&Ke?h({active:z,collisionRect:Ke,droppableRects:M,droppableContainers:P,pointerCoordinates:wt}):null,Nr=Xn(nt,"id"),[Le,Cr]=d.useState(null),Ta=He?Ee:Ye(Ee,Da),La=Zn(Ta,(l=Le==null?void 0:Le.rect)!=null?l:null,A),Wt=d.useRef(null),Sr=d.useCallback((le,de)=>{let{sensor:ge,options:Ae}=de;if(W.current==null)return;const pe=b.get(W.current);if(!pe)return;const ue=le.nativeEvent,je=new ge({active:W.current,activeNode:pe,event:ue,options:Ae,context:q,onAbort(ne){if(!b.get(ne))return;const{onDragAbort:we}=_.current,Ie={id:ne};we==null||we(Ie),j({type:"onDragAbort",event:Ie})},onPending(ne,Fe,we,Ie){if(!b.get(ne))return;const{onDragPending:ot}=_.current,Re={id:ne,constraint:Fe,initialCoordinates:we,offset:Ie};ot==null||ot(Re),j({type:"onDragPending",event:Re})},onStart(ne){const Fe=W.current;if(Fe==null)return;const we=b.get(Fe);if(!we)return;const{onDragStart:Ie}=_.current,lt={activatorEvent:ue,active:{id:Fe,data:we.data,rect:V}};dt.unstable_batchedUpdates(()=>{Ie==null||Ie(lt),v(Pe.Initializing),w({type:re.DragStart,initialCoordinates:ne,active:Fe}),j({type:"onDragStart",event:lt}),Q(Wt.current),k(ue)})},onMove(ne){w({type:re.DragMove,coordinates:ne})},onEnd:Ge(re.DragEnd),onCancel:Ge(re.DragCancel)});Wt.current=je;function Ge(ne){return async function(){const{active:we,collisions:Ie,over:lt,scrollAdjustedTranslate:ot}=q.current;let Re=null;if(we&&ot){const{cancelDrop:it}=_.current;Re={activatorEvent:ue,active:we,collisions:Ie,delta:ot,over:lt},ne===re.DragEnd&&typeof it=="function"&&await Promise.resolve(it(Re))&&(ne=re.DragCancel)}W.current=null,dt.unstable_batchedUpdates(()=>{w({type:ne}),v(Pe.Uninitialized),Cr(null),Q(null),k(null),Wt.current=null;const it=ne===re.DragEnd?"onDragEnd":"onDragCancel";if(Re){const Kt=_.current[it];Kt==null||Kt(Re),j({type:it,event:Re})}})}}},[b]),Aa=d.useCallback((le,de)=>(ge,Ae)=>{const pe=ge.nativeEvent,ue=b.get(Ae);if(W.current!==null||!ue||pe.dndKit||pe.defaultPrevented)return;const je={active:ue};le(ge,de.options,je)===!0&&(pe.dndKit={capturedBy:de.sensor},W.current=Ae,Sr(ge,de))},[b,Sr]),Er=Sl(c,Aa);Rl(c),Ce(()=>{A&&S===Pe.Initializing&&v(Pe.Initialized)},[A,S]),d.useEffect(()=>{const{onDragMove:le}=_.current,{active:de,activatorEvent:ge,collisions:Ae,over:pe}=q.current;if(!de||!ge)return;const ue={active:de,activatorEvent:ge,collisions:Ae,delta:{x:We.x,y:We.y},over:pe};dt.unstable_batchedUpdates(()=>{le==null||le(ue),j({type:"onDragMove",event:ue})})},[We.x,We.y]),d.useEffect(()=>{const{active:le,activatorEvent:de,collisions:ge,droppableContainers:Ae,scrollAdjustedTranslate:pe}=q.current;if(!le||W.current==null||!de||!pe)return;const{onDragOver:ue}=_.current,je=Ae.get(Nr),Ge=je&&je.rect.current?{id:je.id,rect:je.rect.current,data:je.data,disabled:je.disabled}:null,ne={active:le,activatorEvent:de,collisions:ge,delta:{x:pe.x,y:pe.y},over:Ge};dt.unstable_batchedUpdates(()=>{Cr(Ge),ue==null||ue(ne),j({type:"onDragOver",event:ne})})},[Nr]),Ce(()=>{q.current={activatorEvent:L,active:z,activeNode:D,collisionRect:Ke,collisions:nt,droppableRects:M,draggableNodes:b,draggingNode:ee,draggingNodeRect:ve,droppableContainers:R,over:Le,scrollableAncestors:he,scrollAdjustedTranslate:We},V.current={initial:ve,translated:Ke}},[z,D,nt,Ke,b,ee,ve,M,R,Le,he,We]),jl({...B,delta:F,draggingRect:Ke,pointerCoordinates:wt,scrollableAncestors:he,scrollableAncestorRects:Te});const Fa=d.useMemo(()=>({active:z,activeNode:D,activeNodeRect:A,activatorEvent:L,collisions:nt,containerNodeRect:H,dragOverlay:Y,draggableNodes:b,droppableContainers:R,droppableRects:M,over:Le,measureDroppableContainers:J,scrollableAncestors:he,scrollableAncestorRects:Te,measuringConfiguration:C,measuringScheduled:G,windowRect:$e}),[z,D,A,L,nt,H,Y,b,R,M,Le,J,he,Te,C,G,$e]),Ra=d.useMemo(()=>({activatorEvent:L,activators:Er,active:z,activeNodeRect:A,ariaDescribedById:{draggable:I},dispatch:w,draggableNodes:b,over:Le,measureDroppableContainers:J}),[L,Er,z,A,w,I,b,Le,J]);return oe.createElement(oa.Provider,{value:E},oe.createElement(Ht.Provider,{value:Ra},oe.createElement(ka.Provider,{value:Fa},oe.createElement(va.Provider,{value:La},x)),oe.createElement(Hl,{disabled:(i==null?void 0:i.restoreFocus)===!1})),oe.createElement(On,{...i,hiddenTextDescribedById:I}));function Ma(){const le=(X==null?void 0:X.autoScrollEnabled)===!1,de=typeof u=="object"?u.enabled===!1:u===!1,ge=T&&!le&&!de;return typeof u=="object"?{...u,enabled:ge}:{enabled:ge}}}),Gl=d.createContext(null),Kr="button",Xl="Draggable";function Yl(t){let{id:r,data:a,disabled:s=!1,attributes:n}=t;const l=jt(Xl),{activators:o,activatorEvent:i,active:u,activeNodeRect:x,ariaDescribedById:c,draggableNodes:h,over:g}=d.useContext(Ht),{role:N=Kr,roleDescription:m="draggable",tabIndex:f=0}=n??{},p=(u==null?void 0:u.id)===r,w=d.useContext(p?va:Gl),[j,E]=Lt(),[S,v]=Lt(),T=Ml(o,r),y=yt(a);Ce(()=>(h.set(r,{id:r,key:l,node:j,activatorNode:S,data:y}),()=>{const F=h.get(r);F&&F.key===l&&h.delete(r)}),[h,r]);const b=d.useMemo(()=>({role:N,tabIndex:f,"aria-disabled":s,"aria-pressed":p&&N===Kr?!0:void 0,"aria-roledescription":m,"aria-describedby":c.draggable}),[s,N,f,p,m,c.draggable]);return{active:u,activatorEvent:i,activeNodeRect:x,attributes:b,isDragging:p,listeners:s?void 0:T,node:j,over:g,setNodeRef:E,setActivatorNodeRef:v,transform:w}}function Ql(){return d.useContext(ka)}const Zl="Droppable",eo={timeout:25};function to(t){let{data:r,disabled:a=!1,id:s,resizeObserverConfig:n}=t;const l=jt(Zl),{active:o,dispatch:i,over:u,measureDroppableContainers:x}=d.useContext(Ht),c=d.useRef({disabled:a}),h=d.useRef(!1),g=d.useRef(null),N=d.useRef(null),{disabled:m,updateMeasurementsFor:f,timeout:p}={...eo,...n},w=yt(f??s),j=d.useCallback(()=>{if(!h.current){h.current=!0;return}N.current!=null&&clearTimeout(N.current),N.current=setTimeout(()=>{x(Array.isArray(w.current)?w.current:[w.current]),N.current=null},p)},[p]),E=qt({callback:j,disabled:m||!o}),S=d.useCallback((b,F)=>{E&&(F&&(E.unobserve(F),h.current=!1),b&&E.observe(b))},[E]),[v,T]=Lt(S),y=yt(r);return d.useEffect(()=>{!E||!v.current||(E.disconnect(),h.current=!1,E.observe(v.current))},[v,E]),d.useEffect(()=>(i({type:re.RegisterDroppable,element:{id:s,key:l,disabled:a,node:v,rect:g,data:y}}),()=>i({type:re.UnregisterDroppable,key:l,id:s})),[s]),d.useEffect(()=>{a!==c.current.disabled&&(i({type:re.SetDroppableDisabled,id:s,key:l,disabled:a}),c.current.disabled=a)},[s,l,a,i]),{active:o,rect:g,isOver:(u==null?void 0:u.id)===s,node:v,over:u,setNodeRef:T}}function ft(t,r,a){const s=t.slice();return s.splice(a<0?s.length+a:a,0,s.splice(r,1)[0]),s}function ro(t,r){return t.reduce((a,s,n)=>{const l=r.get(s);return l&&(a[n]=l),a},Array(t.length))}function St(t){return t!==null&&t>=0}function ao(t,r){if(t===r)return!0;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==r[a])return!1;return!0}function so(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const ja=t=>{let{rects:r,activeIndex:a,overIndex:s,index:n}=t;const l=ft(r,s,a),o=r[n],i=l[n];return!i||!o?null:{x:i.left-o.left,y:i.top-o.top,scaleX:i.width/o.width,scaleY:i.height/o.height}},Et={scaleX:1,scaleY:1},Jt=t=>{var r;let{activeIndex:a,activeNodeRect:s,index:n,rects:l,overIndex:o}=t;const i=(r=l[a])!=null?r:s;if(!i)return null;if(n===a){const x=l[o];return x?{x:0,y:a<o?x.top+x.height-(i.top+i.height):x.top-i.top,...Et}:null}const u=no(l,n,a);return n>a&&n<=o?{x:0,y:-i.height-u,...Et}:n<a&&n>=o?{x:0,y:i.height+u,...Et}:{x:0,y:0,...Et}};function no(t,r,a){const s=t[r],n=t[r-1],l=t[r+1];return s?a<r?n?s.top-(n.top+n.height):l?l.top-(s.top+s.height):0:l?l.top-(s.top+s.height):n?s.top-(n.top+n.height):0:0}const wa="Sortable",Na=oe.createContext({activeIndex:-1,containerId:wa,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:ja,disabled:{draggable:!1,droppable:!1}});function _t(t){let{children:r,id:a,items:s,strategy:n=ja,disabled:l=!1}=t;const{active:o,dragOverlay:i,droppableRects:u,over:x,measureDroppableContainers:c}=Ql(),h=jt(wa,a),g=i.rect!==null,N=d.useMemo(()=>s.map(T=>typeof T=="object"&&"id"in T?T.id:T),[s]),m=o!=null,f=o?N.indexOf(o.id):-1,p=x?N.indexOf(x.id):-1,w=d.useRef(N),j=!ao(N,w.current),E=p!==-1&&f===-1||j,S=so(l);Ce(()=>{j&&m&&c(N)},[j,N,m,c]),d.useEffect(()=>{w.current=N},[N]);const v=d.useMemo(()=>({activeIndex:f,containerId:h,disabled:S,disableTransforms:E,items:N,overIndex:p,useDragOverlay:g,sortedRects:ro(N,u),strategy:n}),[f,h,S.draggable,S.droppable,E,N,p,u,g,n]);return oe.createElement(Na.Provider,{value:v},r)}const lo=t=>{let{id:r,items:a,activeIndex:s,overIndex:n}=t;return ft(a,s,n).indexOf(r)},oo=t=>{let{containerId:r,isSorting:a,wasDragging:s,index:n,items:l,newIndex:o,previousItems:i,previousContainerId:u,transition:x}=t;return!x||!s||i!==l&&n===o?!1:a?!0:o!==n&&r===u},io={duration:200,easing:"ease"},Ca="transform",co=_e.Transition.toString({property:Ca,duration:0,easing:"linear"}),go={roleDescription:"sortable"};function uo(t){let{disabled:r,index:a,node:s,rect:n}=t;const[l,o]=d.useState(null),i=d.useRef(a);return Ce(()=>{if(!r&&a!==i.current&&s.current){const u=n.current;if(u){const x=at(s.current,{ignoreTransform:!0}),c={x:u.left-x.left,y:u.top-x.top,scaleX:u.width/x.width,scaleY:u.height/x.height};(c.x||c.y)&&o(c)}}a!==i.current&&(i.current=a)},[r,a,s,n]),d.useEffect(()=>{l&&o(null)},[l]),l}function Ot(t){let{animateLayoutChanges:r=oo,attributes:a,disabled:s,data:n,getNewIndex:l=lo,id:o,strategy:i,resizeObserverConfig:u,transition:x=io}=t;const{items:c,containerId:h,activeIndex:g,disabled:N,disableTransforms:m,sortedRects:f,overIndex:p,useDragOverlay:w,strategy:j}=d.useContext(Na),E=xo(s,N),S=c.indexOf(o),v=d.useMemo(()=>({sortable:{containerId:h,index:S,items:c},...n}),[h,n,S,c]),T=d.useMemo(()=>c.slice(c.indexOf(o)),[c,o]),{rect:y,node:b,isOver:F,setNodeRef:R}=to({id:o,data:v,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...u}}),{active:$,activatorEvent:V,activeNodeRect:z,attributes:W,setNodeRef:X,listeners:Q,isDragging:L,over:k,setActivatorNodeRef:_,transform:I}=Yl({id:o,data:v,attributes:{...go,...a},disabled:E.draggable}),P=Fn(R,X),C=!!$,M=C&&!m&&St(g)&&St(p),J=!w&&L,G=J&&M?I:null,U=M?G??(i??j)({rects:f,activeNodeRect:z,activeIndex:g,overIndex:p,index:S}):null,B=St(g)&&St(p)?l({id:o,items:c,activeIndex:g,overIndex:p}):S,O=$==null?void 0:$.id,A=d.useRef({activeId:O,items:c,newIndex:B,containerId:h}),H=c!==A.current.items,q=r({active:$,containerId:h,isDragging:L,isSorting:C,id:o,index:S,items:c,newIndex:A.current.newIndex,previousItems:A.current.items,previousContainerId:A.current.containerId,transition:x,wasDragging:A.current.activeId!=null}),Z=uo({disabled:!q,index:S,node:b,rect:y});return d.useEffect(()=>{C&&A.current.newIndex!==B&&(A.current.newIndex=B),h!==A.current.containerId&&(A.current.containerId=h),c!==A.current.items&&(A.current.items=c)},[C,B,h,c]),d.useEffect(()=>{if(O===A.current.activeId)return;if(O!=null&&A.current.activeId==null){A.current.activeId=O;return}const ee=setTimeout(()=>{A.current.activeId=O},50);return()=>clearTimeout(ee)},[O]),{active:$,activeIndex:g,attributes:W,data:v,rect:y,index:S,newIndex:B,items:c,isOver:F,isSorting:C,isDragging:L,listeners:Q,node:b,overIndex:p,over:k,setNodeRef:P,setActivatorNodeRef:_,setDroppableNodeRef:R,setDraggableNodeRef:X,transform:Z??U,transition:Y()};function Y(){if(Z||H&&A.current.newIndex===S)return co;if(!(J&&!fr(V)||!x)&&(C||q))return _e.Transition.toString({...x,property:Ca})}}function xo(t,r){var a,s;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(a=t==null?void 0:t.draggable)!=null?a:r.draggable,droppable:(s=t==null?void 0:t.droppable)!=null?s:r.droppable}}K.Down,K.Right,K.Up,K.Left;const Gr=[{key:"FaBriefcase",icon:Dt,label:"💼 일반 업무"},{key:"FaCoffee",icon:$a,label:"☕ 서비스/카페"},{key:"FaGraduationCap",icon:Ua,label:"🎓 교육/학습"},{key:"FaChartLine",icon:Ba,label:"📈 성장/분석"},{key:"FaLaptopCode",icon:za,label:"💻 프로그래밍"},{key:"FaCode",icon:Va,label:"⌨️ 개발/코딩"},{key:"FaCog",icon:qa,label:"⚙️ 기술/엔지니어링"},{key:"FaRobot",icon:Ha,label:"🤖 자동화/AI"},{key:"FaCar",icon:Oa,label:"🚗 자동차/운전"},{key:"FaShieldAlt",icon:Wa,label:"🛡️ 군대/보안"}],ho=({detail:t,index:r,editingCategoryIndex:a,onEdit:s,onRemove:n})=>{const{attributes:l,listeners:o,setNodeRef:i,transform:u,transition:x,isDragging:c}=Ot({id:r}),h={transform:_e.Transform.toString(u),transition:x,opacity:c?.5:1,zIndex:c?1e3:"auto"};return e.jsxs("div",{ref:i,style:h,className:"bg-white dark:bg-gray-800 p-4 rounded-lg border-2 border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-600 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{...l,...o,className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-1",title:"드래그하여 순서 변경",children:e.jsx(Ut,{})}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-600"}),e.jsx("h5",{className:"font-bold text-gray-900 dark:text-white",children:t.category}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",t.items.length,"개 항목)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>s(r),disabled:a!==null,className:`px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors ${a!==null?"opacity-50 cursor-not-allowed":""}`,children:"수정"}),e.jsx("button",{type:"button",onClick:()=>n(r),disabled:a!==null,className:`p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded transition-colors ${a!==null?"opacity-50 cursor-not-allowed":""}`,title:"카테고리 삭제",children:e.jsx(ie,{className:"text-xs"})})]})]}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 pl-4",children:[t.items.slice(0,3).map((g,N)=>e.jsx("li",{className:"list-disc",children:g},N)),t.items.length>3&&e.jsxs("li",{className:"text-gray-500 dark:text-gray-400 italic",children:["외 ",t.items.length-3,"개 항목..."]})]})]})},po=({data:t,onSave:r,onCancel:a,isSaving:s=!1})=>{var Q;const[n,l]=d.useState("ko"),{skillCategories:o,loading:i}=et(),u=t!=null&&t.skillIds?t.skillIds.map(L=>typeof L=="string"?L:L==null?void 0:L._id).filter(Boolean):[],x=t?{...t,iconKey:t.iconKey||"FaBriefcase",details:(t.details||[]).map((L,k)=>({...L,order:L.order??k})),skills:t.skills||[],skillsEn:t.skillsEn||[],skillsJa:t.skillsJa||[],skillIds:u,titleEn:t.titleEn||"",titleJa:t.titleJa||"",companyEn:t.companyEn||"",companyJa:t.companyJa||""}:{period:"",title:"",titleEn:"",titleJa:"",company:"",companyEn:"",companyJa:"",description:"",details:[],skills:[],skillsEn:[],skillsJa:[],skillIds:[],order:0,iconKey:"FaBriefcase"},[c,h]=d.useState(x),[g,N]=d.useState(Array.isArray(c.skills)?c.skills.join(", "):""),[m,f]=d.useState(Array.isArray(c.skillsEn)?c.skillsEn.join(", "):""),[p,w]=d.useState(Array.isArray(c.skillsJa)?c.skillsJa.join(", "):""),[j,E]=d.useState(null),[S,v]=d.useState({category:"",categoryEn:"",categoryJa:"",content:"",contentEn:"",contentJa:""}),T=L=>{const k=c.skillIds||[],I=k.includes(L)?k.filter(P=>P!==L):[...k,L];h({...c,skillIds:I})},y=L=>{const k=(L.skills||[]).map(C=>C._id).filter(Boolean),_=c.skillIds||[],I=k.every(C=>_.includes(C));let P;if(I)P=_.filter(C=>!k.includes(C));else{const C=new Set([..._,...k]);P=Array.from(C)}h({...c,skillIds:P})},b=()=>{E((c.details||[]).length),v({category:"",categoryEn:"",categoryJa:"",content:"",contentEn:"",contentJa:""})},F=L=>{var _,I;const k=(c.details||[])[L];k&&(E(L),v({category:k.category,categoryEn:k.categoryEn||"",categoryJa:k.categoryJa||"",content:k.items.join(`
`),contentEn:((_=k.itemsEn)==null?void 0:_.join(`
`))||"",contentJa:((I=k.itemsJa)==null?void 0:I.join(`
`))||""}))},R=()=>{if(!S.category.trim()||!S.content.trim()){alert("카테고리 이름과 내용을 모두 입력해주세요.");return}const L=S.content.split(`
`).map(C=>C.trim()).filter(C=>C.length>0),k=S.contentEn.split(`
`).map(C=>C.trim()).filter(C=>C.length>0),_=S.contentJa.split(`
`).map(C=>C.trim()).filter(C=>C.length>0),I={category:S.category.trim(),categoryEn:S.categoryEn.trim()||void 0,categoryJa:S.categoryJa.trim()||void 0,items:L,itemsEn:k.length>0?k:void 0,itemsJa:_.length>0?_:void 0},P=[...c.details||[]];j!==null&&(P[j]=I),h({...c,details:P}),E(null),v({category:"",categoryEn:"",categoryJa:"",content:"",contentEn:"",contentJa:""})},$=()=>{E(null),v({category:"",categoryEn:"",categoryJa:"",content:"",contentEn:"",contentJa:""})},V=L=>{if(!confirm("이 카테고리를 삭제하시겠습니까?"))return;const k=[...c.details||[]];k.splice(L,1),h({...c,details:k})},z=L=>{const{active:k,over:_}=L;if(!_||k.id===_.id)return;const I=(c.details||[]).findIndex((G,D)=>D===k.id),P=(c.details||[]).findIndex((G,D)=>D===_.id);if(I===-1||P===-1)return;const C=[...c.details||[]],[M]=C.splice(I,1);if(!M)return;C.splice(P,0,M);const J=C.map((G,D)=>({...G,order:D}));h({...c,details:J})},W=c.title.trim()!==""&&c.company.trim()!==""&&c.period.trim()!=="",X=L=>{if(L.preventDefault(),!W){alert("필수 필드(기간, 직책, 회사/기관)를 모두 입력해주세요.");return}const k=g.split(",").map(J=>J.trim()).filter(J=>J.length>0),_=m.split(",").map(J=>J.trim()).filter(J=>J.length>0),I=p.split(",").map(J=>J.trim()).filter(J=>J.length>0),P=Array.from(new Set((c.skillIds||[]).map(J=>typeof J=="string"?J:J==null?void 0:J._id).filter(Boolean))),C=(c.details||[]).map((J,G)=>({...J,order:J.order??G})),M={...c,skills:k,skillsEn:_,skillsJa:I,skillIds:P,details:C};console.log("📤 경력 저장 데이터:",M),r(M)};return e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:t?"경력 수정":"경력 추가"}),e.jsx("div",{className:"mb-6",children:e.jsx(Je,{activeLanguage:n,onChange:l})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"기간"}),e.jsx("input",{type:"text",value:c.period,onChange:L=>h({...c,period:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"2018 - 2023"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["직책 ",n==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("input",{type:"text",value:c.title,onChange:L=>h({...c,title:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"바리스타"}),n==="en"&&e.jsx("input",{type:"text",value:c.titleEn||"",onChange:L=>h({...c,titleEn:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Barista"}),n==="ja"&&e.jsx("input",{type:"text",value:c.titleJa||"",onChange:L=>h({...c,titleJa:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"バリスタ"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["회사/기관 ",n==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("input",{type:"text",value:c.company,onChange:L=>h({...c,company:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"스타벅스커피코리아"}),n==="en"&&e.jsx("input",{type:"text",value:c.companyEn||"",onChange:L=>h({...c,companyEn:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Starbucks Coffee Korea"}),n==="ja"&&e.jsx("input",{type:"text",value:c.companyJa||"",onChange:L=>h({...c,companyJa:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"スターバックスコーヒージャパン"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"순서"}),e.jsx("input",{type:"number",value:c.order,onChange:L=>{const k=parseInt(L.target.value);h({...c,order:isNaN(k)?0:k})},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0",placeholder:"표시 순서 (숫자가 작을수록 먼저 표시)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"아이콘"}),e.jsx("select",{value:c.iconKey||"FaBriefcase",onChange:L=>h({...c,iconKey:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:Gr.map(L=>e.jsx("option",{value:L.key,children:L.label},L.key))}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"미리보기:"}),oe.createElement(((Q=Gr.find(L=>L.key===(c.iconKey||"FaBriefcase")))==null?void 0:Q.icon)||Dt,{className:"text-xl"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border-2 border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-bold text-gray-900 dark:text-white",children:"📋 카테고리별 상세 내용"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"근무경험, 교육, 근무매장 등 카테고리별로 구체적인 내용을 정리하세요"})]}),e.jsxs("button",{type:"button",onClick:b,disabled:j!==null,className:`px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2 text-sm ${j!==null?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(se,{className:"text-xs"}),"카테고리 추가"]})]}),c.details&&c.details.length>0&&e.jsx(Pt,{collisionDetection:Rt,onDragEnd:z,children:e.jsx(_t,{items:c.details.map((L,k)=>k),strategy:Jt,children:e.jsx("div",{className:"space-y-3 mb-4",children:c.details.map((L,k)=>e.jsx(ho,{detail:L,index:k,editingCategoryIndex:j,onEdit:F,onRemove:V},k))})})}),j!==null&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-lg border-2 border-blue-400 dark:border-blue-600 shadow-lg",children:[e.jsx("h5",{className:"font-bold text-gray-900 dark:text-white mb-4",children:j<(c.details||[]).length?"카테고리 수정":"카테고리 추가"}),e.jsx("div",{className:"mb-4",children:e.jsx(Je,{activeLanguage:n,onChange:l})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["카테고리 이름 ",n==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("input",{type:"text",value:S.category,onChange:L=>v({...S,category:L.target.value}),placeholder:"예: 근무경험, 교육, 근무매장",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-semibold"}),n==="en"&&e.jsx("input",{type:"text",value:S.categoryEn,onChange:L=>v({...S,categoryEn:L.target.value}),placeholder:"e.g., Work Experience, Education, Store",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-semibold"}),n==="ja"&&e.jsx("input",{type:"text",value:S.categoryJa,onChange:L=>v({...S,categoryJa:L.target.value}),placeholder:"例: 職務経験、教育、店舗",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-semibold"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["카테고리 내용 ",n==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsxs(e.Fragment,{children:[e.jsx(Ct,{value:S.content,onChange:L=>v({...S,content:L}),placeholder:`항목들을 한 줄씩 입력하세요
예:
매장인원 관리
신규파트너 교육
라떼아트 교육`,rows:8,className:"min-h-[200px]"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"💡 한 줄에 하나씩 항목을 입력하세요 (Enter로 구분)"})]}),n==="en"&&e.jsxs(e.Fragment,{children:[e.jsx(Ct,{value:S.contentEn,onChange:L=>v({...S,contentEn:L}),placeholder:`Enter items one per line
e.g.
Store Staff Management
New Partner Training
Latte Art Education`,rows:8,className:"min-h-[200px]"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"💡 Enter one item per line (separated by Enter)"})]}),n==="ja"&&e.jsxs(e.Fragment,{children:[e.jsx(Ct,{value:S.contentJa,onChange:L=>v({...S,contentJa:L}),placeholder:`1行に1項目を入力してください
例:
店舗スタッフ管理
新規パートナー教育
ラテアート教育`,rows:8,className:"min-h-[200px]"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"💡 1行に1項目を入力してください (Enterで区切る)"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:R,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(xe,{}),"저장"]}),e.jsx("button",{type:"button",onClick:$,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"취소"})]})]})]}),(!c.details||c.details.length===0)&&j===null&&e.jsxs("div",{className:"text-center py-6 bg-white dark:bg-gray-800 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-2",children:"아직 카테고리가 없습니다"}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:'상단의 "카테고리 추가" 버튼을 눌러 시작하세요'})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"설명 (리치텍스트 에디터) - 선택사항"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:'💡 위의 "카테고리별 상세 내용"을 사용하면 더 체계적으로 정리됩니다. 이 필드는 하위 호환성을 위해 유지됩니다.'}),e.jsx(Ct,{value:c.description||"",onChange:L=>h({...c,description:L}),placeholder:"(선택사항) 전체적인 설명을 작성하거나, 위의 카테고리별 입력을 사용하세요.",rows:4,className:"min-h-[150px]"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"이 경력에서 사용한 스킬 🔗"}),c.skillIds&&c.skillIds.length>0&&e.jsxs("span",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/30 px-2 py-1 rounded",children:["✓ ",c.skillIds.length,"개 선택됨"]})]}),i?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-2",children:"스킬 목록을 불러오는 중입니다..."}):o.length===0?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-4 text-center border border-gray-300 dark:border-gray-600 rounded-lg",children:"등록된 스킬이 없습니다. 먼저 스킬을 추가해주세요."}):e.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 bg-gray-50 dark:bg-gray-800 max-h-[400px] overflow-y-auto",children:o.map(L=>{const k=(L.skills||[]).map(M=>M._id).filter(Boolean),_=c.skillIds||[],I=k.filter(M=>_.includes(M)).length,P=k.length>0&&I===k.length,C=I>0&&I<k.length;return e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-gray-300 dark:border-gray-600 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded",onClick:()=>y(L),children:[e.jsx("input",{type:"checkbox",checked:P,ref:M=>{M&&(M.indeterminate=C)},onChange:()=>y(L),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",onClick:M=>M.stopPropagation()}),e.jsxs("label",{className:"font-semibold text-gray-900 dark:text-white flex-1 cursor-pointer",style:{color:L.color||"#3B82F6"},children:[L.title,I>0&&e.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-500 dark:text-gray-400",children:["(",I,"/",k.length,")"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-6",children:(L.skills||[]).map(M=>{const J=(c.skillIds||[]).includes(M._id);return e.jsxs("label",{className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors ${J?"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-700":"hover:bg-gray-100 dark:hover:bg-gray-700 border border-transparent"}`,children:[e.jsx("input",{type:"checkbox",checked:J,onChange:()=>T(M._id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:`text-sm ${J?"font-semibold text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300"}`,children:M.name})]},M._id)})})]},L._id)})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"💡 체크박스를 클릭하여 경력에서 사용한 스킬을 선택하세요. 카테고리 제목을 클릭하면 전체 선택/해제할 수 있습니다."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["기술 (쉼표로 구분) - 선택사항",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("input",{type:"text",value:g,onChange:L=>N(L.target.value),onBlur:()=>{const L=g.split(",").map(k=>k.trim()).filter(k=>k.length>0);h({...c,skills:L})},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"PLC 프로그래밍, Python, 데이터 분석"}),n==="en"&&e.jsx("input",{type:"text",value:m,onChange:L=>f(L.target.value),onBlur:()=>{const L=m.split(",").map(k=>k.trim()).filter(k=>k.length>0);h({...c,skillsEn:L})},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"PLC Programming, Python, Data Analysis"}),n==="ja"&&e.jsx("input",{type:"text",value:p,onChange:L=>w(L.target.value),onBlur:()=>{const L=p.split(",").map(k=>k.trim()).filter(k=>k.length>0);h({...c,skillsJa:L})},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"PLCプログラミング、Python、データ分析"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"💡 위의 스킬 체크박스를 사용하는 것을 권장합니다. 이 필드는 하위 호환성을 위해 유지됩니다."})]}),j!==null&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border-2 border-yellow-300 dark:border-yellow-700",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-300 font-medium",children:'⚠️ 카테고리 입력 중입니다. 위의 "저장" 버튼을 먼저 눌러 카테고리를 저장하세요.'})}),c.details&&c.details.length>0&&j===null&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border-2 border-green-300 dark:border-green-700",children:[e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-300 font-medium mb-2",children:["✅ ",c.details.length,"개의 카테고리가 준비되었습니다"]}),e.jsx("p",{className:"text-xs text-green-700 dark:text-green-400",children:'아래 "저장" 버튼을 눌러 경력 데이터를 최종 저장하세요'})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-300 dark:border-gray-600",children:[e.jsx("button",{type:"submit",disabled:s||!W||j!==null,className:`flex-1 flex items-center justify-center gap-2 bg-primary-600 hover:bg-primary-700 text-white font-bold py-3 rounded-lg transition-colors text-lg ${s||!W||j!==null?"opacity-50 cursor-not-allowed":"shadow-lg"}`,title:j!==null?"카테고리 입력을 먼저 완료하세요":"",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"저장 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"text-xl"})," 최종 저장"]})}),e.jsx("button",{type:"button",onClick:a,disabled:s,className:`flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium py-3 rounded-lg transition-colors ${s?"opacity-50 cursor-not-allowed":""}`,children:"취소"})]})]})},mo=()=>{const[t,r]=d.useState([]),[a,s]=d.useState(!1),n=d.useCallback(async()=>{s(!0);try{const u=await gt.getAll();r(u.data.data||[])}catch(u){console.error("Experience 데이터 로드 실패:",u)}finally{s(!1)}},[]),l=d.useCallback(async u=>{try{return await gt.create(u),await n(),{success:!0}}catch(x){return console.error("Experience 생성 실패:",x),{success:!1,error:x}}},[n]),o=d.useCallback(async(u,x)=>{try{return await gt.update(u,x),await n(),{success:!0}}catch(c){return console.error("Experience 수정 실패:",c),{success:!1,error:c}}},[n]),i=d.useCallback(async u=>{try{return await gt.delete(u),await n(),{success:!0}}catch(x){return console.error("Experience 삭제 실패:",x),{success:!1,error:x}}},[n]);return d.useEffect(()=>{n()},[]),{experiences:t,isLoading:a,fetchExperiences:n,createExperience:l,updateExperience:o,deleteExperience:i}},yo=({experienceFilter:t="all",experienceSearchTerm:r="",selectedExperienceCompany:a="",selectedExperienceYear:s=""})=>{const{t:n}=Qr(),{experiences:l,isLoading:o,createExperience:i,updateExperience:u,deleteExperience:x}=mo(),[c,h]=d.useState(!1),[g,N]=d.useState(null),[m,f]=d.useState(!1),[p,w]=d.useState(!1),j=d.useMemo(()=>{let b=[...l];if(t==="company"&&a?b=b.filter(F=>F.company===a):t==="year"&&s&&(b=b.filter(F=>(F.period||"").includes(s))),r){const F=r.toLowerCase();b=b.filter(R=>R.title.toLowerCase().includes(F)||R.company.toLowerCase().includes(F)||R.description&&R.description.toLowerCase().includes(F))}return b},[l,t,r,a,s]),E=async b=>{try{f(!0),g?(await u(g._id,b)).success&&(h(!1),N(null)):(await i(b)).success&&h(!1)}catch(F){console.error("저장 실패:",F)}finally{f(!1)}},S=()=>{h(!1),N(null)},v=async b=>{if(confirm(n("experience.confirmDelete")))try{w(!0),await x(b._id)}catch(F){console.error("삭제 실패:",F)}finally{w(!1)}},T=()=>{N(null),h(!0)},y=b=>{N(b),h(!0)};return o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2",children:n("experience.loading")})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:n("experience.management")}),e.jsxs("button",{onClick:T,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(se,{}),n("experience.add")]})]}),(t!=="all"||r||a||s)&&e.jsx("div",{className:"mb-4 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[n("experience.currentFilter"),t==="all"&&!r&&` 💼 ${n("experience.allExperiences")}`,t==="company"&&a&&` 🏢 ${a} ${n("experience.company_")}`,t==="year"&&s&&` 📅 ${s}${n("experience.year")}`,r&&` 🔍 "${r}" ${n("experience.search")}`]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[j.length,n("experience.showing")," ",l.length,n("experience.total")]})]})})}),c&&e.jsx("div",{className:"mb-6",children:e.jsx(po,{data:g,onSave:E,onCancel:S})}),j.length>0?e.jsx("div",{className:"space-y-4",children:j.map(b=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:b.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:b.company}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:b.period}),b.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 line-clamp-2",children:b.description})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>y(b),className:"p-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",disabled:m||p,children:e.jsx(be,{})}),e.jsx("button",{onClick:()=>v(b),className:"p-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",disabled:m||p,children:e.jsx(ie,{})})]})]})},b._id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg mb-4",children:n(t!=="all"||r||a||s?"experience.noFilteredResults":"experience.noExperiences")}),(t!=="all"||r||a||s)&&e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:n("experience.resetFilter")})]})]})},bo=t=>{const[r,a]=d.useState("ko"),s=t!=null&&t.categoryIds?t.categoryIds.map(p=>typeof p=="string"?p:p._id).filter(Boolean):[],n=t!=null&&t.skillIds?t.skillIds.map(p=>typeof p=="string"?p:p._id).filter(Boolean):[],[l,o]=d.useState(()=>t!=null&&t.videos&&Array.isArray(t.videos)?t.videos.map((p,w)=>{var j,E,S;return{url:p,description:((j=t.videoDescriptions)==null?void 0:j[w])||"",descriptionEn:((E=t.videoDescriptionsEn)==null?void 0:E[w])||"",descriptionJa:((S=t.videoDescriptionsJa)==null?void 0:S[w])||""}}):[]),[i,u]=d.useState(t?{...t,technologies:Array.isArray(t.technologies)?t.technologies.join(`
`):t.technologies||"",technologiesEn:Array.isArray(t.technologiesEn)?t.technologiesEn.join(`
`):t.technologiesEn||"",technologiesJa:Array.isArray(t.technologiesJa)?t.technologiesJa.join(`
`):t.technologiesJa||"",images:Array.isArray(t.images)?t.images.join(`
`):t.images||"",features:Array.isArray(t.features)?t.features.join(`
`):t.features||"",featuresEn:Array.isArray(t.featuresEn)?t.featuresEn.join(`
`):t.featuresEn||"",featuresJa:Array.isArray(t.featuresJa)?t.featuresJa.join(`
`):t.featuresJa||"",learnings:Array.isArray(t.learnings)?t.learnings.join(`
`):t.learnings||"",learningsEn:Array.isArray(t.learningsEn)?t.learningsEn.join(`
`):t.learningsEn||"",learningsJa:Array.isArray(t.learningsJa)?t.learningsJa.join(`
`):t.learningsJa||"",skillIds:n,categoryIds:s}:{title:"",titleEn:"",titleJa:"",description:"",descriptionEn:"",descriptionJa:"",technologies:"",technologiesEn:"",technologiesJa:"",category:"automation",categoryIds:[],status:"preparing",githubLink:"",liveLink:"",image:"",images:"",detailedDescription:"",detailedDescriptionEn:"",detailedDescriptionJa:"",features:"",featuresEn:"",featuresJa:"",learnings:"",learningsEn:"",learningsJa:"",order:0,skillIds:[]});return{formData:i,videoItems:l,currentLang:r,setCurrentLang:a,setFormData:u,setVideoItems:o,handleFieldChange:(p,w)=>{u(j=>({...j,[p]:w}))},handleArrayFieldChange:(p,w)=>{u(j=>({...j,[p]:w}))},handleVideoUrlChange:(p,w)=>{const j=[...l];j[p]&&(j[p].url=w,o(j))},handleVideoDescriptionChange:(p,w,j)=>{const E=[...l];E[p]&&(j==="ko"?E[p].description=w:j==="en"?E[p].descriptionEn=w:j==="ja"&&(E[p].descriptionJa=w),o(E))},handleAddVideo:()=>{o([...l,{url:"",description:"",descriptionEn:"",descriptionJa:""}])},handleRemoveVideo:p=>{o(l.filter((w,j)=>j!==p))},prepareDataForSubmit:()=>{const p=l.map(v=>v.url).filter(v=>v.trim().length>0),w=l.map(v=>v.description),j=l.map(v=>v.descriptionEn),E=l.map(v=>v.descriptionJa);for(let v=0;v<l.length;v++){const T=l[v];if(T){if(T.description&&T.description.length>5e3)throw new Error(`영상 ${v+1}의 한국어 설명이 너무 깁니다 (현재: ${T.description.length}자, 최대: 5000자)`);if(T.descriptionEn&&T.descriptionEn.length>5e3)throw new Error(`영상 ${v+1}의 영어 설명이 너무 깁니다 (현재: ${T.descriptionEn.length}자, 최대: 5000자)`);if(T.descriptionJa&&T.descriptionJa.length>5e3)throw new Error(`영상 ${v+1}의 일본어 설명이 너무 깁니다 (현재: ${T.descriptionJa.length}자, 최대: 5000자)`)}}return{...i,technologies:typeof i.technologies=="string"?i.technologies.split(/[,\n]/).map(v=>v.trim()).filter(v=>v.length>0):i.technologies||[],technologiesEn:typeof i.technologiesEn=="string"?i.technologiesEn.split(/[,\n]/).map(v=>v.trim()).filter(v=>v.length>0):i.technologiesEn||[],technologiesJa:typeof i.technologiesJa=="string"?i.technologiesJa.split(/[,\n]/).map(v=>v.trim()).filter(v=>v.length>0):i.technologiesJa||[],images:typeof i.images=="string"?i.images.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):i.images||[],videos:p,videoDescriptions:w,videoDescriptionsEn:j,videoDescriptionsJa:E,features:typeof i.features=="string"?i.features.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):i.features||[],featuresEn:typeof i.featuresEn=="string"?i.featuresEn.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):i.featuresEn||[],featuresJa:typeof i.featuresJa=="string"?i.featuresJa.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):i.featuresJa||[],learnings:typeof i.learnings=="string"?i.learnings.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):i.learnings||[],learningsEn:typeof i.learningsEn=="string"?i.learningsEn.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):i.learningsEn||[],learningsJa:typeof i.learningsJa=="string"?i.learningsJa.split(`
`).map(v=>v.trim()).filter(v=>v.length>0):i.learningsJa||[],skillIds:i.skillIds||[]}}}},fo=({data:t,onSave:r,onCancel:a,isSaving:s=!1})=>{const[n,l]=d.useState(()=>t!=null&&t.description?gr(t.description)==="editorjs":!1),[o,i]=d.useState(!1),[u,x]=d.useState(null),[c,h]=d.useState({show:!1,current:0,total:0,step:""}),{formData:g,videoItems:N,currentLang:m,setCurrentLang:f,setFormData:p,handleVideoUrlChange:w,handleVideoDescriptionChange:j,handleAddVideo:E,handleRemoveVideo:S,prepareDataForSubmit:v}=bo(t),{skillCategories:T,loading:y}=et(),{data:b=[],isLoading:F}=Bt(),R=k=>{const _=g.categoryIds||[],P=_.includes(k)?_.filter(C=>C!==k):[..._,k];p({...g,categoryIds:P})},$=k=>{const _=g.skillIds||[],I=_.includes(k),P=I?_.filter(C=>C!==k):[..._,k];console.log("🔧 스킬 변경:",{skillId:k,isSelected:!I,newSkillIds:P}),p({...g,skillIds:P})},V=k=>{const _=(k.skills||[]).map(M=>M._id).filter(Boolean),I=g.skillIds||[],P=_.every(M=>I.includes(M));let C;if(P)C=I.filter(M=>!_.includes(M));else{const M=new Set([...I,..._]);C=Array.from(M)}console.log("📁 카테고리 전체 변경:",{category:k.title,allSelected:!P,newSkillIds:C}),p({...g,skillIds:C})},z=k=>{Q().trim().length>0?(x(k),i(!0)):l(k)},W=()=>{u!==null&&(l(u),x(null)),i(!1)},X=()=>{x(null),i(!1)},Q=()=>{switch(m){case"ko":return g.description||"";case"en":return g.descriptionEn||"";case"ja":return g.descriptionJa||"";default:return""}},L=()=>{try{console.log("💾 저장 시작 - videoItems:",N),console.log("🔗 선택된 스킬 IDs:",g.skillIds);const k=v();console.log("✅ 최종 processedData:",k),console.log("✅ 최종 skillIds:",k.skillIds),r(k)}catch(k){console.error("❌ 저장 중 오류 발생:",k),alert(k.message||"저장 중 오류가 발생했습니다. 콘솔을 확인해주세요.")}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:t?"프로젝트 수정":"프로젝트 추가"}),e.jsx(Je,{activeLanguage:m,onChange:f}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(xr,{checked:n,onChange:z,className:"mb-2"}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:n?e.jsxs(e.Fragment,{children:["✨ ",e.jsx("strong",{children:"Editor.js 모드"}),": 노션에서 복사-붙여넣기 지원, 블록 기반 편집",e.jsx("br",{}),"💡 노션에서 작성한 내용을 복사해서 붙여넣으면 자동으로 변환됩니다!"]}):e.jsxs(e.Fragment,{children:["📝 ",e.jsx("strong",{children:"마크다운 모드"}),": 기존 마크다운 에디터 사용",e.jsx("br",{}),"💡 간단한 텍스트 편집에 적합합니다."]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["제목 ",m==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",m==="ko"?"🇰🇷 한국어":m==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),m==="ko"&&e.jsx("input",{type:"text",value:g.title,onChange:k=>p({...g,title:k.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"프로젝트 제목",required:!0}),m==="en"&&e.jsx("input",{type:"text",value:g.titleEn||"",onChange:k=>p({...g,titleEn:k.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Project Title"}),m==="ja"&&e.jsx("input",{type:"text",value:g.titleJa||"",onChange:k=>p({...g,titleJa:k.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"プロジェクトタイトル"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"카테고리 선택 📂 (다중 선택 가능)"}),g.categoryIds&&g.categoryIds.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:g.categoryIds.map(k=>{const _=b.find(I=>I._id===k);return _?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-600 text-white rounded-full text-sm",children:[_.name,e.jsx("button",{type:"button",onClick:()=>R(k),className:"hover:bg-blue-700 rounded-full p-0.5",children:e.jsx(Ne,{className:"text-xs"})})]},k):null})}),F?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"카테고리 로딩 중..."}):b.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:b.map(k=>{const _=(g.categoryIds||[]).includes(k._id);return e.jsxs("label",{className:`flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all ${_?"border-primary-600 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("input",{type:"checkbox",checked:_,onChange:()=>R(k._id),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:k.name})]},k._id)})}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:'등록된 카테고리가 없습니다. 관리자 메뉴의 "카테고리 관리"에서 추가하세요.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"상태"}),e.jsxs("select",{value:g.status,onChange:k=>p({...g,status:k.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"preparing",children:"준비 중"}),e.jsx("option",{value:"planning",children:"계획 중"}),e.jsx("option",{value:"completed",children:"완료"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"GitHub URL"}),e.jsx("input",{type:"text",value:g.githubLink||"",onChange:k=>p({...g,githubLink:k.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"https://github.com/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Live URL"}),e.jsx("input",{type:"text",value:g.liveLink||"",onChange:k=>p({...g,liveLink:k.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"이미지 URL"}),e.jsx("input",{type:"text",value:g.image,onChange:k=>p({...g,image:k.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"순서"}),e.jsx("input",{type:"number",value:g.order,onChange:k=>p({...g,order:parseInt(k.target.value)}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"사용된 스킬 (프로젝트 연동) 🔗"}),g.skillIds&&g.skillIds.length>0&&e.jsxs("span",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/30 px-2 py-1 rounded",children:["✓ ",g.skillIds.length,"개 선택됨"]})]}),y?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-2",children:"스킬 목록을 불러오는 중입니다..."}):T.length===0?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-4 text-center border border-gray-300 dark:border-gray-600 rounded-lg",children:"등록된 스킬이 없습니다. 먼저 스킬을 추가해주세요."}):e.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 bg-gray-50 dark:bg-gray-800 max-h-[400px] overflow-y-auto",children:T.map(k=>{const _=(k.skills||[]).map(M=>M._id).filter(Boolean),I=_.filter(M=>(g.skillIds||[]).includes(M)).length,P=_.length>0&&I===_.length,C=I>0&&I<_.length;return e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-gray-300 dark:border-gray-600 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded",onClick:()=>V(k),children:[e.jsx("input",{type:"checkbox",checked:P,ref:M=>{M&&(M.indeterminate=C)},onChange:()=>V(k),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",onClick:M=>M.stopPropagation()}),e.jsxs("label",{className:"font-semibold text-gray-900 dark:text-white flex-1 cursor-pointer",style:{color:k.color||"#3B82F6"},children:[k.title,I>0&&e.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-500 dark:text-gray-400",children:["(",I,"/",_.length,")"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-6",children:(k.skills||[]).map(M=>{const J=(g.skillIds||[]).includes(M._id);return e.jsxs("label",{className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors ${J?"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-700":"hover:bg-gray-100 dark:hover:bg-gray-700 border border-transparent"}`,children:[e.jsx("input",{type:"checkbox",checked:J,onChange:()=>$(M._id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:`text-sm ${J?"font-semibold text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300"}`,children:M.name})]},M._id)})})]},k._id)})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"💡 체크박스를 클릭하여 프로젝트에서 사용한 스킬을 선택하세요. 카테고리 제목을 클릭하면 전체 선택/해제할 수 있습니다."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["설명 (리치텍스트 에디터)",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",m==="ko"?"🇰🇷 한국어":m==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),m==="ko"&&(n?e.jsx(te,{value:g.description||"",onChange:k=>p({...g,description:k}),placeholder:"프로젝트에 대한 간단한 설명을 작성하세요.",className:"min-h-[150px]"}):e.jsx(RichTextEditor,{value:g.description||"",onChange:k=>p({...g,description:k}),placeholder:"프로젝트에 대한 간단한 설명을 작성하세요.",rows:4,className:"min-h-[150px]"})),m==="en"&&(n?e.jsx(te,{value:g.descriptionEn||"",onChange:k=>p({...g,descriptionEn:k}),placeholder:"Write a brief description of the project.",className:"min-h-[150px]"}):e.jsx(RichTextEditor,{value:g.descriptionEn||"",onChange:k=>p({...g,descriptionEn:k}),placeholder:"Write a brief description of the project.",rows:4,className:"min-h-[150px]"})),m==="ja"&&(n?e.jsx(te,{value:g.descriptionJa||"",onChange:k=>p({...g,descriptionJa:k}),placeholder:"プロジェクトの簡単な説明を書いてください。",className:"min-h-[150px]"}):e.jsx(RichTextEditor,{value:g.descriptionJa||"",onChange:k=>p({...g,descriptionJa:k}),placeholder:"プロジェクトの簡単な説明を書いてください。",rows:4,className:"min-h-[150px]"}))]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["기술 스택 (쉼표 또는 줄바꿈으로 구분)",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",m==="ko"?"🇰🇷 한국어":m==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),m==="ko"&&e.jsx("textarea",{value:typeof g.technologies=="string"?g.technologies:Array.isArray(g.technologies)?g.technologies.join(`
`):"",onChange:k=>p({...g,technologies:k.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:"PLC, Python, Arduino"}),m==="en"&&e.jsx("textarea",{value:typeof g.technologiesEn=="string"?g.technologiesEn:Array.isArray(g.technologiesEn)?g.technologiesEn.join(`
`):"",onChange:k=>p({...g,technologiesEn:k.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:"PLC, Python, Arduino"}),m==="ja"&&e.jsx("textarea",{value:typeof g.technologiesJa=="string"?g.technologiesJa:Array.isArray(g.technologiesJa)?g.technologiesJa.join(`
`):"",onChange:k=>p({...g,technologiesJa:k.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:"PLC, Python, Arduino"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"추가 이미지 URLs (줄바꿈으로 구분)"}),e.jsx("textarea",{value:typeof g.images=="string"?g.images:Array.isArray(g.images)?g.images.join(`
`):"",onChange:k=>{const _=k.target.value;p({...g,images:_})},rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:`https://example.com/image1.jpg\r
https://example.com/image2.jpg`})]}),e.jsxs("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-6 space-y-4 bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("label",{className:"block text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Qe,{className:"text-blue-600 dark:text-blue-400"}),"동영상 관리"]}),e.jsxs("button",{type:"button",onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(se,{})," 영상 추가"]})]}),N.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(Qe,{className:"text-4xl mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"아직 추가된 영상이 없습니다."}),e.jsx("p",{className:"text-sm mt-1",children:'위의 "영상 추가" 버튼을 클릭하여 영상을 추가하세요.'})]}):e.jsx("div",{className:"space-y-6",children:N.map((k,_)=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-900 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded-full text-sm font-bold",children:_+1}),"영상 ",_+1]}),e.jsxs("button",{type:"button",onClick:()=>S(_),className:"flex items-center gap-1 px-3 py-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-sm",children:[e.jsx(ie,{})," 삭제"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"영상 URL *"}),e.jsx("input",{type:"url",value:k.url,onChange:I=>w(_,I.target.value),placeholder:"https://youtube.com/watch?v=... 또는 https://youtube.com/shorts/...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["영상 설명 (리치텍스트)",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",m==="ko"?"🇰🇷 한국어":m==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),e.jsxs("span",{className:`text-xs ${(m==="ko"?k.description.length:m==="en"?k.descriptionEn.length:k.descriptionJa.length)>5e3?"text-red-600 dark:text-red-400 font-bold":(m==="ko"?k.description.length:m==="en"?k.descriptionEn.length:k.descriptionJa.length)>4e3?"text-orange-600 dark:text-orange-400":"text-gray-500 dark:text-gray-400"}`,children:[m==="ko"?k.description.length:m==="en"?k.descriptionEn.length:k.descriptionJa.length," / 5000자"]})]}),m==="ko"&&e.jsx(RichTextEditor,{value:k.description,onChange:I=>j(_,I,"ko"),placeholder:"이 영상에 대한 상세한 설명을 작성하세요. 굵게, 기울임, 리스트 등 다양한 서식을 사용할 수 있습니다.",rows:4,className:"min-h-[150px]"}),m==="en"&&e.jsx(RichTextEditor,{value:k.descriptionEn,onChange:I=>j(_,I,"en"),placeholder:"Write a detailed description of this video. You can use bold, italic, lists, and other formatting.",rows:4,className:"min-h-[150px]"}),m==="ja"&&e.jsx(RichTextEditor,{value:k.descriptionJa,onChange:I=>j(_,I,"ja"),placeholder:"この動画の詳細な説明を書いてください。太字、斜体、リストなどの書式を使用できます。",rows:4,className:"min-h-[150px]"}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"💡 이 설명은 프로젝트 상세 페이지에서 영상 하단에 표시됩니다."}),(m==="ko"?k.description.length:m==="en"?k.descriptionEn.length:k.descriptionJa.length)>4e3&&e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"⚠️ 글자 수가 많습니다. 간결하게 작성해주세요."})]})]})]},_))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["상세 설명 (리치텍스트 에디터)",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",m==="ko"?"🇰🇷 한국어":m==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),m==="ko"&&(n?e.jsx(te,{value:g.detailedDescription||"",onChange:k=>p({...g,detailedDescription:k}),placeholder:"프로젝트의 상세한 설명을 작성해주세요.",className:"min-h-[200px]"}):e.jsx(RichTextEditor,{value:g.detailedDescription||"",onChange:k=>p({...g,detailedDescription:k}),placeholder:"프로젝트의 상세한 설명을 작성해주세요.",rows:6,className:"min-h-[200px]"})),m==="en"&&(n?e.jsx(te,{value:g.detailedDescriptionEn||"",onChange:k=>p({...g,detailedDescriptionEn:k}),placeholder:"Write a detailed description of the project.",className:"min-h-[200px]"}):e.jsx(RichTextEditor,{value:g.detailedDescriptionEn||"",onChange:k=>p({...g,detailedDescriptionEn:k}),placeholder:"Write a detailed description of the project.",rows:6,className:"min-h-[200px]"})),m==="ja"&&(n?e.jsx(te,{value:g.detailedDescriptionJa||"",onChange:k=>p({...g,detailedDescriptionJa:k}),placeholder:"プロジェクトの詳細な説明を書いてください。",className:"min-h-[200px]"}):e.jsx(RichTextEditor,{value:g.detailedDescriptionJa||"",onChange:k=>p({...g,detailedDescriptionJa:k}),placeholder:"プロジェクトの詳細な説明を書いてください。",rows:6,className:"min-h-[200px]"}))]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["주요 기능 (줄바꿈으로 구분)",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",m==="ko"?"🇰🇷 한국어":m==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),m==="ko"&&e.jsx("textarea",{value:typeof g.features=="string"?g.features:Array.isArray(g.features)?g.features.join(`
`):"",onChange:k=>p({...g,features:k.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:`실시간 모니터링
데이터 수집 및 분석
알림 시스템`}),m==="en"&&e.jsx("textarea",{value:typeof g.featuresEn=="string"?g.featuresEn:Array.isArray(g.featuresEn)?g.featuresEn.join(`
`):"",onChange:k=>p({...g,featuresEn:k.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:`Real-time monitoring
Data collection and analysis
Alert system`}),m==="ja"&&e.jsx("textarea",{value:typeof g.featuresJa=="string"?g.featuresJa:Array.isArray(g.featuresJa)?g.featuresJa.join(`
`):"",onChange:k=>p({...g,featuresJa:k.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:`リアルタイム監視
データ収集と分析
通知システム`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["학습 내용 (줄바꿈으로 구분)",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",m==="ko"?"🇰🇷 한국어":m==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),m==="ko"&&e.jsx("textarea",{value:typeof g.learnings=="string"?g.learnings:Array.isArray(g.learnings)?g.learnings.join(`
`):"",onChange:k=>p({...g,learnings:k.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:`PLC 프로그래밍 기법
실시간 데이터 처리
웹 기반 대시보드 구축`}),m==="en"&&e.jsx("textarea",{value:typeof g.learningsEn=="string"?g.learningsEn:Array.isArray(g.learningsEn)?g.learningsEn.join(`
`):"",onChange:k=>p({...g,learningsEn:k.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:`PLC programming techniques
Real-time data processing
Web-based dashboard development`}),m==="ja"&&e.jsx("textarea",{value:typeof g.learningsJa=="string"?g.learningsJa:Array.isArray(g.learningsJa)?g.learningsJa.join(`
`):"",onChange:k=>p({...g,learningsJa:k.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-y",placeholder:`PLCプログラミング技術
リアルタイムデータ処理
Webベースダッシュボード開発`})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:L,disabled:s,className:`flex-1 flex items-center justify-center gap-2 bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 rounded-lg transition-colors ${s?"opacity-50 cursor-not-allowed":""}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"저장 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{})," 저장"]})}),e.jsx("button",{type:"button",onClick:a,className:"flex-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium py-2 rounded-lg transition-colors",children:"취소"})]}),e.jsx(hr,{show:o,onConfirm:W,onCancel:X,title:"에디터 변경",message:"에디터를 변경하면 현재 편집 중인 내용이 사라질 수 있습니다. 계속하시겠습니까?"}),e.jsx(pr,{show:c.show,current:c.current,total:c.total,step:c.step,onCancel:()=>h(k=>({...k,show:!1}))})]})},ko=()=>{const[t,r]=d.useState([]),[a,s]=d.useState(!1),n=d.useCallback(async()=>{s(!0);try{console.log("📥 프로젝트 목록 가져오기...");const x=(await ut.getAll()).data.data||[];console.log(`✅ ${x.length}개 프로젝트 로드됨`),console.log("📊 프로젝트 데이터:",x),r(x)}catch(u){console.error("❌ Project 데이터 로드 실패:",u)}finally{s(!1)}},[]),l=d.useCallback(async u=>{try{console.log("➕ 프로젝트 생성 API 호출:",u);const x=await ut.create(u);return console.log("✅ 서버 응답:",x.data),console.log("🔄 프로젝트 목록 새로고침 시작..."),await n(),console.log("✅ 프로젝트 목록 새로고침 완료"),{success:!0}}catch(x){return console.error("❌ Project 생성 실패:",x),{success:!1,error:x}}},[n]),o=d.useCallback(async(u,x)=>{try{console.log("🔄 프로젝트 수정 API 호출:",{id:u,projectData:x});const c=await ut.update(u,x);return console.log("✅ 서버 응답:",c.data),console.log("🔄 프로젝트 목록 새로고침 시작..."),await n(),console.log("✅ 프로젝트 목록 새로고침 완료"),{success:!0}}catch(c){return console.error("❌ Project 수정 실패:",c),{success:!1,error:c}}},[n]),i=d.useCallback(async u=>{try{return await ut.delete(u),await n(),{success:!0}}catch(x){return console.error("Project 삭제 실패:",x),{success:!1,error:x}}},[n]);return d.useEffect(()=>{n()},[]),{projects:t,isLoading:a,fetchProjects:n,createProject:l,updateProject:o,deleteProject:i}},vo=({projectFilter:t="all",projectSearchTerm:r="",selectedProjectCategory:a=""})=>{const{projects:s,isLoading:n,createProject:l,updateProject:o,deleteProject:i}=ko(),[u,x]=d.useState(!1),[c,h]=d.useState(null),[g,N]=d.useState(!1),[m,f]=d.useState(!1),p=d.useMemo(()=>{let y=[...s];if(t==="category"&&a?y=y.filter(b=>b.category===a):t==="featured"&&(y=y.filter(b=>b.status==="completed"&&b.detailedDescription&&b.detailedDescription.trim().length>0)),r){const b=r.toLowerCase();y=y.filter(F=>F.title.toLowerCase().includes(b)||F.description.toLowerCase().includes(b)||F.technologies&&F.technologies.some(R=>R.toLowerCase().includes(b))||F.category&&F.category.toLowerCase().includes(b))}return y},[s,t,r,a]),w=d.useMemo(()=>s.filter(y=>y.status==="completed"&&y.detailedDescription&&y.detailedDescription.trim().length>0).length,[s]),j=async y=>{var b,F,R,$,V,z,W,X,Q,L,k,_,I;console.log("🎯 ProjectManager handleSave 호출됨"),console.log("📦 받은 데이터:",y),console.log("🔗 skillIds:",y.skillIds);try{if(N(!0),console.log("⏳ isSaving = true 설정됨"),c){console.log("✏️ 프로젝트 수정 모드:",c._id);const P=await o(c._id,y);if(console.log("✅ 수정 결과:",P),P.success)x(!1),h(null),alert("✅ 프로젝트가 성공적으로 수정되었습니다!");else{console.error("❌ 서버 거부 이유:",P.error);const C=((R=(F=(b=P.error)==null?void 0:b.response)==null?void 0:F.data)==null?void 0:R.message)||"알 수 없는 오류";alert(`❌ 프로젝트 수정 실패: ${C}`),(V=($=P.error)==null?void 0:$.response)!=null&&V.data&&console.error("📋 서버 응답 상세:",P.error.response.data)}}else{console.log("➕ 프로젝트 생성 모드");const P=await l(y);if(console.log("✅ 생성 결과:",P),P.success)x(!1),alert("✅ 프로젝트가 성공적으로 추가되었습니다!");else{console.error("❌ 서버 거부 이유:",P.error);const C=((X=(W=(z=P.error)==null?void 0:z.response)==null?void 0:W.data)==null?void 0:X.message)||"알 수 없는 오류";alert(`❌ 프로젝트 추가 실패: ${C}`),(L=(Q=P.error)==null?void 0:Q.response)!=null&&L.data&&console.error("📋 서버 응답 상세:",P.error.response.data)}}}catch(P){console.error("❌ 저장 실패:",P);const C=((_=(k=P==null?void 0:P.response)==null?void 0:k.data)==null?void 0:_.message)||P.message||"알 수 없는 오류";alert(`❌ 저장 중 오류 발생: ${C}`),(I=P==null?void 0:P.response)!=null&&I.data&&(console.error("📋 서버 응답 상세:",P.response.data),console.error("🔢 상태 코드:",P.response.status))}finally{console.log("🏁 isSaving = false 설정됨"),N(!1)}},E=()=>{x(!1),h(null)},S=async y=>{if(confirm("정말 삭제하시겠습니까?"))try{f(!0),await i(y._id)}catch(b){console.error("삭제 실패:",b)}finally{f(!1)}},v=()=>{h(null),x(!0)},T=y=>{h(y),x(!0)};return n?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2",children:"프로젝트 데이터를 불러오는 중..."})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"프로젝트 관리"}),e.jsxs("button",{onClick:v,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(se,{}),"프로젝트 추가"]})]}),(t!=="all"||r||a)&&e.jsx("div",{className:"mb-4 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["현재 필터:",t==="all"&&!r&&" 📁 모든 프로젝트",t==="category"&&a&&` 🏷️ ${a} 카테고리`,t==="featured"&&" 🌟 주요 프로젝트",r&&` 🔍 "${r}" 검색`]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[p.length,"개 프로젝트 표시 중 (전체 ",s.length,"개)",t==="featured"&&` (주요 프로젝트: ${w}개)`]})]})})}),u&&e.jsx("div",{className:"mb-6",children:e.jsx(fo,{data:c,onSave:j,onCancel:E,isSaving:g})}),p.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(y=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:y.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-2 line-clamp-2",children:y.description}),y.category&&e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-3",children:y.category}),y.technologies&&y.technologies.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[y.technologies.slice(0,3).map((b,F)=>e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-2 py-1 rounded",children:b},F)),y.technologies.length>3&&e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",y.technologies.length-3]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${y.status==="completed"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300"}`,children:y.status==="completed"?"완료":"진행중"}),y.status==="completed"&&y.detailedDescription&&y.detailedDescription.trim().length>0&&e.jsx("span",{className:"text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 px-2 py-1 rounded",children:"🌟 주요"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(y),className:"p-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",disabled:g||m,children:e.jsx(be,{})}),e.jsx("button",{onClick:()=>S(y),className:"p-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",disabled:g||m,children:e.jsx(ie,{})})]})]})]},y._id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg mb-4",children:t!=="all"||r||a?"필터 조건에 맞는 프로젝트가 없습니다.":"등록된 프로젝트가 없습니다."}),(t!=="all"||r||a)&&e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"필터를 초기화하거나 다른 검색어를 시도해보세요."})]})]})},st="adminMessages",Sa=()=>dr({queryKey:[st,"list"],queryFn:async()=>{const t=await Ve.getAll();return t.data.data||t.data||[]},staleTime:2*60*1e3,gcTime:5*60*1e3}),jo=()=>{const t=ke();return Se({mutationFn:async r=>{await Ve.markAsRead(r)},onSuccess:()=>{t.invalidateQueries({queryKey:[st]}),t.invalidateQueries({queryKey:["dataCounts"]})}})},wo=()=>{const t=ke();return Se({mutationFn:async r=>{await Ve.delete(r)},onSuccess:()=>{t.invalidateQueries({queryKey:[st]}),t.invalidateQueries({queryKey:["dataCounts"]})}})},No=()=>{const t=ke();return Se({mutationFn:r=>Promise.all(r.map(a=>Ve.markAsRead(a))).then(()=>{}),onSuccess:()=>{t.invalidateQueries({queryKey:[st]}),t.invalidateQueries({queryKey:["dataCounts"]})}})},Co=()=>{const t=ke();return Se({mutationFn:r=>Promise.all(r.map(a=>Ve.delete(a))).then(()=>{}),onSuccess:()=>{t.invalidateQueries({queryKey:[st]}),t.invalidateQueries({queryKey:["dataCounts"]})}})},So=()=>{const{data:t=[],isLoading:r}=Sa(),a=jo(),s=wo(),n=No(),l=Co();return{messages:t,isLoading:r,fetchMessages:()=>{},markAsRead:async c=>{try{return await a.mutateAsync(c),{success:!0}}catch(h){return console.error("Message 읽음 처리 실패:",h),{success:!1,error:h}}},deleteMessage:async c=>{try{return await s.mutateAsync(c),{success:!0}}catch(h){return console.error("Message 삭제 실패:",h),{success:!1,error:h}}},bulkMarkAsRead:async c=>{try{return await n.mutateAsync(c),{success:!0}}catch(h){return console.error("Message 일괄 읽음 처리 실패:",h),{success:!1,error:h}}},bulkDelete:async c=>{try{return await l.mutateAsync(c),{success:!0}}catch(h){return console.error("Message 일괄 삭제 실패:",h),{success:!1,error:h}}}}};function Eo(t,r={}){const{enabled:a=!0,staleTime:s=5*60*1e3}=r;return dr({queryKey:[st,"detail",t],queryFn:async()=>t?(await Ve.getById(t)).data.data:null,enabled:!!t&&a,staleTime:s,gcTime:10*60*1e3,retry:2,retryDelay:n=>Math.min(1e3*2**n,3e4),refetchOnWindowFocus:!1,select:n=>n||null})}const Io=({messageId:t,isOpen:r,onClose:a,onMarkAsRead:s,onDelete:n,onReply:l})=>{const[o,i]=d.useState(!1),[u,x]=d.useState(!1),[c,h]=d.useState(""),{data:g,isLoading:N,isError:m,error:f,refetch:p}=Eo(t,{enabled:r&&!!t}),w=async()=>{if(!(!g||g.isRead))try{i(!0),await s(g._id)}catch(T){console.error("읽음 처리 실패:",T)}finally{i(!1)}},j=async()=>{if(!(!g||!confirm("정말 이 메시지를 삭제하시겠습니까?")))try{i(!0),await n(g._id),a()}catch(T){console.error("삭제 실패:",T)}finally{i(!1)}},E=()=>{g&&(l?l(g):x(!0))},S=()=>{console.log("답장 내용:",c),alert("답장 기능은 향후 구현 예정입니다."),x(!1),h("")},v=T=>new Date(T).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return r?N?e.jsx(Ue,{children:e.jsx(me.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsx(me.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-8",onClick:T=>T.stopPropagation(),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(Ka,{className:"text-4xl text-blue-600 dark:text-blue-400 animate-spin mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"메시지 로딩 중..."}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"잠시만 기다려주세요"})]})})})}):m?e.jsx(Ue,{children:e.jsx(me.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsx(me.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-8",onClick:T=>T.stopPropagation(),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-4xl mb-4",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"메시지를 불러올 수 없습니다"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:(f==null?void 0:f.message)||"알 수 없는 오류가 발생했습니다."}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:()=>p(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"다시 시도"}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"닫기"})]})]})})})}):g?e.jsx(Ue,{children:e.jsx(me.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(me.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:T=>T.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Nt,{className:"text-blue-600 dark:text-blue-400 text-xl"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"메시지 상세"}),!g.isRead&&e.jsx("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:"새 메시지"})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(Ne,{className:"text-gray-500 dark:text-gray-400"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ga,{className:"text-gray-500 dark:text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"보낸이"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:g.name})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Nt,{className:"text-gray-500 dark:text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"이메일"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:g.email})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Xa,{className:"text-gray-500 dark:text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"받은 시간"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:v(g.createdAt||"")})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"상태"}),e.jsx("div",{className:"flex items-center gap-2",children:g.isRead?e.jsxs("span",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[e.jsx(rr,{})," 읽음"]}):e.jsxs("span",{className:"flex items-center gap-1 text-blue-600 dark:text-blue-400",children:[e.jsx(Nt,{})," 읽지 않음"]})})]})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:g.subject})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-3",children:"메시지 내용"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-900 dark:text-white whitespace-pre-wrap",children:g.message})})]}),e.jsx(Ue,{children:u&&e.jsxs(me.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-6 border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"답장 작성"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"받는 사람"}),e.jsx("input",{type:"email",value:g.email,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"답장 내용"}),e.jsx("textarea",{value:c,onChange:T=>h(T.target.value),placeholder:"답장 내용을 입력하세요...",rows:6,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:S,disabled:!c.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[e.jsx(Lr,{})," 답장 보내기"]}),e.jsx("button",{onClick:()=>{x(!1),h("")},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"취소"})]})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700",children:[e.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Lr,{})," 답장"]}),e.jsxs("div",{className:"flex gap-3",children:[!g.isRead&&e.jsxs("button",{onClick:w,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx(rr,{})," ",o?"처리 중...":"읽음 처리"]}),e.jsxs("button",{onClick:j,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx(ie,{})," ",o?"삭제 중...":"삭제"]})]})]})]})})}):e.jsx(Ue,{children:e.jsx(me.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsx(me.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-8",onClick:T=>T.stopPropagation(),children:e.jsxs("div",{className:"text-center",children:[e.jsx(Nt,{className:"text-4xl text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"메시지를 찾을 수 없습니다"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"요청하신 메시지가 존재하지 않거나 삭제되었습니다."}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"닫기"})]})})})}):null},Do=()=>{const{messages:t,isLoading:r,markAsRead:a,deleteMessage:s}=So(),[n,l]=d.useState(!1),[o,i]=d.useState(void 0),[u,x]=d.useState(!1),c=async p=>{try{await a(p._id)}catch(w){console.error("읽음 처리 실패:",w)}},h=async p=>{if(confirm("정말 삭제하시겠습니까?"))try{l(!0),await s(p._id)}catch(w){console.error("삭제 실패:",w)}finally{l(!1)}},g=p=>{i(p._id),x(!0)},N=()=>{x(!1),i(void 0)},m=async p=>{await a(p)},f=async p=>{await s(p),N()};return r?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2",children:"메시지 데이터를 불러오는 중..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"메시지 관리"}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["총 ",t.length,"개의 메시지"]})]}),e.jsx("div",{className:"space-y-4",children:t.map(p=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>g(p),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:p.subject}),!p.isRead&&e.jsx("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:"새 메시지"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:p.message.length>100?`${p.message.substring(0,100)}...`:p.message}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-500",children:[e.jsxs("p",{children:["보낸이: ",p.name," (",p.email,")"]}),e.jsxs("p",{children:["받은 시간: ",p.createdAt?new Date(p.createdAt).toLocaleString("ko-KR"):"알 수 없음"]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",onClick:w=>w.stopPropagation(),children:[e.jsx("button",{onClick:()=>g(p),className:"p-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",title:"상세 보기",children:e.jsx(Zr,{})}),!p.isRead&&e.jsx("button",{onClick:()=>c(p),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors text-sm",children:"읽음 처리"}),e.jsx("button",{onClick:()=>h(p),className:"p-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",disabled:n,title:"삭제",children:e.jsx(ie,{})})]})]})},p._id))})]}),u&&e.jsx(Io,{messageId:o,isOpen:u,onClose:N,onMarkAsRead:m,onDelete:f})]})},De=["skillCategories"],To=()=>{const t=ke();return Se({mutationFn:async({id:r,data:a})=>{var n;const s=await qe.update(r,a);return((n=s.data)==null?void 0:n.data)||s.data},onMutate:async({id:r,data:a})=>{await t.cancelQueries({queryKey:De});const s=t.getQueryData(De);return t.setQueryData(De,n=>n?n.map(l=>{var o;return{...l,skills:((o=l.skills)==null?void 0:o.map(i=>i._id===r?{...i,...a,updatedAt:new Date().toISOString()}:i))||[]}}):s),{previousCategories:s}},onError:(r,a,s)=>{console.error("❌ 스킬 업데이트 실패 - 롤백 실행:",r),s!=null&&s.previousCategories&&t.setQueryData(De,s.previousCategories)}})},Lo=()=>{const t=ke();return Se({mutationFn:async r=>{var s;const a=await qe.createCategory(r);return((s=a.data)==null?void 0:s.data)||a.data},onSuccess:()=>{t.invalidateQueries({queryKey:De})}})},Ao=()=>{const t=ke();return Se({mutationFn:async({id:r,data:a})=>{var n;const s=await qe.updateCategory(r,a);return((n=s.data)==null?void 0:n.data)||s.data},onSuccess:()=>{t.invalidateQueries({queryKey:De})}})},Fo=()=>{const t=ke();return Se({mutationFn:async r=>{await qe.deleteCategory(r)},onSuccess:()=>{t.invalidateQueries({queryKey:De})}})},Ro=()=>{const t=ke();return Se({mutationFn:async({categoryId:r,data:a})=>{var n;const s=await qe.create(r,a);return((n=s.data)==null?void 0:n.data)||s.data},onSuccess:()=>{t.invalidateQueries({queryKey:De})}})},Mo=()=>{const t=ke();return Se({mutationFn:async r=>{await qe.delete(r)},onSuccess:()=>{t.invalidateQueries({queryKey:De})}})},Po=()=>{const{skillCategories:t,loading:r,refetch:a}=et(),s=To(),n=Lo(),l=Ao(),o=Fo(),i=Ro(),u=Mo();return{skillCategories:t,isLoading:r,fetchSkillCategories:a,createSkillCategory:async f=>{try{return{success:!0,data:await n.mutateAsync(f)}}catch(p){return console.error("스킬 카테고리 생성 실패:",p),{success:!1,error:p}}},updateSkillCategory:async(f,p)=>{try{return{success:!0,data:await l.mutateAsync({id:f,data:p})}}catch(w){return console.error("스킬 카테고리 수정 실패:",w),{success:!1,error:w}}},deleteSkillCategory:async f=>{try{return await o.mutateAsync(f),{success:!0}}catch(p){return console.error("스킬 카테고리 삭제 실패:",p),{success:!1,error:p}}},createSkill:async(f,p)=>{try{return{success:!0,data:await i.mutateAsync({categoryId:f,data:p})}}catch(w){return console.error("스킬 생성 실패:",w),{success:!1,error:w}}},updateSkill:async(f,p)=>{try{return{success:!0,data:await s.mutateAsync({id:f,data:p})}}catch(w){return console.error("스킬 수정 실패:",w),{success:!1,error:w}}},deleteSkill:async f=>{try{return await u.mutateAsync(f),{success:!0}}catch(p){return console.error("스킬 삭제 실패:",p),{success:!1,error:p}}}}},Jo=({initialData:t,onSave:r,onCancel:a,isSaving:s=!1})=>{const[n,l]=d.useState("ko"),[o,i]=d.useState({title:"",titleEn:"",titleJa:"",description:"",descriptionEn:"",descriptionJa:"",color:"#3B82F6",order:0});d.useEffect(()=>{t&&i({title:t.title,titleEn:t.titleEn||"",titleJa:t.titleJa||"",description:t.description||"",descriptionEn:t.descriptionEn||"",descriptionJa:t.descriptionJa||"",color:t.color,order:t.order})},[t]);const u=c=>{c.preventDefault(),console.log("📋 폼 제출:",o),r(o)},x=(c,h)=>{i(g=>({...g,[c]:h}))};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:t?"카테고리 수정":"새 카테고리 추가"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsx(Je,{activeLanguage:n,onChange:l}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["제목 ",n==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("input",{type:"text",value:o.title,onChange:c=>x("title",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"예: 프로그래밍 언어",required:!0}),n==="en"&&e.jsx("input",{type:"text",value:o.titleEn||"",onChange:c=>x("titleEn",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Programming Languages"}),n==="ja"&&e.jsx("input",{type:"text",value:o.titleJa||"",onChange:c=>x("titleJa",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"例: プログラミング言語"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["설명",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("textarea",{value:o.description,onChange:c=>x("description",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"카테고리에 대한 설명을 입력하세요"}),n==="en"&&e.jsx("textarea",{value:o.descriptionEn||"",onChange:c=>x("descriptionEn",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Enter description for this category"}),n==="ja"&&e.jsx("textarea",{value:o.descriptionJa||"",onChange:c=>x("descriptionJa",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"このカテゴリの説明を入力してください"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"색상"}),e.jsx("input",{type:"color",value:o.color,onChange:c=>x("color",c.target.value),className:"w-12 h-10 border border-gray-300 dark:border-gray-600 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"순서 (고급 옵션)"}),e.jsx("input",{type:"number",value:o.order,onChange:c=>x("order",parseInt(c.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"💡 카테고리 목록에서 드래그하여 순서를 변경할 수 있습니다"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:s?"저장 중...":"저장"}),e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"취소"})]})]})]})},_o=({initialData:t,onSave:r,onCancel:a,isSaving:s=!1})=>{const[n,l]=d.useState("ko"),[o,i]=d.useState({name:"",nameEn:"",nameJa:"",level:50,icon:"FaMicrochip",description:"",descriptionEn:"",descriptionJa:"",order:0});d.useEffect(()=>{t&&i({name:t.name,nameEn:t.nameEn||"",nameJa:t.nameJa||"",level:t.level,icon:t.icon,description:t.description||"",descriptionEn:t.descriptionEn||"",descriptionJa:t.descriptionJa||"",order:t.order})},[t]);const u=c=>{c.preventDefault(),r(o)},x=(c,h)=>{i(g=>({...g,[c]:h}))};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:t?"스킬 수정":"새 스킬 추가"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsx(Je,{activeLanguage:n,onChange:l}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["이름 ",n==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("input",{type:"text",value:o.name,onChange:c=>x("name",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"예: Python, React, PLC",required:!0}),n==="en"&&e.jsx("input",{type:"text",value:o.nameEn||"",onChange:c=>x("nameEn",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Python, React, PLC"}),n==="ja"&&e.jsx("input",{type:"text",value:o.nameJa||"",onChange:c=>x("nameJa",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"例: Python, React, PLC"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["설명 (선택사항)",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("textarea",{value:o.description||"",onChange:c=>x("description",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"스킬에 대한 간단한 설명"}),n==="en"&&e.jsx("textarea",{value:o.descriptionEn||"",onChange:c=>x("descriptionEn",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Brief description of this skill"}),n==="ja"&&e.jsx("textarea",{value:o.descriptionJa||"",onChange:c=>x("descriptionJa",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"このスキルの簡単な説明"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"아이콘"}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"text-lg text-blue-600 dark:text-blue-400",children:e.jsx(ea,{iconName:o.icon,size:20})}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"미리보기"})]}),e.jsxs("select",{value:o.icon,onChange:c=>x("icon",c.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsxs("optgroup",{label:"프로그래밍 언어",children:[e.jsx("option",{value:"FaPython",children:"Python"}),e.jsx("option",{value:"SiJavascript",children:"JavaScript"}),e.jsx("option",{value:"SiTypescript",children:"TypeScript"}),e.jsx("option",{value:"SiC",children:"C"}),e.jsx("option",{value:"SiCplusplus",children:"C++"}),e.jsx("option",{value:"SiCsharp",children:"C#"}),e.jsx("option",{value:"SiGo",children:"Go"}),e.jsx("option",{value:"SiRust",children:"Rust"}),e.jsx("option",{value:"SiJava",children:"Java"}),e.jsx("option",{value:"SiPhp",children:"PHP"}),e.jsx("option",{value:"SiRuby",children:"Ruby"}),e.jsx("option",{value:"SiSwift",children:"Swift"}),e.jsx("option",{value:"SiKotlin",children:"Kotlin"})]}),e.jsxs("optgroup",{label:"프레임워크 & 라이브러리",children:[e.jsx("option",{value:"SiReact",children:"React"}),e.jsx("option",{value:"SiNodedotjs",children:"Node.js"}),e.jsx("option",{value:"SiVuedotjs",children:"Vue.js"}),e.jsx("option",{value:"SiAngular",children:"Angular"}),e.jsx("option",{value:"SiNextdotjs",children:"Next.js"}),e.jsx("option",{value:"SiExpress",children:"Express"}),e.jsx("option",{value:"SiDjango",children:"Django"}),e.jsx("option",{value:"SiFlask",children:"Flask"}),e.jsx("option",{value:"SiSpring",children:"Spring"})]}),e.jsxs("optgroup",{label:"데이터베이스",children:[e.jsx("option",{value:"FaDatabase",children:"Database"}),e.jsx("option",{value:"SiMysql",children:"MySQL"}),e.jsx("option",{value:"SiMongodb",children:"MongoDB"}),e.jsx("option",{value:"SiPostgresql",children:"PostgreSQL"}),e.jsx("option",{value:"SiRedis",children:"Redis"}),e.jsx("option",{value:"SiSqlite",children:"SQLite"})]}),e.jsxs("optgroup",{label:"자동화 & 하드웨어",children:[e.jsx("option",{value:"FaMicrochip",children:"Microchip"}),e.jsx("option",{value:"FaRobot",children:"Robot"}),e.jsx("option",{value:"SiArduino",children:"Arduino"}),e.jsx("option",{value:"SiRaspberrypi",children:"Raspberry Pi"}),e.jsx("option",{value:"SiSiemens",children:"Siemens"}),e.jsx("option",{value:"SiMitsubishi",children:"Mitsubishi"})]}),e.jsxs("optgroup",{label:"개발 도구",children:[e.jsx("option",{value:"FaCode",children:"Code"}),e.jsx("option",{value:"FaServer",children:"Server"}),e.jsx("option",{value:"SiDocker",children:"Docker"}),e.jsx("option",{value:"SiGit",children:"Git"}),e.jsx("option",{value:"SiLinux",children:"Linux"}),e.jsx("option",{value:"SiGithub",children:"GitHub"}),e.jsx("option",{value:"SiGitlab",children:"GitLab"}),e.jsx("option",{value:"SiVisualstudiocode",children:"VS Code"})]}),e.jsxs("optgroup",{label:"언어",children:[e.jsx("option",{value:"FaLanguage",children:"언어 일반"}),e.jsx("option",{value:"FaGlobeAsia",children:"일본어"}),e.jsx("option",{value:"FaGlobeEurope",children:"독일어"}),e.jsx("option",{value:"FaFlag",children:"러시아어"}),e.jsx("option",{value:"FaFlagCheckered",children:"한국어"}),e.jsx("option",{value:"FaGlobe",children:"에스토니아어"}),e.jsx("option",{value:"FaFont",children:"중국어"}),e.jsx("option",{value:"FaComment",children:"영어"})]}),e.jsxs("optgroup",{label:"학문 & 전공",children:[e.jsx("option",{value:"FaLaptopCode",children:"컴퓨터공학"}),e.jsx("option",{value:"FaChartBar",children:"통계학"}),e.jsx("option",{value:"FaCalculator",children:"수학"}),e.jsx("option",{value:"FaSquareRootAlt",children:"수학 (고급)"}),e.jsx("option",{value:"FaUniversity",children:"대학/학술"}),e.jsx("option",{value:"FaGraduationCap",children:"졸업/학위"})]}),e.jsxs("optgroup",{label:"공학",children:[e.jsx("option",{value:"FaCogs",children:"공학 일반"}),e.jsx("option",{value:"FaTools",children:"기계공학"}),e.jsx("option",{value:"FaWrench",children:"기계설계"}),e.jsx("option",{value:"FaBolt",children:"전기공학"}),e.jsx("option",{value:"FaPlug",children:"전력공학"}),e.jsx("option",{value:"FaMicrochip",children:"전자공학"}),e.jsx("option",{value:"FaHardHat",children:"토목공학"}),e.jsx("option",{value:"FaBuilding",children:"건축공학"}),e.jsx("option",{value:"FaIndustry",children:"산업공학"}),e.jsx("option",{value:"FaChartLine",children:"경영공학"}),e.jsx("option",{value:"FaFlask",children:"화학공학"}),e.jsx("option",{value:"FaCubes",children:"재료공학"}),e.jsx("option",{value:"FaPlane",children:"항공공학"}),e.jsx("option",{value:"FaRocket",children:"우주공학"}),e.jsx("option",{value:"FaLeaf",children:"환경공학"}),e.jsx("option",{value:"FaRecycle",children:"자원공학"}),e.jsx("option",{value:"FaDna",children:"생명공학"}),e.jsx("option",{value:"FaOilCan",children:"석유공학"}),e.jsx("option",{value:"FaFire",children:"에너지공학"}),e.jsx("option",{value:"FaShieldAlt",children:"안전공학"})]}),e.jsxs("optgroup",{label:"과학",children:[e.jsx("option",{value:"FaAtom",children:"원자/물리학"}),e.jsx("option",{value:"FaFlask",children:"화학/실험"}),e.jsx("option",{value:"FaMicroscope",children:"생물학/연구"}),e.jsx("option",{value:"FaDna",children:"DNA/유전학"}),e.jsx("option",{value:"FaRocket",children:"우주/항공"}),e.jsx("option",{value:"FaSatellite",children:"위성/통신"}),e.jsx("option",{value:"FaBrain",children:"뇌과학/심리학"}),e.jsx("option",{value:"FaLightbulb",children:"발명/혁신"}),e.jsx("option",{value:"FaWaveSquare",children:"전자/전기공학"}),e.jsx("option",{value:"FaMagnet",children:"자기학/물리"})]}),e.jsxs("optgroup",{label:"예술 & 취미",children:[e.jsx("option",{value:"FaPalette",children:"미술"}),e.jsx("option",{value:"FaPaintBrush",children:"그림"}),e.jsx("option",{value:"FaCamera",children:"사진"}),e.jsx("option",{value:"FaCameraRetro",children:"사진 (레트로)"}),e.jsx("option",{value:"FaCoffee",children:"커피"}),e.jsx("option",{value:"FaMugHot",children:"커피 (머그)"}),e.jsx("option",{value:"FaMusic",children:"음악"}),e.jsx("option",{value:"FaGuitar",children:"악기"}),e.jsx("option",{value:"FaFilm",children:"영화/영상"})]}),e.jsxs("optgroup",{label:"경력 & 경험",children:[e.jsx("option",{value:"FaUserShield",children:"군인"}),e.jsx("option",{value:"FaShieldAlt",children:"방어/보안"}),e.jsx("option",{value:"FaCar",children:"운전"}),e.jsx("option",{value:"FaTruck",children:"트럭 운전"}),e.jsx("option",{value:"FaShippingFast",children:"물류"}),e.jsx("option",{value:"FaBriefcase",children:"비즈니스"}),e.jsx("option",{value:"FaHandshake",children:"협업"})]}),e.jsxs("optgroup",{label:"기타",children:[e.jsx("option",{value:"FaChartLine",children:"Chart"}),e.jsx("option",{value:"FaCubes",children:"Cubes"}),e.jsx("option",{value:"FaCog",children:"Settings"}),e.jsx("option",{value:"FaMobile",children:"Mobile"}),e.jsx("option",{value:"FaDesktop",children:"Desktop"}),e.jsx("option",{value:"FaCloud",children:"Cloud"}),e.jsx("option",{value:"FaNetworkWired",children:"Network"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"순서 (고급 옵션)"}),e.jsx("input",{type:"number",value:o.order,onChange:c=>x("order",parseInt(c.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"💡 스킬 목록에서 드래그하여 순서를 변경할 수 있습니다"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:s?"저장 중...":"저장"}),e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"취소"})]})]})]})},$o=({category:t,isExpanded:r,onToggle:a,onAddSkill:s,onEdit:n,onDelete:l,isSaving:o,isDeleting:i,children:u})=>{var p;const{attributes:x,listeners:c,setNodeRef:h,transform:g,transition:N,isDragging:m}=Ot({id:t._id}),f={transform:_e.Transform.toString(g),transition:N,opacity:m?.5:1};return e.jsxs("div",{ref:h,style:f,className:"bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden",children:[e.jsxs("div",{className:"p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",onClick:()=>a(t._id),children:[e.jsx("div",{...x,...c,className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-1",title:"드래그하여 순서 변경",onClick:w=>w.stopPropagation(),children:e.jsx(Ut,{})}),e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:t.color}}),e.jsx("h3",{className:"font-semibold text-lg cursor-pointer",children:t.title}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",((p=t.skills)==null?void 0:p.length)||0,"개 스킬)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:w=>{w.stopPropagation(),s(t._id)},className:"p-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",disabled:o||i,children:e.jsx(se,{size:12})}),e.jsx("button",{onClick:w=>{w.stopPropagation(),n(t)},className:"p-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",disabled:o||i,children:e.jsx(be,{size:12})}),e.jsx("button",{onClick:w=>{w.stopPropagation(),l(t)},className:"p-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",disabled:o||i,children:e.jsx(ie,{size:12})}),r?e.jsx($t,{className:"text-gray-400"}):e.jsx(cr,{className:"text-gray-400"})]})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 ml-7",children:t.description})]}),r&&u]})},Uo=({skill:t,categoryColor:r,currentLevel:a,hasChanges:s,isSavingThis:n,isSaving:l,isDeleting:o,onLevelChange:i,onSaveLevel:u,onEdit:x,onDelete:c,onToggleSidebar:h,onToggleLanguageCard:g})=>{const{attributes:N,listeners:m,setNodeRef:f,transform:p,transition:w,isDragging:j}=Ot({id:t._id}),E={transform:_e.Transform.toString(p),transition:w,opacity:j?.5:1};return e.jsxs("div",{ref:f,style:E,className:"flex items-center justify-between bg-white dark:bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{...N,...m,className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-1",title:"드래그하여 순서 변경",children:e.jsx(Ut,{})}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"flex items-center gap-1 text-xs cursor-pointer",title:"사이드바 핵심기술에 표시",children:[e.jsx("input",{type:"checkbox",checked:t.showInSidebar||!1,onChange:()=>h(t),disabled:l||o,className:"w-3 h-3 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"핵심"})]}),e.jsxs("label",{className:"flex items-center gap-1 text-xs cursor-pointer",title:"사이드바 언어카드에 표시",children:[e.jsx("input",{type:"checkbox",checked:t.showInLanguageCard||!1,onChange:()=>g(t),disabled:l||o,className:"w-3 h-3 text-green-600 rounded focus:ring-2 focus:ring-green-500"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"언어"})]})]}),e.jsx("div",{className:"text-lg text-blue-600 dark:text-blue-400",children:e.jsx(ea,{iconName:t.icon,size:18})}),e.jsx("span",{className:"font-medium min-w-[120px]",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-md",children:[e.jsx("input",{type:"range",min:"0",max:"100",step:"5",value:a,onChange:S=>{const v=parseInt(S.target.value);i(t._id,v)},className:"flex-1 h-2 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, ${r} 0%, ${r} ${a}%, #e5e7eb ${a}%, #e5e7eb 100%)`},disabled:l||o||n}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 min-w-[45px] text-right font-medium",children:[a,"%"]}),s&&e.jsx("button",{onClick:()=>u(t),disabled:n,className:`px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-xs font-medium transition-colors flex items-center gap-1 ${n?"opacity-50 cursor-not-allowed":""}`,title:"변경된 숙련도 저장",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"저장중"]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{size:10}),"저장"]})})]})]}),e.jsxs("div",{className:"flex gap-2 ml-2",children:[e.jsx("button",{onClick:()=>x(t),className:"p-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-colors",disabled:l||o,children:e.jsx(be,{size:12})}),e.jsx("button",{onClick:()=>c(t),className:"p-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",disabled:l||o,children:e.jsx(ie,{size:12})})]})]})},Bo=()=>{const{skillCategories:t,isLoading:r,createSkillCategory:a,updateSkillCategory:s,deleteSkillCategory:n,createSkill:l,updateSkill:o,deleteSkill:i}=Po(),[u,x]=d.useState(null),[c,h]=d.useState(null),[g,N]=d.useState(null),[m,f]=d.useState(null),[p,w]=d.useState(new Set),[j,E]=d.useState(!1),[S,v]=d.useState(!1),[T,y]=d.useState(new Map),[b,F]=d.useState(new Set),R=d.useCallback((D,U)=>{y(B=>{const O=new Map(B);return O.set(D,U),O})},[]),$=d.useCallback(async D=>{const U=D._id,B=T.get(U);if(B===void 0||B===D.level){y(O=>{const A=new Map(O);return A.delete(U),A});return}try{F(O=>new Set(O).add(U)),console.log(`💾 숙련도 저장: ${D.name} = ${B}%`),await o(U,{name:D.name,icon:D.icon,level:B,order:D.order,...D.description&&{description:D.description},...D.color&&{color:D.color},...D.showInSidebar!==void 0&&{showInSidebar:D.showInSidebar},...D.showInLanguageCard!==void 0&&{showInLanguageCard:D.showInLanguageCard}}),console.log(`✅ 저장 완료: ${D.name}`),y(O=>{const A=new Map(O);return A.delete(U),A})}catch(O){console.error(`❌ 저장 실패: ${D.name}`,O),alert(`저장 실패: ${D.name}`)}finally{F(O=>{const A=new Set(O);return A.delete(U),A})}},[T,o]),V=d.useCallback(async D=>{if(D._id)try{F(O=>new Set(O).add(D._id));const U=!D.showInSidebar;console.log(`💾 [핵심기술] 토글: ${D.name} = ${U}`),console.log("📋 [핵심기술] 전송 데이터:",{name:D.name,showInSidebar:U,showInLanguageCard:D.showInLanguageCard});const B=await o(D._id,{name:D.name,icon:D.icon,level:D.level,order:D.order,showInSidebar:U,...D.description&&{description:D.description},...D.color&&{color:D.color},...D.showInLanguageCard!==void 0&&{showInLanguageCard:D.showInLanguageCard}});console.log("✅ [핵심기술] 토글 완료:",B)}catch(U){console.error(`❌ [핵심기술] 토글 실패: ${D.name}`,U),alert(`사이드바 표시 토글 실패: ${D.name}`)}finally{F(U=>{const B=new Set(U);return B.delete(D._id),B})}},[o]),z=d.useCallback(async D=>{if(D._id)try{F(O=>new Set(O).add(D._id));const U=!D.showInLanguageCard;console.log(`💾 [언어카드] 토글: ${D.name} = ${U}`),console.log("📋 [언어카드] 전송 데이터:",{name:D.name,showInSidebar:D.showInSidebar,showInLanguageCard:U});const B=await o(D._id,{name:D.name,icon:D.icon,level:D.level,order:D.order,showInLanguageCard:U,...D.description&&{description:D.description},...D.color&&{color:D.color},...D.showInSidebar!==void 0&&{showInSidebar:D.showInSidebar}});console.log("✅ [언어카드] 토글 완료:",B)}catch(U){console.error(`❌ [언어카드] 토글 실패: ${D.name}`,U),alert(`언어 카드 표시 토글 실패: ${D.name}`)}finally{F(U=>{const B=new Set(U);return B.delete(D._id),B})}},[o]),W=d.useCallback(async D=>{const{active:U,over:B}=D;if(!B||U.id===B.id)return;const O=t.findIndex(q=>q._id===U.id),A=t.findIndex(q=>q._id===B.id);if(O===-1||A===-1)return;const H=ft(t,O,A);try{for(let q=0;q<H.length;q++){const Z=H[q];Z!=null&&Z._id&&await s(Z._id,{title:Z.title,color:Z.color,order:q,...Z.description&&{description:Z.description}})}console.log("✅ 카테고리 순서 변경 완료")}catch(q){console.error("❌ 카테고리 순서 변경 실패:",q),alert("순서 변경에 실패했습니다.")}},[t,s]),X=d.useCallback(async(D,U)=>{const{active:B,over:O}=D;if(!O||B.id===O.id)return;const A=t.find(Y=>Y._id===U);if(!A||!A.skills)return;const H=A.skills.findIndex(Y=>Y._id===B.id),q=A.skills.findIndex(Y=>Y._id===O.id);if(H===-1||q===-1)return;const Z=ft(A.skills,H,q);try{for(let Y=0;Y<Z.length;Y++){const ee=Z[Y];ee!=null&&ee._id&&await o(ee._id,{name:ee.name,icon:ee.icon,level:ee.level,order:Y,...ee.description&&{description:ee.description},...ee.color&&{color:ee.color}})}console.log(`✅ 스킬 순서 변경 완료 (카테고리: ${A.title})`)}catch(Y){console.error("❌ 스킬 순서 변경 실패:",Y),alert("순서 변경에 실패했습니다.")}},[t,o]),Q=D=>{w(U=>{const B=new Set(U);return B.has(D)?B.delete(D):B.add(D),B})},L=()=>{h(null),x("category")},k=D=>{h(D),x("category")},_=async D=>{try{if(E(!0),console.log("🔍 카테고리 저장 시작:",D),c){console.log("📝 카테고리 수정 모드:",c._id);const U=await s(c._id,D);console.log("✅ 수정 결과:",U),U.success?(x(null),h(null),alert("카테고리가 성공적으로 수정되었습니다.")):alert(`카테고리 수정 실패: ${U.error||"알 수 없는 오류"}`)}else{console.log("➕ 카테고리 생성 모드");const U=await a(D);console.log("✅ 생성 결과:",U),U.success?(x(null),alert("카테고리가 성공적으로 추가되었습니다.")):alert(`카테고리 추가 실패: ${U.error||"알 수 없는 오류"}`)}}catch(U){console.error("❌ 카테고리 저장 실패:",U),alert(`카테고리 저장 중 오류가 발생했습니다: ${U}`)}finally{E(!1)}},I=async D=>{if(confirm("정말 삭제하시겠습니까? 카테고리 내 모든 스킬도 함께 삭제됩니다."))try{v(!0),await n(D._id)}catch(U){console.error("카테고리 삭제 실패:",U)}finally{v(!1)}},P=D=>{f(D),N(null),x("skill")},C=D=>{N(D),f(D.categoryId),x("skill")},M=async D=>{if(!(!m&&!g))try{E(!0);const U=(g==null?void 0:g.categoryId)||m;g?(await o(g._id,D)).success&&(x(null),N(null),f(null)):(await l(U,D)).success&&(x(null),f(null))}catch(U){console.error("스킬 저장 실패:",U)}finally{E(!1)}},J=async D=>{if(confirm("정말 삭제하시겠습니까?"))try{v(!0),await i(D._id)}catch(U){console.error("스킬 삭제 실패:",U)}finally{v(!1)}},G=()=>{x(null),h(null),N(null),f(null)};return r?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2",children:"기술 데이터를 불러오는 중..."})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"기술 관리"}),e.jsxs("button",{onClick:L,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(se,{}),"카테고리 추가"]})]}),u==="category"&&e.jsx(Jo,{initialData:c,onSave:_,onCancel:G,isSaving:j}),u==="skill"&&e.jsx(_o,{initialData:g,categoryId:m||void 0,onSave:M,onCancel:G,isSaving:j}),e.jsx(Pt,{collisionDetection:Rt,onDragEnd:W,children:e.jsx(_t,{items:t.map(D=>D._id),strategy:Jt,children:e.jsx("div",{className:"space-y-4",children:t.map(D=>{const U=p.has(D._id);return e.jsx($o,{category:D,isExpanded:U,onToggle:Q,onAddSkill:P,onEdit:k,onDelete:I,isSaving:j,isDeleting:S,children:e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-800",children:D.skills&&D.skills.length>0?e.jsx(Pt,{collisionDetection:Rt,onDragEnd:B=>X(B,D._id),children:e.jsx(_t,{items:D.skills.map(B=>B._id),strategy:Jt,children:e.jsx("div",{className:"p-4 space-y-2",children:D.skills.sort((B,O)=>B.order-O.order).map(B=>{const O=T.get(B._id)??B.level,A=T.has(B._id)&&T.get(B._id)!==B.level,H=b.has(B._id);return e.jsx(Uo,{skill:B,categoryColor:D.color||"#3B82F6",currentLevel:O,hasChanges:A,isSavingThis:H,isSaving:j,isDeleting:S,onLevelChange:R,onSaveLevel:$,onEdit:C,onDelete:J,onToggleSidebar:V,onToggleLanguageCard:z},B._id)})})})}):e.jsxs("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(se,{size:32,className:"text-blue-400 dark:text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"아직 스킬이 없습니다."}),e.jsx("p",{className:"text-xs mt-1",children:"카테고리 제목 옆의 + 버튼을 클릭하여 스킬을 추가하세요."})]})})},D._id)})})})}),t.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx("p",{className:"text-lg mb-2",children:"아직 생성된 카테고리가 없습니다."}),e.jsx("p",{children:'위의 "카테고리 추가" 버튼을 클릭하여 첫 번째 카테고리를 만들어보세요.'})]})]})},Xr=({data:t,onSave:r,onCancel:a,isSaving:s=!1})=>{const[n,l]=d.useState("ko"),[o,i]=d.useState(t?{name:t.name,nameEn:t.nameEn,nameJa:t.nameJa,order:t.order||0}:{name:"",nameEn:"",nameJa:"",order:0}),u=x=>{if(x.preventDefault(),!o.name.trim()){alert("카테고리 이름을 입력해주세요");return}r(o)};return e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsx(Je,{activeLanguage:n,onChange:l}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["카테고리 이름 ",n==="ko"&&e.jsx("span",{className:"text-red-500",children:"*"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",n==="ko"?"🇰🇷 한국어":n==="en"?"🇺🇸 English":"🇯🇵 日本語",")"]})]}),n==="ko"&&e.jsx("input",{type:"text",value:o.name,onChange:x=>i({...o,name:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"예: PLC, 웹개발, AI/ML",required:!0}),n==="en"&&e.jsx("input",{type:"text",value:o.nameEn||"",onChange:x=>i({...o,nameEn:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., PLC, Web Development, AI/ML"}),n==="ja"&&e.jsx("input",{type:"text",value:o.nameJa||"",onChange:x=>i({...o,nameJa:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"例: PLC, ウェブ開発, AI/ML"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"순서 (고급 옵션)"}),e.jsx("input",{type:"number",value:o.order,onChange:x=>i({...o,order:parseInt(x.target.value)||0}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"💡 카테고리 목록에서 드래그 앤 드롭으로 순서를 변경할 수 있습니다"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{type:"submit",disabled:s||!o.name.trim(),className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:[e.jsx(xe,{}),s?"저장 중...":"저장"]}),e.jsx("button",{type:"button",onClick:a,disabled:s,className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:"취소"})]})]})},zo=({category:t,onEdit:r,onDelete:a,isDeleting:s})=>{const{attributes:n,listeners:l,setNodeRef:o,transform:i,transition:u,isDragging:x}=Ot({id:t._id}),c={transform:_e.Transform.toString(i),transition:u,opacity:x?.5:1},{data:h}=ms(t._id);return e.jsx("div",{ref:o,style:c,className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("button",{...n,...l,className:"mt-1 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing",title:"드래그하여 순서 변경",children:e.jsx(Ut,{})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:t.name}),h&&e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[h.usage.books>0&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded",children:["📚 서적 ",h.usage.books,"개"]}),h.usage.projects>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded",children:["🚀 프로젝트 ",h.usage.projects,"개"]}),h.usage.videoLearnings>0&&e.jsxs("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded",children:["📹 영상 ",h.usage.videoLearnings,"개"]}),h.usage.videoPlaylists>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded",children:["📺 재생 목록 ",h.usage.videoPlaylists,"개"]}),h.usage.total===0&&e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"사용 중이지 않음"})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:r,className:"p-2 text-yellow-600 hover:bg-yellow-100 dark:hover:bg-yellow-900 rounded-lg transition-colors",title:"수정",children:e.jsx(be,{})}),e.jsx("button",{onClick:a,disabled:s,className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-lg transition-colors disabled:opacity-50",title:"삭제",children:e.jsx(ie,{})})]})]})})},Vo=()=>{const{success:t,error:r}=ze(),{categories:a,isLoading:s,createCategory:n,updateCategory:l,deleteCategory:o}=ps(),[i,u]=zt({onSave:async(c,h)=>{if(h){const g=await l(h._id,c);if(g.success)t("카테고리 수정 완료","카테고리가 성공적으로 수정되었습니다.");else throw g.error}else{const g=await n(c);if(g.success)t("카테고리 추가 완료","새로운 카테고리가 추가되었습니다.");else throw g.error}},onDelete:async c=>{var g,N,m,f,p,w;const h=await o(c._id);if(h.success)t("카테고리 삭제 완료",`${c.name}이(가) 삭제되었습니다.`);else{const j=((m=(N=(g=h.error)==null?void 0:g.response)==null?void 0:N.data)==null?void 0:m.message)||"카테고리 삭제에 실패했습니다",E=(w=(p=(f=h.error)==null?void 0:f.response)==null?void 0:p.data)==null?void 0:w.usage;if(E){const S=[];E.books>0&&S.push(`서적 ${E.books}개`),E.projects>0&&S.push(`프로젝트 ${E.projects}개`),E.videoLearnings>0&&S.push(`영상 ${E.videoLearnings}개`),E.videoPlaylists>0&&S.push(`재생 목록 ${E.videoPlaylists}개`),r("삭제 불가",`이 카테고리는 ${S.join(", ")}에서 사용 중입니다. 먼저 해당 항목들의 카테고리를 변경해주세요.`)}else r("삭제 실패",j);throw h.error}},onError:c=>{r("작업 실패",c.message||"알 수 없는 오류가 발생했습니다.")}}),x=async c=>{const{active:h,over:g}=c;if(!g||h.id===g.id)return;const N=a.findIndex(p=>p._id===h.id),m=a.findIndex(p=>p._id===g.id),f=ft(a,N,m);for(let p=0;p<f.length;p++){const w=f[p];w&&w.order!==p&&await l(w._id,{name:w.name,order:p})}};return s?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Ar,{className:"text-yellow-600"}),"카테고리 관리"]}),e.jsxs("button",{onClick:u.handleCreate,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[e.jsx(se,{}),"카테고리 추가"]})]}),i.showForm&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:i.editingItem?"카테고리 수정":"카테고리 추가"}),i.editingItem?e.jsx(Xr,{data:i.editingItem,onSave:u.handleSave,onCancel:u.handleCancel,isSaving:i.isSaving}):e.jsx(Xr,{onSave:u.handleSave,onCancel:u.handleCancel,isSaving:i.isSaving})]})})}),e.jsx(Pt,{collisionDetection:Rt,onDragEnd:x,children:e.jsx(_t,{items:a.map(c=>c._id),strategy:Jt,children:e.jsx("div",{className:"grid gap-4",children:a.map(c=>e.jsx(zo,{category:c,onEdit:()=>u.handleEdit(c),onDelete:()=>u.handleDelete(c),isDeleting:i.isDeleting},c._id))})})}),a.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(Ar,{className:"text-6xl mx-auto mb-4 opacity-30"}),e.jsx("p",{children:"아직 등록된 카테고리가 없습니다"}),e.jsx("p",{className:"text-sm mt-2",children:'위의 "카테고리 추가" 버튼을 클릭하여 첫 카테고리를 만들어보세요'})]})]})},qo=({notifications:t,showNotifications:r,onToggle:a,onNotificationClick:s})=>{const n=()=>t.filter(l=>!l.read).length;return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:a,className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors relative",children:[e.jsx(Ya,{}),"알림",n()>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:n()})]}),r&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"알림"}),t.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"새로운 알림이 없습니다."}):e.jsxs("div",{className:"space-y-2",children:[t.slice(0,5).map(l=>e.jsxs("div",{onClick:()=>s==null?void 0:s(l.id),className:`p-3 rounded-lg border cursor-pointer transition-all hover:shadow-md ${l.read?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-900/30"}`,children:[e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:l.message}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(l.createdAt).toLocaleString("ko-KR")})]},l.id)),t.length>5&&e.jsxs("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 pt-2 border-t border-gray-200 dark:border-gray-700",children:["+",t.length-5,"개 더 보기"]})]})]})})]})},Ho=({filterGroup:t,count:r})=>{const{state:a,actions:s,data:n}=t,[l,o]=d.useState(!1),i=()=>{s.setFilter("all"),s.setSearchTerm(""),s.setSelectedCategory(""),o(!1)};return e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"서적 관리"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>{s.setFilter("all"),s.setSearchTerm(""),o(!1),s.setSelectedCategory("")},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="all"&&!a.searchTerm&&!a.selectedCategory?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:["📖 모든 서적 (",r,")"]}),e.jsx("button",{onClick:()=>{s.setFilter("five-star"),s.setSearchTerm(""),o(!1),s.setSelectedCategory("")},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="five-star"?"bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"⭐ 평점 5점 서적"}),e.jsx("button",{onClick:()=>{s.setFilter("category"),s.setSearchTerm(""),o(!1)},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="category"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"📚 카테고리별 보기"}),a.filter==="category"&&e.jsx("div",{className:"ml-4 mb-2",children:e.jsxs("select",{value:a.selectedCategory,onChange:u=>s.setSelectedCategory(u.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"카테고리 선택"}),n.categories.map(u=>e.jsx("option",{value:u,children:u},u))]})}),e.jsx("button",{onClick:()=>o(!l),className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${l?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"🔍 서적 검색"}),l&&e.jsx("div",{className:"ml-4 mb-2",children:e.jsx("input",{type:"text",placeholder:"제목, 저자, 카테고리 검색...",value:a.searchTerm,onChange:u=>s.setSearchTerm(u.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})}),(a.filter!=="all"||a.searchTerm||a.selectedCategory)&&e.jsx("button",{onClick:i,className:"w-full text-left px-3 py-2 text-sm rounded-lg transition-colors text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:"🔄 필터 초기화"})]})]})},Oo=({filterGroup:t,count:r})=>{const{state:a,actions:s,data:n}=t,[l,o]=d.useState(!1),i=()=>{s.setFilter("all"),s.setSearchTerm(""),s.setSelectedCompany(""),s.setSelectedYear(""),o(!1)};return e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"경력 관리"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>{s.setFilter("all"),s.setSearchTerm(""),o(!1),s.setSelectedCompany(""),s.setSelectedYear("")},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="all"&&!a.searchTerm&&!a.selectedCompany&&!a.selectedYear?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:["💼 모든 경력 (",r,")"]}),e.jsx("button",{onClick:()=>{s.setFilter("company"),s.setSearchTerm(""),o(!1),s.setSelectedYear("")},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="company"?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"🏢 회사별 보기"}),a.filter==="company"&&e.jsx("div",{className:"ml-4 mb-2",children:e.jsxs("select",{value:a.selectedCompany,onChange:u=>s.setSelectedCompany(u.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"회사 선택"}),n.companies.map(u=>e.jsx("option",{value:u,children:u},u))]})}),e.jsx("button",{onClick:()=>{s.setFilter("year"),s.setSearchTerm(""),o(!1),s.setSelectedCompany("")},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="year"?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"📅 연도별 보기"}),a.filter==="year"&&e.jsx("div",{className:"ml-4 mb-2",children:e.jsxs("select",{value:a.selectedYear,onChange:u=>s.setSelectedYear(u.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"연도 선택"}),n.years.map(u=>e.jsxs("option",{value:u,children:[u,"년"]},u))]})}),e.jsx("button",{onClick:()=>o(!l),className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${l?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"🔍 경력 검색"}),l&&e.jsx("div",{className:"ml-4 mb-2",children:e.jsx("input",{type:"text",placeholder:"제목, 회사, 설명 검색...",value:a.searchTerm,onChange:u=>s.setSearchTerm(u.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})}),(a.filter!=="all"||a.searchTerm||a.selectedCompany||a.selectedYear)&&e.jsx("button",{onClick:i,className:"w-full text-left px-3 py-2 text-sm rounded-lg transition-colors text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:"🔄 필터 초기화"})]})]})},Wo=({filterGroup:t,count:r})=>{const{state:a,actions:s,data:n}=t,[l,o]=d.useState(!1),i=()=>{s.setFilter("all"),s.setSearchTerm(""),s.setSelectedCategory(""),o(!1)};return e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"프로젝트 관리"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>{s.setFilter("all"),s.setSearchTerm(""),o(!1),s.setSelectedCategory("")},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="all"&&!a.searchTerm&&!a.selectedCategory?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:["📁 모든 프로젝트 (",r,")"]}),e.jsx("button",{onClick:()=>{s.setFilter("category"),s.setSearchTerm(""),o(!1)},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="category"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"🏷️ 카테고리별 보기"}),a.filter==="category"&&e.jsx("div",{className:"ml-4 mb-2",children:e.jsxs("select",{value:a.selectedCategory,onChange:u=>s.setSelectedCategory(u.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"카테고리 선택"}),n.categories.map(u=>e.jsx("option",{value:u,children:u},u))]})}),e.jsx("button",{onClick:()=>{s.setFilter("featured"),s.setSearchTerm(""),o(!1),s.setSelectedCategory("")},className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${a.filter==="featured"?"bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"🌟 주요 프로젝트"}),e.jsx("button",{onClick:()=>o(!l),className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${l?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"🔍 프로젝트 검색"}),l&&e.jsx("div",{className:"ml-4 mb-2",children:e.jsx("input",{type:"text",placeholder:"제목, 설명, 기술스택 검색...",value:a.searchTerm,onChange:u=>s.setSearchTerm(u.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})}),(a.filter!=="all"||a.searchTerm||a.selectedCategory)&&e.jsx("button",{onClick:i,className:"w-full text-left px-3 py-2 text-sm rounded-lg transition-colors text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:"🔄 필터 초기화"})]})]})},Ko=({activeSettingsSection:t,setActiveSettingsSection:r})=>{const a=[{id:"general",label:"🏠 일반 설정",description:"사이트 기본 정보"},{id:"appearance",label:"🎨 외관 설정",description:"테마 및 디자인"},{id:"seo",label:"🔍 SEO 설정",description:"검색 엔진 최적화"},{id:"social",label:"📱 소셜 미디어",description:"소셜 링크 및 연락처"},{id:"analytics",label:"📊 분석 도구",description:"Google Analytics 등"},{id:"security",label:"🔒 보안 설정",description:"인증 및 보안"}];return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"사이트 설정"}),e.jsx("div",{className:"space-y-1",children:a.map(s=>e.jsx("button",{onClick:()=>r(s.id),className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${t===s.id?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.label}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:s.description})]})},s.id))}),t&&e.jsx("button",{onClick:()=>r(null),className:"w-full text-left px-3 py-2 text-sm rounded-lg transition-colors text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700",children:"← 설정 메뉴로 돌아가기"})]})},Go=({activeTab:t,setActiveTab:r,activeSettingsSection:a,setActiveSettingsSection:s,counts:n,refreshCounts:l,bookFilters:o,experienceFilters:i,projectFilters:u})=>e.jsx("div",{className:"w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"sticky top-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"빠른 메뉴"}),e.jsx("div",{className:"mb-8",children:e.jsxs("button",{onClick:()=>{r("settings"),s(null)},className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-semibold rounded-lg transition-colors ${t==="settings"&&a===null?"bg-blue-600 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{className:"text-lg",children:"🏠"}),"관리자 대시보드"]})}),e.jsxs("div",{className:"space-y-2 mb-8",children:[e.jsxs("button",{onClick:()=>r("books"),className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="books"?"bg-orange-100 dark:bg-orange-900 text-orange-700 dark:text-orange-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"📚 서적 관리"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.books})]}),e.jsxs("button",{onClick:()=>{s(null),r("videoLearnings")},className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="videoLearnings"?"bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"📹 개별 영상"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.videoLearnings||0})]}),e.jsxs("button",{onClick:()=>{s(null),r("videoPlaylists")},className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="videoPlaylists"?"bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"📺 시리즈 영상"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.videoPlaylists||0})]}),e.jsxs("button",{onClick:()=>r("experiences"),className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="experiences"?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"💼 경력 관리"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.experiences})]}),e.jsxs("button",{onClick:()=>r("projects"),className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="projects"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"🚀 프로젝트 관리"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.projects})]}),e.jsxs("button",{onClick:()=>r("messages"),className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="messages"?"bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"💬 메시지 관리"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.messages})]}),e.jsxs("button",{onClick:()=>r("skills"),className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="skills"?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"⚡ 기술 관리"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.skills})]}),e.jsxs("button",{onClick:()=>{s(null),r("categories")},className:`w-full flex items-center justify-between px-4 py-2 text-sm rounded-lg transition-colors ${t==="categories"?"bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:"📂 카테고리 관리"}),e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 px-2 py-1 rounded-full",children:n.categories||0})]})]}),t==="books"&&e.jsx(Ho,{filterGroup:o,count:n.books}),t==="experiences"&&e.jsx(Oo,{filterGroup:i,count:n.experiences}),t==="projects"&&e.jsx(Wo,{filterGroup:u,count:n.projects}),t==="settings"&&e.jsx(Ko,{activeSettingsSection:a,setActiveSettingsSection:s}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:l,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsx("span",{children:"🔄"}),"데이터 새로고침"]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:["마지막 업데이트: ",new Date().toLocaleTimeString("ko-KR")]})]})})]})}),Yr={fullName:"",firstName:"",role:"",subtitle:"",location:"",education:"",yearsOfExperience:"",email:"",phone:"",githubUrl:"",linkedinUrl:"",heroTitle:"",heroSubtitle:"",aboutTitle:"",aboutSubtitle:"",aboutDescription1:"",aboutDescription2:"",skillsTitle:"",skillsSubtitle:"",projectsTitle:"",projectsSubtitle:"",booksTitle:"",booksSubtitle:"",contactTitle:"",contactSubtitle:"",careerInterests:[],careerInterestsEn:[],careerInterestsJa:[],stat1Number:"",stat1Label:"",stat2Number:"",stat2Label:"",experienceTitle:"",experienceSubtitle:"",learningGoalsTitle:"앞으로의 학습 목표",learningGoalsDescription:"4차 산업혁명 시대에 발맞춰 **지능형 공장(Smart Factory) 구현**을 위해 다음 기술들을 집중적으로 탐구하여 전문성을 확대해 나가겠습니다.",learningGoalsList:["첨단 로봇 제어","딥러닝 기반 비전 시스템","엣지 컴퓨팅","클라우드 연동","MES/ERP 연동 기술"],siteTitle:"",siteDescription:"",siteKeywords:"",siteAuthor:"",siteLanguage:"ko",siteUrl:"",ogTitle:"",ogDescription:"",ogImage:"",ogType:"website",twitterCard:"summary_large_image",twitterSite:"",twitterCreator:"",robotsIndex:!0,robotsFollow:!0,googleAnalyticsId:"",googleSiteVerification:"",instagramUrl:"",twitterUrl:"",facebookUrl:"",youtubeUrl:"",tiktokUrl:"",behanceUrl:"",dribbbleUrl:"",mediumUrl:"",telegramUrl:"",discordUrl:"",kakaoTalkUrl:"",naverBlogUrl:"",tistoryUrl:"",velogUrl:"",notionUrl:"",googleTagManagerId:"",facebookPixelId:"",naverAnalyticsId:"",kakaoPixelId:"",hotjarId:"",mixpanelToken:"",amplitudeApiKey:"",sentryDsn:"",logRocketId:"",fullStoryOrgId:"",intercomAppId:"",zendeskWidgetKey:"",crispWebsiteId:"",tawkToPropertyId:"",liveChatLicense:"",olarkSiteId:"",enableHttps:!0,enableCsp:!0,cspDirectives:"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https:;",enableHsts:!0,hstsMaxAge:"31536000",enableXssProtection:!0,enableContentTypeOptions:!0,enableFrameOptions:!0,frameOptionsValue:"DENY",enableReferrerPolicy:!0,referrerPolicyValue:"strict-origin-when-cross-origin",enablePermissionsPolicy:!0,permissionsPolicyValue:"camera=(), microphone=(), geolocation=(), payment=()",enableApiRateLimit:!0,apiRateLimitPerMinute:"60",enableAdminAuth:!0,adminSessionTimeout:"3600",enableTwoFactorAuth:!1,enableIpWhitelist:!1,allowedIpAddresses:"",enableAuditLog:!0,enableBackup:!0,backupFrequency:"daily"},Me=[{title:"🧑 개인 정보",fields:[{key:"fullName",label:"전체 이름",type:"text",placeholder:"최주영",isMultilingual:!0},{key:"firstName",label:"이름",type:"text",placeholder:"주영",isMultilingual:!0},{key:"role",label:"역할/직책",type:"text",placeholder:"공장자동화 전문가",isMultilingual:!0},{key:"subtitle",label:"부제목",type:"text",placeholder:"바리스타 → 자동화 엔지니어",isMultilingual:!0},{key:"location",label:"위치",type:"text",placeholder:"부산",isMultilingual:!0},{key:"education",label:"교육",type:"text",placeholder:"부산인력개발원",isMultilingual:!0},{key:"yearsOfExperience",label:"경력 기간",type:"text",placeholder:"5년",isMultilingual:!0},{key:"email",label:"이메일",type:"email",placeholder:"your@email.com"},{key:"phone",label:"전화번호",type:"tel",placeholder:"+82 10-1234-5678"}]},{title:"🔗 소셜 링크",fields:[{key:"githubUrl",label:"GitHub URL",type:"url",placeholder:"https://github.com/username"},{key:"linkedinUrl",label:"LinkedIn URL",type:"url",placeholder:"https://linkedin.com/in/username"}]},{title:"⚙️ 사이드바 설정",fields:[{key:"sidebarSkillCount",label:"사이드바 핵심기술 표시 개수",type:"number",min:3,max:6,placeholder:"4"},{key:"languageCardSkillCount",label:"사이드바 언어카드 표시 개수",type:"number",min:2,max:5,placeholder:"3"}]},{title:"🏠 Hero 섹션 (메인 페이지)",fields:[{key:"heroTitle",label:"Hero 제목",type:"text",placeholder:"공장자동화 전문가",isMultilingual:!0},{key:"heroSubtitle",label:"Hero 부제목",type:"textarea",rows:6,placeholder:"여러분의 소개를 작성하세요...",isMultilingual:!0},{key:"heroTag",label:"Hero 태그",type:"text",placeholder:"🎯 취업 준비 중",isMultilingual:!0}]},{title:"👤 About 섹션",fields:[{key:"aboutTitle",label:"About 제목",type:"text",placeholder:"저의 여정",isMultilingual:!0},{key:"aboutSubtitle",label:"About 부제목",type:"text",placeholder:"커피 한 잔에서 시작된...",isMultilingual:!0},{key:"aboutDescription1",label:"About 설명 1",type:"textarea",rows:6,placeholder:"첫 번째 문단...",isMultilingual:!0},{key:"aboutDescription2",label:"About 설명 2",type:"textarea",rows:6,placeholder:"두 번째 문단...",isMultilingual:!0},{key:"aboutCardTitle",label:"소개 카드 제목",type:"text",placeholder:"바리스타에서 자동화 전문가로",isMultilingual:!0},{key:"aboutJourneyTitle",label:"성장 여정 제목",type:"text",placeholder:"성장 여정",isMultilingual:!0}]},{title:"💼 Experience 섹션",fields:[{key:"experienceTitle",label:"Experience 제목",type:"text",placeholder:"경력 & 학습",isMultilingual:!0},{key:"experienceSubtitle",label:"Experience 부제목",type:"text",placeholder:"바리스타에서 자동화 전문가로...",isMultilingual:!0}]},{title:"🛠️ Skills 섹션",fields:[{key:"skillsTitle",label:"Skills 제목",type:"text",placeholder:"기술 스택",isMultilingual:!0},{key:"skillsSubtitle",label:"Skills 부제목",type:"text",placeholder:"공장자동화와 데이터 분석을...",isMultilingual:!0}]},{title:"🎯 학습 목표 (Skills 페이지)",fields:[{key:"learningGoalsTitle",label:"학습 목표 제목",type:"text",placeholder:"앞으로의 학습 목표",isMultilingual:!0},{key:"learningGoalsDescription",label:"학습 목표 설명",type:"textarea",placeholder:"4차 산업혁명 시대에...",isMultilingual:!0},{key:"learningGoalsList",label:"학습 목표 기술 목록",type:"array",placeholder:"기술 이름 입력 (Enter로 추가)"}]},{title:"📁 Projects 섹션",fields:[{key:"projectsTitle",label:"Projects 제목",type:"text",placeholder:"프로젝트",isMultilingual:!0},{key:"projectsSubtitle",label:"Projects 부제목",type:"text",placeholder:"다양한 분야의 프로젝트...",isMultilingual:!0},{key:"projectsUpdateTitle",label:"업데이트 카드 제목",type:"text",placeholder:"프로젝트 업데이트 예정",isMultilingual:!0},{key:"projectsUpdateDescription",label:"업데이트 카드 설명",type:"textarea",placeholder:"현재 학습 중인 기술들을 활용한 실제 프로젝트들을 곧 업로드할 예정입니다.",isMultilingual:!0},{key:"projectsUpdateTechList",label:"업데이트 예정 기술 목록",type:"array",placeholder:"기술 이름 입력 (Enter로 추가)"}]},{title:"📚 Books 섹션",fields:[{key:"booksTitle",label:"Books 제목",type:"text",placeholder:"기술 서적 & 학습 노트",isMultilingual:!0},{key:"booksSubtitle",label:"Books 부제목",type:"text",placeholder:"읽은 기술 서적과...",isMultilingual:!0}]},{title:"📞 Contact 섹션",fields:[{key:"contactTitle",label:"Contact 제목",type:"text",placeholder:"연락처",isMultilingual:!0},{key:"contactSubtitle",label:"Contact 부제목",type:"text",placeholder:"프로젝트나 협업에...",isMultilingual:!0},{key:"careerInterests",label:"취업 관심 분야 (쉼표로 구분)",type:"array",placeholder:"공장자동화 엔지니어, PLC 프로그래머, 데이터 분석가, IoT 시스템 개발자",isMultilingual:!0}]},{title:"📊 통계 섹션",fields:[{key:"stat1Number",label:"통계 1 숫자",type:"text",placeholder:"5+"},{key:"stat1Label",label:"통계 1 라벨",type:"text",placeholder:"년 경력",isMultilingual:!0},{key:"stat2Number",label:"통계 2 숫자",type:"text",placeholder:"10+"},{key:"stat2Label",label:"통계 2 라벨",type:"text",placeholder:"기술 스택",isMultilingual:!0},{key:"stat3Number",label:"통계 3 숫자",type:"text",placeholder:"3+"},{key:"stat3Label",label:"통계 3 라벨",type:"text",placeholder:"완료 프로젝트",isMultilingual:!0}]},{title:"🔍 기본 SEO 설정",fields:[{key:"siteTitle",label:"사이트 제목",type:"text",placeholder:"포트폴리오 - 홍길동"},{key:"siteDescription",label:"사이트 설명",type:"textarea",rows:3,placeholder:"공장자동화 전문가 홍길동의 포트폴리오입니다. PLC 프로그래밍, 데이터 분석, 자동화 시스템 개발 경험을 소개합니다."},{key:"siteKeywords",label:"키워드 (쉼표로 구분)",type:"text",placeholder:"공장자동화, PLC, 데이터분석, 자동화시스템"},{key:"siteAuthor",label:"작성자",type:"text",placeholder:"홍길동"},{key:"siteLanguage",label:"사이트 언어",type:"select",placeholder:"언어 선택",options:[{value:"ko",label:"한국어 (ko)"},{value:"en",label:"English (en)"},{value:"ja",label:"日本語 (ja)"},{value:"zh",label:"中文 (zh)"}]},{key:"siteUrl",label:"사이트 URL",type:"url",placeholder:"https://yourportfolio.com"}]},{title:"📱 Open Graph (Facebook, LinkedIn)",fields:[{key:"ogTitle",label:"OG 제목",type:"text",placeholder:"포트폴리오 - 홍길동"},{key:"ogDescription",label:"OG 설명",type:"textarea",rows:3,placeholder:"공장자동화 전문가 홍길동의 포트폴리오를 확인해보세요."},{key:"ogImage",label:"OG 이미지 URL",type:"url",placeholder:"https://yourportfolio.com/og-image.jpg"},{key:"ogType",label:"OG 타입",type:"select",placeholder:"타입 선택",options:[{value:"website",label:"웹사이트 (website)"},{value:"profile",label:"프로필 (profile)"},{value:"article",label:"기사 (article)"}]}]},{title:"🐦 Twitter Card",fields:[{key:"twitterCard",label:"Twitter Card 타입",type:"select",placeholder:"카드 타입 선택",options:[{value:"summary",label:"요약 (summary)"},{value:"summary_large_image",label:"큰 이미지 요약 (summary_large_image)"},{value:"app",label:"앱 (app)"},{value:"player",label:"플레이어 (player)"}]},{key:"twitterSite",label:"Twitter 사이트 계정",type:"text",placeholder:"@yourhandle"},{key:"twitterCreator",label:"Twitter 작성자 계정",type:"text",placeholder:"@yourhandle"}]},{title:"🤖 검색 엔진 설정",fields:[{key:"robotsIndex",label:"검색 엔진 인덱싱 허용",type:"checkbox",placeholder:"검색 엔진이 이 사이트를 인덱싱할 수 있도록 허용합니다."},{key:"robotsFollow",label:"링크 팔로우 허용",type:"checkbox",placeholder:"검색 엔진이 이 사이트의 링크를 따라갈 수 있도록 허용합니다."}]},{title:"📊 Google 설정",fields:[{key:"googleAnalyticsId",label:"Google Analytics ID",type:"text",placeholder:"G-XXXXXXXXXX"},{key:"googleSiteVerification",label:"Google 사이트 인증 코드",type:"text",placeholder:"google-site-verification=..."}]},{title:"📱 글로벌 소셜 미디어",fields:[{key:"instagramUrl",label:"Instagram URL",type:"url",placeholder:"https://instagram.com/yourhandle"},{key:"twitterUrl",label:"Twitter URL",type:"url",placeholder:"https://twitter.com/yourhandle"},{key:"facebookUrl",label:"Facebook URL",type:"url",placeholder:"https://facebook.com/yourpage"},{key:"youtubeUrl",label:"YouTube URL",type:"url",placeholder:"https://youtube.com/@yourchannel"},{key:"tiktokUrl",label:"TikTok URL",type:"url",placeholder:"https://tiktok.com/@yourhandle"}]},{title:"🎨 디자인 & 포트폴리오",fields:[{key:"behanceUrl",label:"Behance URL",type:"url",placeholder:"https://behance.net/yourprofile"},{key:"dribbbleUrl",label:"Dribbble URL",type:"url",placeholder:"https://dribbble.com/yourhandle"}]},{title:"✍️ 블로그 & 글쓰기",fields:[{key:"mediumUrl",label:"Medium URL",type:"url",placeholder:"https://medium.com/@yourhandle"},{key:"velogUrl",label:"Velog URL",type:"url",placeholder:"https://velog.io/@yourhandle"},{key:"tistoryUrl",label:"Tistory URL",type:"url",placeholder:"https://yourblog.tistory.com"},{key:"naverBlogUrl",label:"네이버 블로그 URL",type:"url",placeholder:"https://blog.naver.com/yourblog"}]},{title:"💬 메신저 & 커뮤니케이션",fields:[{key:"telegramUrl",label:"Telegram URL",type:"url",placeholder:"https://t.me/yourhandle"},{key:"discordUrl",label:"Discord URL",type:"url",placeholder:"https://discord.gg/yourserver"},{key:"kakaoTalkUrl",label:"카카오톡 URL",type:"url",placeholder:"https://open.kakao.com/o/yourgroup"}]},{title:"📝 워크스페이스 & 도구",fields:[{key:"notionUrl",label:"Notion 워크스페이스 URL",type:"url",placeholder:"https://notion.so/yourworkspace"}]},{title:"📊 웹 분석 도구",fields:[{key:"googleTagManagerId",label:"Google Tag Manager ID",type:"text",placeholder:"GTM-XXXXXXX"},{key:"facebookPixelId",label:"Facebook Pixel ID",type:"text",placeholder:"123456789012345"},{key:"naverAnalyticsId",label:"네이버 웹마스터 도구 ID",type:"text",placeholder:"naver-site-verification=..."},{key:"kakaoPixelId",label:"카카오 픽셀 ID",type:"text",placeholder:"1234567890"}]},{title:"🔍 사용자 행동 분석",fields:[{key:"hotjarId",label:"Hotjar Site ID",type:"text",placeholder:"1234567"},{key:"mixpanelToken",label:"Mixpanel Project Token",type:"text",placeholder:"abc123def456..."},{key:"amplitudeApiKey",label:"Amplitude API Key",type:"text",placeholder:"abc123def456..."}]},{title:"🐛 에러 추적 & 모니터링",fields:[{key:"sentryDsn",label:"Sentry DSN",type:"text",placeholder:"https://abc123@sentry.io/123456"},{key:"logRocketId",label:"LogRocket App ID",type:"text",placeholder:"abc123def456"},{key:"fullStoryOrgId",label:"FullStory Org ID",type:"text",placeholder:"ABC123"}]},{title:"💬 고객 지원 & 채팅",fields:[{key:"intercomAppId",label:"Intercom App ID",type:"text",placeholder:"abc123def"},{key:"zendeskWidgetKey",label:"Zendesk Widget Key",type:"text",placeholder:"abc123def456..."},{key:"crispWebsiteId",label:"Crisp Website ID",type:"text",placeholder:"abc123def456..."}]},{title:"🎧 추가 채팅 도구",fields:[{key:"tawkToPropertyId",label:"Tawk.to Property ID",type:"text",placeholder:"abc123def456..."},{key:"liveChatLicense",label:"LiveChat License Number",type:"text",placeholder:"12345678"},{key:"olarkSiteId",label:"Olark Site ID",type:"text",placeholder:"abc123def456..."}]},{title:"🔒 기본 보안 헤더",fields:[{key:"enableHttps",label:"HTTPS 강제 사용",type:"checkbox",placeholder:"모든 HTTP 요청을 HTTPS로 리다이렉트합니다."},{key:"enableCsp",label:"Content Security Policy (CSP) 활성화",type:"checkbox",placeholder:"XSS 공격을 방지하기 위한 CSP 헤더를 설정합니다."},{key:"cspDirectives",label:"CSP 지시문",type:"textarea",rows:3,placeholder:"Content Security Policy 지시문을 설정합니다."},{key:"enableHsts",label:"HTTP Strict Transport Security (HSTS) 활성화",type:"checkbox",placeholder:"HTTPS 연결을 강제하는 HSTS 헤더를 설정합니다."},{key:"hstsMaxAge",label:"HSTS 최대 나이 (초)",type:"text",placeholder:"31536000 (1년)"}]},{title:"🛡️ 추가 보안 헤더",fields:[{key:"enableXssProtection",label:"XSS 보호 활성화",type:"checkbox",placeholder:"브라우저의 XSS 필터를 활성화합니다."},{key:"enableContentTypeOptions",label:"Content-Type 옵션 활성화",type:"checkbox",placeholder:"MIME 타입 스니핑 공격을 방지합니다."},{key:"enableFrameOptions",label:"X-Frame-Options 활성화",type:"checkbox",placeholder:"클릭재킹 공격을 방지합니다."},{key:"frameOptionsValue",label:"X-Frame-Options 값",type:"select",placeholder:"헤더 값 선택",options:[{value:"DENY",label:"DENY (모든 프레임 차단)"},{value:"SAMEORIGIN",label:"SAMEORIGIN (같은 도메인만 허용)"},{value:"ALLOW-FROM",label:"ALLOW-FROM (특정 도메인 허용)"}]},{key:"enableReferrerPolicy",label:"Referrer Policy 활성화",type:"checkbox",placeholder:"리퍼러 정보 노출을 제어합니다."},{key:"referrerPolicyValue",label:"Referrer Policy 값",type:"select",placeholder:"정책 값 선택",options:[{value:"no-referrer",label:"no-referrer (리퍼러 정보 전송 안함)"},{value:"strict-origin-when-cross-origin",label:"strict-origin-when-cross-origin (교차 도메인시 도메인만)"},{value:"same-origin",label:"same-origin (같은 도메인만)"}]}]},{title:"🔐 권한 및 정책",fields:[{key:"enablePermissionsPolicy",label:"Permissions Policy 활성화",type:"checkbox",placeholder:"브라우저 기능 사용을 제어합니다."},{key:"permissionsPolicyValue",label:"Permissions Policy 값",type:"textarea",rows:2,placeholder:"camera=(), microphone=(), geolocation=(), payment=()"}]},{title:"⚡ API 보안",fields:[{key:"enableApiRateLimit",label:"API 속도 제한 활성화",type:"checkbox",placeholder:"API 요청 빈도를 제한하여 DDoS 공격을 방지합니다."},{key:"apiRateLimitPerMinute",label:"분당 API 요청 제한",type:"text",placeholder:"60 (분당 60회)"}]},{title:"👤 관리자 인증",fields:[{key:"enableAdminAuth",label:"관리자 인증 활성화",type:"checkbox",placeholder:"관리자 대시보드 접근을 위한 인증을 활성화합니다."},{key:"adminSessionTimeout",label:"관리자 세션 타임아웃 (초)",type:"text",placeholder:"3600 (1시간)"},{key:"enableTwoFactorAuth",label:"2단계 인증 활성화",type:"checkbox",placeholder:"관리자 로그인시 2단계 인증을 요구합니다."},{key:"enableIpWhitelist",label:"IP 화이트리스트 활성화",type:"checkbox",placeholder:"특정 IP 주소에서만 관리자 접근을 허용합니다."},{key:"allowedIpAddresses",label:"허용된 IP 주소 (쉼표로 구분)",type:"text",placeholder:"192.168.1.1, 10.0.0.1"}]},{title:"📋 로그 & 백업",fields:[{key:"enableAuditLog",label:"감사 로그 활성화",type:"checkbox",placeholder:"관리자 활동을 기록하여 보안 감사를 지원합니다."},{key:"enableBackup",label:"자동 백업 활성화",type:"checkbox",placeholder:"정기적으로 데이터를 백업합니다."},{key:"backupFrequency",label:"백업 빈도",type:"select",placeholder:"백업 주기 선택",options:[{value:"hourly",label:"매시간 (hourly)"},{value:"daily",label:"매일 (daily)"},{value:"weekly",label:"매주 (weekly)"},{value:"monthly",label:"매월 (monthly)"}]}]}],ir=(t,r)=>r==="ko"?t:r==="en"?`${t}En`:r==="ja"?`${t}Ja`:t,Xo=t=>{switch(t){case"general":return"🏠 일반 설정";case"appearance":return"🎨 외관 설정";case"seo":return"🔍 SEO 설정";case"social":return"📱 소셜 미디어";case"analytics":return"📊 분석 도구";case"security":return"🔒 보안 설정";default:return"사이트 설정"}},Yo=t=>{switch(t){case"general":return"사이트의 기본 정보와 개인 정보를 설정합니다.";case"appearance":return"각 섹션의 제목과 내용을 편집합니다.";case"seo":return"검색 엔진 최적화 설정을 관리합니다.";case"social":return"소셜 미디어 링크와 연락처 정보를 설정합니다.";case"analytics":return"Google Analytics 등 분석 도구를 설정합니다.";case"security":return"인증 및 보안 설정을 관리합니다.";default:return"포트폴리오의 모든 텍스트를 편집하고 저장하세요."}},Ea=t=>{if(!t)return Me;switch(t){case"general":return Me.filter(r=>r.title.includes("개인 정보")||r.title.includes("소셜 링크")||r.title.includes("사이드바 설정"));case"appearance":return Me.filter(r=>r.title.includes("Hero")||r.title.includes("About")||r.title.includes("Experience")||r.title.includes("Skills")||r.title.includes("학습 목표")||r.title.includes("Projects")||r.title.includes("Books")||r.title.includes("Contact")||r.title.includes("통계"));case"seo":return Me.filter(r=>r.title.includes("SEO")||r.title.includes("Open Graph")||r.title.includes("Twitter Card")||r.title.includes("검색 엔진")||r.title.includes("Google"));case"social":return Me.filter(r=>r.title.includes("소셜 링크")||r.title.includes("글로벌 소셜 미디어")||r.title.includes("디자인 & 포트폴리오")||r.title.includes("블로그 & 글쓰기")||r.title.includes("메신저 & 커뮤니케이션")||r.title.includes("워크스페이스 & 도구"));case"analytics":return Me.filter(r=>r.title.includes("웹 분석 도구")||r.title.includes("사용자 행동 분석")||r.title.includes("에러 추적")||r.title.includes("고객 지원")||r.title.includes("추가 채팅 도구"));case"security":return Me.filter(r=>r.title.includes("기본 보안 헤더")||r.title.includes("추가 보안 헤더")||r.title.includes("권한 및 정책")||r.title.includes("API 보안")||r.title.includes("관리자 인증")||r.title.includes("로그 & 백업"));default:return Me}},Qo=(t=null)=>{const{refetchSettings:r}=Qa(),[a,s]=d.useState(Yr),[n,l]=d.useState(!0),[o,i]=d.useState(!1),[u,x]=d.useState(null),[c,h]=d.useState(new Set(["개인 정보","소셜 링크"])),[g,N]=d.useState("ko"),m=E=>{const S={...Yr,...E};return S.sidebarSkillCount&&(S.sidebarSkillCount=typeof S.sidebarSkillCount=="number"?S.sidebarSkillCount:parseInt(String(S.sidebarSkillCount))||4),S.languageCardSkillCount&&(S.languageCardSkillCount=typeof S.languageCardSkillCount=="number"?S.languageCardSkillCount:parseInt(String(S.languageCardSkillCount))||3),S},f=d.useCallback(async()=>{try{const E=await Fr.get(),S=m(E.data);s(S)}catch(E){console.error("Failed to fetch settings:",E),x({type:"error",text:"설정을 불러오는데 실패했습니다. 기본 값으로 표시됩니다."})}finally{l(!1)}},[]),p=async()=>{i(!0),x(null);try{await Fr.update(a),await r(),x({type:"success",text:"✅ 설정이 성공적으로 저장되었습니다! 화면이 업데이트됩니다."}),setTimeout(()=>x(null),5e3)}catch(E){console.error("Failed to save settings:",E),x({type:"error",text:"❌ 설정 저장에 실패했습니다. 콘솔을 확인해주세요."})}finally{i(!1)}},w=(E,S)=>{s(v=>({...v,[E]:S}))},j=E=>{h(S=>{const v=new Set(S);return v.has(E)?v.delete(E):v.add(E),v})};return d.useEffect(()=>{f()},[f]),d.useEffect(()=>{if(t)if(t==="appearance")h(new Set);else{const S=Ea(t).map(v=>v.title);h(new Set(S))}else h(new Set(["개인 정보","소셜 링크"]))},[t]),{settings:a,loading:n,saving:o,message:u,expandedSections:c,currentLang:g,setCurrentLang:N,handleChange:w,handleSave:p,toggleSection:j,setExpandedSections:h}},Zo=({field:t,value:r,onChange:a,currentLang:s="ko",settings:n})=>{const l=()=>{if(!t.isMultilingual||!n)return null;const i=n[t.key],u=n[ir(t.key,"en")],x=n[ir(t.key,"ja")];return e.jsxs("div",{className:"flex gap-2 text-xs mb-2",children:[e.jsxs("span",{className:`px-2 py-1 rounded ${i?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-500"}`,children:["🇰🇷 ",i?"✓":"○"]}),e.jsxs("span",{className:`px-2 py-1 rounded ${u?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-500"}`,children:["🇺🇸 ",u?"✓":"○"]}),e.jsxs("span",{className:`px-2 py-1 rounded ${x?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-500"}`,children:["🇯🇵 ",x?"✓":"○"]})]})},o=()=>{var i;switch(t.type){case"textarea":return e.jsxs(e.Fragment,{children:[l(),e.jsx("textarea",{id:t.key,value:r||"",onChange:u=>a(u.target.value),rows:t.rows||3,placeholder:t.placeholder,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-vertical"})]});case"select":return e.jsx("select",{id:t.key,value:r||"",onChange:u=>a(u.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:(i=t.options)==null?void 0:i.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))});case"checkbox":return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:t.key,type:"checkbox",checked:r||!1,onChange:u=>a(u.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("label",{htmlFor:t.key,className:"text-sm text-gray-700 dark:text-gray-300",children:t.placeholder})]});case"number":return e.jsx("input",{id:t.key,type:"number",value:r||"",onChange:u=>a(parseInt(u.target.value)||0),min:t.min,max:t.max,placeholder:t.placeholder,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"});case"array":return e.jsxs(e.Fragment,{children:[l(),e.jsxs("div",{className:"space-y-2",children:[(r||[]).map((u,x)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:u,onChange:c=>{const h=[...r];h[x]=c.target.value,a(h)},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:t.placeholder}),e.jsx("button",{type:"button",onClick:()=>{const c=r.filter((h,g)=>g!==x);a(c)},className:"p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"삭제"})]},x)),e.jsxs("button",{type:"button",onClick:()=>{const u=[...r||[],""];a(u)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(se,{size:12})," 항목 추가"]})]})]});default:return e.jsxs(e.Fragment,{children:[l(),e.jsx("input",{id:t.key,type:t.type,value:r||"",onChange:u=>a(u.target.value),placeholder:t.placeholder,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})}};return e.jsxs("div",{children:[t.type!=="checkbox"&&e.jsx("label",{htmlFor:t.key,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.label}),o(),t.type==="checkbox"&&e.jsx("label",{htmlFor:t.key,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.label})]})},ei=({section:t,isExpanded:r,onToggle:a,currentLang:s,settings:n,onChange:l,setCurrentLang:o})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("button",{onClick:a,className:"w-full p-6 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(be,{className:"text-primary-500",size:20}),t.title,r?e.jsx($t,{className:"text-gray-400 ml-auto",size:16}):e.jsx(cr,{className:"text-gray-400 ml-auto",size:16})]})}),e.jsx(Ue,{children:r&&e.jsx(me.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:e.jsxs("div",{className:`p-6 pt-4 border-t border-gray-200 dark:border-gray-700 ${t.title.includes("Hero 섹션")?"py-8":""}`,children:[t.fields.some(i=>i.isMultilingual)&&e.jsx(Je,{activeLanguage:s,onChange:o}),e.jsx("div",{className:`grid gap-6 ${t.title.includes("About 섹션")||t.title.includes("Hero 섹션")||t.title.includes("Experience 섹션")||t.title.includes("Skills 섹션")||t.title.includes("Projects 섹션")||t.title.includes("Books 섹션")||t.title.includes("소셜 링크")||t.title.includes("Contact 섹션")?"grid-cols-1":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}`,children:t.fields.map(i=>{const u=i.isMultilingual?ir(i.key,s):i.key;return e.jsx(Zo,{field:i,value:n[u]||(i.type==="checkbox"?!1:i.type==="array"?[]:""),onChange:x=>l(u,x),currentLang:s,settings:n},i.key)})})]})})})]}),ti=({activeSection:t=null})=>{const{settings:r,loading:a,saving:s,message:n,expandedSections:l,currentLang:o,setCurrentLang:i,handleChange:u,handleSave:x,toggleSection:c,setExpandedSections:h}=Qo(t);if(a)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"설정을 불러오는 중..."})]});const g=Ea(t);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:Xo(t)}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:Yo(t)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{const N=g.map(m=>m.title);h(new Set(N))},className:"flex items-center gap-2 bg-gray-500 hover:bg-gray-600 text-white font-medium px-4 py-2 rounded-lg transition-colors text-sm",children:"모두 펼치기"}),e.jsx("button",{onClick:()=>h(new Set),className:"flex items-center gap-2 bg-gray-500 hover:bg-gray-600 text-white font-medium px-4 py-2 rounded-lg transition-colors text-sm",children:"모두 접기"}),e.jsxs("button",{onClick:x,disabled:s,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(xe,{}),s?"저장 중...":"모두 저장"]})]})]}),n&&e.jsx(me.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.3},className:`p-4 rounded-lg shadow-md ${n.type==="success"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 border border-green-400 dark:border-green-700":"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 border border-red-400 dark:border-red-700"}`,children:n.text}),g.map(N=>e.jsx(ei,{section:N,isExpanded:l.has(N.title),onToggle:()=>c(N.title),currentLang:o,settings:r,onChange:u,setCurrentLang:i},N.title)),!t&&e.jsx("div",{className:"py-4",children:e.jsxs("button",{onClick:x,disabled:s,className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-medium px-8 py-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(xe,{size:20}),s?"설정 저장 중...":"모두 저장하고 적용"]})})]})},ri=()=>{ke();const{data:t,isLoading:r}=dr({queryKey:["dataCounts"],queryFn:async()=>{var c,h,g,N,m,f,p,w,j,E,S,v,T,y,b;const[a,s,n,l,o,i,u,x]=await Promise.all([ct.getAll(),Za.getAll(),es.getAll(),gt.getAll(),ut.getAll(),Ve.getAll(),qe.getCategories(),ts.getAll()]);return{books:((h=(c=a.data)==null?void 0:c.data)==null?void 0:h.length)||0,videoLearnings:((N=(g=s.data)==null?void 0:g.data)==null?void 0:N.length)||0,videoPlaylists:((f=(m=n.data)==null?void 0:m.data)==null?void 0:f.length)||0,experiences:((w=(p=l.data)==null?void 0:p.data)==null?void 0:w.length)||0,projects:((E=(j=o.data)==null?void 0:j.data)==null?void 0:E.length)||0,messages:((v=(S=i.data)==null?void 0:S.data)==null?void 0:v.length)||0,skills:((y=(T=u.data)==null?void 0:T.data)==null?void 0:y.length)||0,categories:((b=x.data)==null?void 0:b.length)||0}},staleTime:2*60*1e3,gcTime:5*60*1e3,refetchOnWindowFocus:!0});return{counts:t||{books:0,videoLearnings:0,videoPlaylists:0,experiences:0,projects:0,messages:0,skills:0,categories:0},isLoading:r,refreshCounts:()=>{}}},ai=()=>{const[t,r]=d.useState("settings"),[a,s]=d.useState(null),[n,l]=d.useState("all"),[o,i]=d.useState(""),[u,x]=d.useState(""),[c,h]=d.useState("all"),[g,N]=d.useState(""),[m,f]=d.useState(""),[p,w]=d.useState(""),[j,E]=d.useState("all"),[S,v]=d.useState(""),[T,y]=d.useState("");return{activeTab:t,setActiveTab:r,activeSettingsSection:a,setActiveSettingsSection:s,bookFilters:{state:{filter:n,searchTerm:o,selectedCategory:u},actions:{setFilter:l,setSearchTerm:i,setSelectedCategory:x},data:{categories:["프로그래밍","데이터베이스","웹 개발","AI/ML","시스템 설계"]}},experienceFilters:{state:{filter:c,searchTerm:g,selectedCompany:m,selectedYear:p},actions:{setFilter:h,setSearchTerm:N,setSelectedCompany:f,setSelectedYear:w},data:{companies:["ABC Corp","XYZ Inc","Dev Solutions","Tech Startup"],years:["2024","2023","2022","2021","2020"]}},projectFilters:{state:{filter:j,searchTerm:S,selectedCategory:T},actions:{setFilter:E,setSearchTerm:v,setSelectedCategory:y},data:{categories:["웹 개발","모바일 앱","데이터 분석","임베디드","AI/ML"]}}}},mi=()=>{const{isAuthenticated:t,logout:r,isLoading:a}=rs(),s=as(),[n,l]=d.useState(!1),{toasts:o,hideToast:i}=ze(),{activeTab:u,setActiveTab:x,activeSettingsSection:c,setActiveSettingsSection:h,bookFilters:g,experienceFilters:N,projectFilters:m}=ai(),{counts:f,refreshCounts:p}=ri(),{data:w=[]}=Sa(),j=d.useMemo(()=>w.filter(S=>!S.isRead).map(S=>({id:S._id||"",message:`${S.name}님으로부터 새로운 메시지: ${S.subject}`,read:!1,createdAt:S.createdAt||new Date().toISOString()})).sort((S,v)=>new Date(v.createdAt).getTime()-new Date(S.createdAt).getTime()),[w]);if(d.useEffect(()=>{const S=s.state;S!=null&&S.tab&&x(S.tab)},[s.state,x]),!t&&!a)return e.jsx("div",{children:"로그인이 필요합니다."});if(a)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"로딩 중..."})]})});const E=()=>{const S=s.state,v=S==null?void 0:S.editId;switch(u){case"books":return e.jsx(En,{bookFilter:g.state.filter,bookSearchTerm:g.state.searchTerm,selectedBookCategory:g.state.selectedCategory,initialEditId:v});case"videoLearnings":return e.jsx(Tn,{initialEditId:v});case"videoPlaylists":return e.jsx(An,{});case"experiences":return e.jsx(yo,{experienceFilter:N.state.filter,experienceSearchTerm:N.state.searchTerm,selectedExperienceCompany:N.state.selectedCompany,selectedExperienceYear:N.state.selectedYear});case"projects":return e.jsx(vo,{projectFilter:m.state.filter,projectSearchTerm:m.state.searchTerm,selectedProjectCategory:m.state.selectedCategory});case"messages":return e.jsx(Do,{});case"skills":return e.jsx(Bo,{});case"categories":return e.jsx(Vo,{});default:return c?e.jsx(ti,{activeSection:c}):e.jsx(Cs,{counts:f})}};return e.jsxs(e.Fragment,{children:[e.jsx(ra,{toasts:o,onClose:i}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 min-h-screen text-gray-900 dark:text-white",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"flex-1 p-8",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white",children:"관리자 대시보드"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(qo,{notifications:j,showNotifications:n,onToggle:()=>l(!n),onNotificationClick:()=>{x("messages"),l(!1)}}),e.jsxs("button",{onClick:r,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(ss,{}),"로그아웃"]})]})]}),E()]}),e.jsx(Go,{activeTab:u,setActiveTab:x,activeSettingsSection:c,setActiveSettingsSection:h,counts:f,refreshCounts:p,bookFilters:g,experienceFilters:N,projectFilters:m})]})})})})})]})};export{mi as default};
