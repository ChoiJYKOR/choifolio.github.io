import{r as g,k as e,y as C,z as F,h as T,j as P,A as S,B as z,q as d,l as p,L as N,C as I,D as L,E as J,G as V}from"./index-1fe3a1ef.js";import{u as A}from"./index-180e19ab.js";import{u as D}from"./useBooks-2ae1e263.js";import{u as q}from"./useCategories-ec204ac9.js";import{f as G}from"./dateUtils-19c0cc10.js";import{S as H}from"./ScrollToTopButton-906ef78e.js";import"./useMutation-31c06883.js";const M=({src:r,alt:y,className:n="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300",fallbackIcon:f})=>{const[s,c]=g.useState("loading"),[h,u]=g.useState(r),v=()=>{c("loaded")},k=()=>{c("error"),u(void 0)};return!h||s==="error"?e.jsx("div",{className:"w-full h-64 bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center",children:f||e.jsx(C,{className:"text-white text-6xl"})}):e.jsxs("div",{className:"relative overflow-hidden",children:[s==="loading"&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 dark:bg-gray-700 animate-pulse flex items-center justify-center",children:e.jsx(F,{className:"text-gray-400 text-4xl"})}),e.jsx("img",{src:h,alt:y,className:`${n} ${s==="loading"?"opacity-0":"opacity-100"} transition-opacity duration-300`,loading:"lazy",decoding:"async",width:"400",height:"256",onLoad:v,onError:k})]})},Z=()=>{const{settings:r,loading:y}=T(),{t:n,i18n:f}=P(),s=f.language,{data:c=[],isLoading:h}=D(),{data:u=[],isLoading:v}=q(),k=S(),[$,E]=A({triggerOnce:!0,threshold:.1}),[l,b]=g.useState("all"),{isAuthenticated:B}=z();g.useEffect(()=>{var t;const a=(t=k.state)==null?void 0:t.scrollPosition;a&&(window.scrollTo(0,a),window.history.replaceState({},document.title))},[]);const j=g.useMemo(()=>{const a=c||[];return l==="all"?a:a.filter(t=>{var o;return!t.categoryIds||t.categoryIds.length===0?((o=t.category)==null?void 0:o.toLowerCase())===l:t.categoryIds.some(i=>(typeof i=="string"?i:i==null?void 0:i._id)===l)})},[c,l]),_=y||h,w={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2}}},m={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:"easeOut"}}};return e.jsxs("section",{className:"section-padding bg-white dark:bg-dark-800 min-h-screen",children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs(d.div,{ref:$,variants:w,initial:"hidden",animate:E?"visible":"hidden",children:[e.jsxs(d.div,{variants:m,className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-dark-900 dark:text-white mb-6",children:p(s,r==null?void 0:r.booksTitle,r==null?void 0:r.booksTitleEn,r==null?void 0:r.booksTitleJa)||"기술 서적 & 학습 노트"}),e.jsx("p",{className:"text-xl text-dark-600 dark:text-dark-300 max-w-3xl mx-auto mb-8",children:p(s,r==null?void 0:r.booksSubtitle,r==null?void 0:r.booksSubtitleEn,r==null?void 0:r.booksSubtitleJa)||"읽은 기술 서적과 그로부터 배운 지식을 공유합니다"})]}),B&&e.jsx(d.div,{variants:m,className:"mb-8 flex justify-end",children:e.jsxs(N,{to:"/admin",className:"inline-flex items-center gap-2 bg-accent-500 hover:bg-accent-600 text-white font-medium px-6 py-3 rounded-lg transition-colors duration-600 shadow-medium hover:shadow-glow",children:[e.jsx(I,{})," 서적 추가"]})}),e.jsxs(d.div,{variants:m,className:"flex justify-center flex-wrap gap-3 mb-12",children:[e.jsx("button",{onClick:()=>b("all"),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors duration-600 border ${l==="all"?"bg-primary-500 text-white border-primary-500 dark:bg-primary-600 dark:border-primary-600 shadow-glow":"bg-white text-dark-700 border-secondary-300 hover:bg-secondary-50 dark:bg-dark-700 dark:text-dark-300 dark:border-dark-600 dark:hover:bg-dark-600"}`,children:n("books.all")},"all"),u.map(a=>e.jsx("button",{onClick:()=>b(a._id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors duration-600 border ${l===a._id?"bg-primary-500 text-white border-primary-500 dark:bg-primary-600 dark:border-primary-600 shadow-glow":"bg-white text-dark-700 border-secondary-300 hover:bg-secondary-50 dark:bg-dark-700 dark:text-dark-300 dark:border-dark-600 dark:hover:bg-dark-600"}`,children:L(s,a)},a._id))]}),_?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-dark-500 dark:text-dark-400",children:"데이터를 불러오는 중..."})]}):j.length===0?e.jsxs(d.div,{variants:m,className:"text-center py-12",children:[e.jsx(C,{className:"text-6xl text-dark-400 mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-dark-600 dark:text-dark-400",children:n("books.noBooksInCategory")})]}):e.jsx(d.div,{variants:w,className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:j.map(a=>e.jsx(d.div,{variants:m,whileHover:{y:-5},className:"card hover-lift",children:e.jsxs(N,{to:`/books/${a._id}`,state:{scrollPosition:window.scrollY},className:"block overflow-hidden h-full group",children:[e.jsx(M,{src:a.coverImage||"",alt:a.title,className:"w-full h-64 object-cover group-hover:scale-105 transition-transform duration-600"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:a.categoryIds&&a.categoryIds.length>0?a.categoryIds.map(t=>{const o=typeof t=="string"?t:t==null?void 0:t._id,i=typeof t=="string"?u.find(x=>x._id===o):t;return i?e.jsx("span",{className:"px-3 py-1 bg-primary-100 dark:bg-primary-800/50 text-primary-800 dark:text-primary-200 rounded-full text-sm font-medium",children:L(s,i)},o):null}):a.category&&e.jsx("span",{className:"px-3 py-1 bg-primary-100 dark:bg-primary-800/50 text-primary-800 dark:text-primary-200 rounded-full text-sm font-medium",children:a.category})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"text-yellow-500"}),e.jsxs("span",{className:"text-dark-700 dark:text-dark-300 font-medium",children:[a.rating,"/5"]})]})]}),e.jsx("h3",{className:"text-xl font-bold text-dark-900 dark:text-white mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-600",children:p(s,a.title,a.titleEn,a.titleJa)}),e.jsx("p",{className:"text-dark-600 dark:text-dark-400 mb-4",children:p(s,a.author,a.authorEn,a.authorJa)}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-dark-500 dark:text-dark-500 pt-2 border-t border-secondary-200 dark:border-dark-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{}),e.jsx("span",{children:G(a.readDate)})]}),e.jsx("span",{className:"hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-600 font-medium",children:(()=>{if(a.chapters&&a.chapters.length>0){const t=a.chapters.reduce((o,i)=>{var x;return o+(((x=i.learnings)==null?void 0:x.length)||0)},0);return`${a.chapters.length}${n("books.chaptersCount")}, ${t}${n("books.learningsCount")}`}else return a.learnings&&a.learnings.length>0?`${a.learnings.length}${n("books.learningsCountOf")}`:n("books.noLearnings")})()})]})]})]})},a._id))})]})}),e.jsx(H,{})]})};export{Z as default};
