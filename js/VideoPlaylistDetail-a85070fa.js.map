{"version":3,"file":"VideoPlaylistDetail-a85070fa.js","sources":["../../src/components/VideoPlaylistDetail.tsx"],"sourcesContent":["import React, { useState, useMemo, useRef, useEffect } from 'react'\r\nimport { motion } from 'framer-motion'\r\nimport { useParams, Link, useNavigate, useLocation } from 'react-router-dom'\r\nimport { FaArrowLeft, FaList, FaStar, FaCalendar, FaEdit, FaTrash, FaCubes, FaBullseye, FaRocket, FaChevronDown, FaChevronUp, FaSave, FaTimes } from 'react-icons/fa'\r\nimport { useAuth } from '../contexts/AuthContext'\r\nimport { formatDate } from '../utils/dateUtils'\r\nimport { useVideoPlaylist, useDeleteVideoPlaylist, usePlaylistVideos, useUpdatePlaylistVideo } from '../hooks/useVideoPlaylists'\r\nimport { useSkills } from '../hooks/useSkills'\r\nimport ReactMarkdown from 'react-markdown'\r\nimport { renderTextWithTimestamps, renderHtmlWithTimestamps } from '../utils/videoUtils'\r\nimport RichTextEditor from './RichTextEditor'\r\nimport { useToastHelpers } from '../hooks/useToast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { getLocalizedField } from '@/utils/i18nUtils'\r\n\r\n// 유튜브 IFrame Player API 타입 정의\r\ndeclare global {\r\n  interface Window {\r\n    YT: any\r\n    onYouTubeIframeAPIReady: () => void\r\n  }\r\n}\r\n\r\nconst VideoPlaylistDetail: React.FC = () => {\r\n  const { id } = useParams<{ id: string }>()\r\n  const navigate = useNavigate()\r\n  const location = useLocation()\r\n  const { isAuthenticated } = useAuth()\r\n  const { i18n } = useTranslation()\r\n  const currentLang = i18n.language as 'ko' | 'en' | 'ja'\r\n  \r\n  const { data: playlist, isLoading: loading } = useVideoPlaylist(id)\r\n  const { data: playlistVideos = [] } = usePlaylistVideos(id)\r\n  const deleteMutation = useDeleteVideoPlaylist()\r\n  const updateVideoMutation = useUpdatePlaylistVideo()\r\n  const { skillCategories } = useSkills()\r\n  const { success, error } = useToastHelpers()\r\n\r\n  const playerRef = useRef<any>(null)\r\n  const playerContainerRef = useRef<HTMLDivElement>(null)\r\n  const [isPlayerReady, setIsPlayerReady] = useState(false)\r\n  const [activeVideoId, setActiveVideoId] = useState<string | null>(null)\r\n  const [expandedVideoId, setExpandedVideoId] = useState<string | null>(null)\r\n  const [activeVideoTab, setActiveVideoTab] = useState<string | null>(null)\r\n  const [showVideoTabs, setShowVideoTabs] = useState(true)\r\n  \r\n  // 🌟 핵심 배움 편집 상태\r\n  const [editingVideoId, setEditingVideoId] = useState<string | null>(null)\r\n  const [editingContent, setEditingContent] = useState<string>('')\r\n\r\n\r\n  // 첫 번째 영상을 기본 활성 영상으로 설정\r\n  useEffect(() => {\r\n    if (playlistVideos.length > 0 && !activeVideoId && playlistVideos[0]) {\r\n      setActiveVideoId(playlistVideos[0].videoId)\r\n    }\r\n  }, [playlistVideos, activeVideoId])\r\n\r\n  // 유튜브 IFrame API 초기화\r\n  useEffect(() => {\r\n    if (!playlist?.playlistId) return\r\n    \r\n    if (!window.YT) {\r\n      const tag = document.createElement('script')\r\n      tag.src = 'https://www.youtube.com/iframe_api'\r\n      const firstScriptTag = document.getElementsByTagName('script')[0]\r\n      if (firstScriptTag?.parentNode) {\r\n        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag)\r\n      }\r\n    }\r\n    \r\n    const initializePlayer = () => {\r\n      if (window.YT && window.YT.Player && playerContainerRef.current) {\r\n        playerRef.current = new window.YT.Player(playerContainerRef.current, {\r\n          playerVars: {\r\n            listType: 'playlist',\r\n            list: playlist.playlistId,\r\n            enablejsapi: 1,\r\n            origin: window.location.origin,\r\n            rel: 0,\r\n            modestbranding: 1,\r\n            fs: 1,\r\n            cc_load_policy: 0,\r\n            iv_load_policy: 3,\r\n            showinfo: 0,\r\n          },\r\n          events: {\r\n            onReady: () => {\r\n              setIsPlayerReady(true)\r\n            },\r\n          },\r\n        })\r\n      }\r\n    }\r\n    \r\n    if (window.YT && window.YT.Player) {\r\n      initializePlayer()\r\n    } else {\r\n      window.onYouTubeIframeAPIReady = initializePlayer\r\n    }\r\n    \r\n    return () => {\r\n      if (playerRef.current && typeof playerRef.current.destroy === 'function') {\r\n        playerRef.current.destroy()\r\n      }\r\n    }\r\n  }, [playlist?.playlistId])\r\n\r\n  // 첫 번째 영상을 기본 활성 탭으로 설정\r\n  useEffect(() => {\r\n    if (playlistVideos.length > 0 && !activeVideoTab && playlistVideos[0]) {\r\n      setActiveVideoTab(playlistVideos[0]._id)\r\n    }\r\n  }, [playlistVideos, activeVideoTab])\r\n\r\n  // 연결된 스킬\r\n  const linkedSkills = useMemo(() => {\r\n    if (!playlist?.skillIds || !skillCategories) return []\r\n    const allSkills = skillCategories.flatMap(cat => cat.skills || [])\r\n    return allSkills.filter(skill => skill._id && playlist.skillIds?.includes(skill._id))\r\n  }, [playlist, skillCategories])\r\n\r\n  // 활성 영상\r\n  const activeVideo = useMemo(() => \r\n    playlistVideos.find(v => v._id === activeVideoTab),\r\n    [playlistVideos, activeVideoTab]\r\n  )\r\n\r\n  // 탭 클릭 시 영상 전환\r\n  const handleVideoTabClick = (video: any, index: number) => {\r\n    setActiveVideoTab(video._id)\r\n    handleTimestampClick(video.videoId, 0)\r\n  }\r\n\r\n  // 타임스탬프 클릭 핸들러 (영상 전환 + 시간 이동 + 자동 재생)\r\n  const handleTimestampClick = (targetVideoId: string, seconds: number) => {\r\n    if (!isPlayerReady || !playerRef.current) {\r\n      return\r\n    }\r\n\r\n    try {\r\n      const videoIndex = playlistVideos.findIndex(v => v.videoId === targetVideoId)\r\n      \r\n      if (videoIndex === -1) {\r\n        return\r\n      }\r\n\r\n      // 영상 전환\r\n      playerRef.current.playVideoAt(videoIndex)\r\n      setActiveVideoId(targetVideoId)\r\n      \r\n      // 시간 이동 + 자동 재생\r\n      setTimeout(() => {\r\n        playerRef.current.seekTo(seconds, true)\r\n        playerRef.current.playVideo()\r\n      }, 1000)\r\n      \r\n    } catch (error) {\r\n      console.error('타임스탬프 이동 실패:', error)\r\n    }\r\n  }\r\n\r\n\r\n  // 재생 목록 삭제 핸들러\r\n  const handleDelete = async () => {\r\n    if (!confirm('이 재생 목록을 삭제하시겠습니까?')) return\r\n\r\n    try {\r\n      await deleteMutation.mutateAsync(id!)\r\n      navigate('/video-learnings')\r\n    } catch (error) {\r\n      console.error('삭제 실패:', error)\r\n    }\r\n  }\r\n\r\n  // 🌟 핵심 배움 편집 시작\r\n  const handleStartEdit = (video: any) => {\r\n    setEditingVideoId(video._id)\r\n    setEditingContent(video.keyTakeaways || '')\r\n  }\r\n\r\n  // 🌟 핵심 배움 편집 취소\r\n  const handleCancelEdit = () => {\r\n    setEditingVideoId(null)\r\n    setEditingContent('')\r\n  }\r\n\r\n  // 🌟 핵심 배움 저장\r\n  const handleSaveEdit = async () => {\r\n    if (!editingVideoId || !activeVideo) return\r\n\r\n    try {\r\n      await updateVideoMutation.mutateAsync({\r\n        id: editingVideoId,\r\n        data: {\r\n          playlistId: id!,\r\n          videoId: activeVideo.videoId,\r\n          title: activeVideo.title,\r\n          keyTakeaways: editingContent,\r\n          order: activeVideo.order || 0,\r\n        }\r\n      })\r\n      success('저장 완료', '핵심 배움이 저장되었습니다.')\r\n      setEditingVideoId(null)\r\n      setEditingContent('')\r\n    } catch (err) {\r\n      error('저장 실패', '핵심 배움 저장 중 오류가 발생했습니다.')\r\n      console.error('핵심 배움 저장 실패:', err)\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin\"></div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (!playlist) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <FaList className=\"text-6xl text-gray-400 mx-auto mb-4\" />\r\n          <p className=\"text-xl text-gray-600 dark:text-gray-400\">재생 목록을 찾을 수 없습니다</p>\r\n          <Link \r\n            to=\"/video-learnings\" \r\n            state={location.state}\r\n            className=\"text-primary-600 hover:text-primary-700 mt-4 inline-block\"\r\n          >\r\n            목록으로 돌아가기\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <section className=\"min-h-screen bg-white dark:bg-dark-900\">\r\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n        {/* 뒤로가기 버튼 */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"mb-6\"\r\n        >\r\n          <Link\r\n            to=\"/video-learnings\"\r\n            state={location.state}\r\n            className=\"inline-flex items-center gap-2 text-primary-600 hover:text-primary-700\"\r\n          >\r\n            <FaArrowLeft /> 목록으로 돌아가기\r\n          </Link>\r\n        </motion.div>\r\n\r\n        {/* 2단 레이아웃 컨테이너 */}\r\n        <div className=\"flex flex-col lg:flex-row gap-6\">\r\n          \r\n          {/* ========== 왼쪽 영역: 플레이어 + 기본 정보 ========== */}\r\n          <div className=\"w-full lg:w-7/12 lg:sticky lg:top-8 self-start\">\r\n            \r\n            {/* 유튜브 재생 목록 플레이어 */}\r\n            {playlist.playlistId && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                className=\"mb-6\"\r\n              >\r\n                <div className=\"aspect-video rounded-xl overflow-hidden shadow-2xl bg-black relative\">\r\n                  <div \r\n                    ref={playerContainerRef}\r\n                    className=\"w-full h-full\"\r\n                  />\r\n                  {!isPlayerReady && (\r\n                    <div className=\"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-75\">\r\n                      <div className=\"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {/* 기본 정보 카드 */}\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: 0.1 }}\r\n              className=\"card p-6 mb-6\"\r\n            >\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                {/* 카테고리 배지 (복수 표시) */}\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {playlist.categoryIds && playlist.categoryIds.length > 0 ? (\r\n                    (playlist.categoryIds as any[]).map((catIdOrObj: any) => {\r\n                      const catName = typeof catIdOrObj === 'string' ? catIdOrObj : catIdOrObj?.name\r\n                      return catName ? (\r\n                        <span \r\n                          key={typeof catIdOrObj === 'string' ? catIdOrObj : catIdOrObj?._id}\r\n                          className=\"px-3 py-1 bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 rounded-full text-sm font-medium\"\r\n                        >\r\n                          {catName}\r\n                        </span>\r\n                      ) : null\r\n                    })\r\n                  ) : (\r\n                    // 호환성: categoryIds가 없으면 기존 category 표시\r\n                    playlist.category && (\r\n                      <span className=\"px-3 py-1 bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 rounded-full text-sm font-medium\">\r\n                        {playlist.category}\r\n                      </span>\r\n                    )\r\n                  )}\r\n                </div>\r\n                {isAuthenticated && (\r\n                  <div className=\"flex gap-2\">\r\n                    <Link\r\n                      to={`/admin`}\r\n                      state={{ tab: 'videoPlaylists', editId: playlist._id }}\r\n                      className=\"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-blue-600 dark:text-blue-400\"\r\n                      aria-label=\"재생 목록 수정\"\r\n                    >\r\n                      <FaEdit />\r\n                    </Link>\r\n                    <button\r\n                      onClick={handleDelete}\r\n                      disabled={deleteMutation.isPending}\r\n                      className=\"p-2 rounded-lg text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n                      aria-label=\"재생 목록 삭제\"\r\n                    >\r\n                      <FaTrash />\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\r\n                {playlist.title}\r\n              </h1>\r\n\r\n              <div className=\"flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400\">\r\n                {playlist.rating && (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    {Array.from({ length: 5 }, (_, i) => (\r\n                      <FaStar \r\n                        key={i} \r\n                        className={`text-sm ${i < playlist.rating! ? 'text-yellow-500' : 'text-gray-300 dark:text-gray-600'}`} \r\n                      />\r\n                    ))}\r\n                    <span className=\"font-medium\">{playlist.rating}/5</span>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <FaCalendar />\r\n                  <span>{formatDate(playlist.watchDate)}</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <FaList />\r\n                  <span>{playlistVideos.length}개 영상</span>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n\r\n            {/* 시청 목적 */}\r\n            {playlist.purpose && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.2 }}\r\n                className=\"card p-6 mb-6\"\r\n              >\r\n                <h3 className=\"text-lg font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2\">\r\n                  <FaBullseye className=\"text-blue-600\" /> 시청 목적\r\n                </h3>\r\n                <div className=\"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 text-sm\">\r\n                  <ReactMarkdown>{playlist.purpose}</ReactMarkdown>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {/* 통합 적용 계획 */}\r\n            {playlist.application && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.3 }}\r\n                className=\"card p-6 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-l-4 border-purple-600\"\r\n              >\r\n                <h3 className=\"text-lg font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2\">\r\n                  <FaRocket className=\"text-purple-600\" /> 통합 적용 계획\r\n                </h3>\r\n                <div className=\"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 text-sm\">\r\n                  <ReactMarkdown>{playlist.application}</ReactMarkdown>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </div>\r\n\r\n          {/* ========== 오른쪽 영역: 학습 기록 ========== */}\r\n          <div className=\"w-full lg:w-5/12 space-y-6\">\r\n\r\n            {/* 연결된 스킬 */}\r\n            {linkedSkills.length > 0 && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.2 }}\r\n                className=\"card p-6 mb-6\"\r\n              >\r\n                <h3 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\r\n                  <FaCubes className=\"text-primary-600\" /> 학습한 기술\r\n                </h3>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {linkedSkills.map(skill => (\r\n                    <div\r\n                      key={skill._id}\r\n                      className=\"inline-flex items-center px-3 py-1 rounded-lg text-sm font-medium\"\r\n                      style={{\r\n                        backgroundColor: `${skill.color}26`,\r\n                        color: skill.color,\r\n                      }}\r\n                    >\r\n                      {skill.name}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {/* 영상별 학습 기록 - 탭 형태 */}\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: 0.4 }}\r\n              className=\"card p-6\"\r\n            >\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <button\r\n              onClick={() => setShowVideoTabs(!showVideoTabs)}\r\n              className=\"flex items-center gap-2 text-xl font-bold text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors\"\r\n            >\r\n              {showVideoTabs ? <FaChevronUp /> : <FaChevronDown />}\r\n              📹 영상별 학습 기록 ({playlistVideos.length}개)\r\n            </button>\r\n          </div>\r\n          \r\n          {/* 영상 탭 버튼들 - 토글 가능 */}\r\n          {showVideoTabs && playlistVideos.length > 0 && (\r\n            <div className=\"flex flex-wrap gap-2 mb-4\">\r\n              {playlistVideos.map((video, index) => (\r\n                <button\r\n                  key={video._id}\r\n                  onClick={() => handleVideoTabClick(video, index)}\r\n                  className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n                    activeVideoTab === video._id\r\n                      ? 'bg-primary-600 text-white'\r\n                      : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n                  }`}\r\n                >\r\n                  #{index + 1} {video.title}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* 활성 영상의 학습 기록 */}\r\n          {playlistVideos.length > 0 && activeVideo ? (\r\n            <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\r\n              {/* 영상 헤더 */}\r\n              <div className=\"p-4 bg-gray-50 dark:bg-gray-800\">\r\n                <h4 className=\"font-bold text-gray-900 dark:text-white mb-1\">\r\n                  {activeVideo.title}\r\n                </h4>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                      유튜브 영상 ID: {activeVideo.videoId}\r\n                    </p>\r\n                    {activeVideo.createdAt && (\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                        기록 날짜: {formatDate(activeVideo.createdAt)}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                  {/* 🌟 편집 버튼 - 인증된 사용자에게만 표시 */}\r\n                  {isAuthenticated && editingVideoId !== activeVideo._id && (\r\n                    <button\r\n                      onClick={() => handleStartEdit(activeVideo)}\r\n                      className=\"p-1.5 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors\"\r\n                      title=\"핵심 배움 편집\"\r\n                    >\r\n                      <FaEdit className=\"text-sm\" />\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* 핵심 배움 - 읽기 모드 */}\r\n              {editingVideoId !== activeVideo._id && (\r\n                <>\r\n                  {activeVideo.keyTakeaways ? (\r\n                    <div className=\"p-4 bg-white dark:bg-gray-900\">\r\n                      <h5 className=\"text-sm font-bold text-gray-700 dark:text-gray-300 mb-3\">\r\n                        🎯 핵심 배움\r\n                      </h5>\r\n                      <div \r\n                        className=\"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 leading-relaxed\"\r\n                        dangerouslySetInnerHTML={{ \r\n                          __html: renderHtmlWithTimestamps(activeVideo.keyTakeaways)\r\n                        }}\r\n                        onClick={(e) => {\r\n                          // 타임스탬프 버튼 클릭 처리\r\n                          const target = e.target as HTMLElement\r\n                          if (target.tagName === 'BUTTON' && target.dataset['timestamp']) {\r\n                            const seconds = parseInt(target.dataset['timestamp'], 10)\r\n                            handleTimestampClick(activeVideo.videoId, seconds)\r\n                          }\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"p-4 bg-white dark:bg-gray-900 text-center text-gray-500 dark:text-gray-400\">\r\n                      <p className=\"text-sm\">이 영상의 핵심 배움이 아직 기록되지 않았습니다</p>\r\n                      {isAuthenticated && (\r\n                        <p className=\"text-xs mt-2\">위의 연필 버튼을 클릭하여 학습 기록을 추가하세요</p>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </>\r\n              )}\r\n\r\n              {/* 🌟 핵심 배움 - 편집 모드 */}\r\n              {editingVideoId === activeVideo._id && (\r\n                <div className=\"p-4 bg-white dark:bg-gray-900\">\r\n                  <h5 className=\"text-sm font-bold text-gray-700 dark:text-gray-300 mb-3\">\r\n                    ✏️ 핵심 배움 편집\r\n                  </h5>\r\n                  <RichTextEditor\r\n                    value={editingContent}\r\n                    onChange={setEditingContent}\r\n                    placeholder=\"영상을 보면서 핵심 배움을 작성하세요. 리치텍스트 에디터를 사용하여 다양한 서식을 적용할 수 있습니다.\"\r\n                    rows={8}\r\n                    className=\"min-h-[250px]\"\r\n                  />\r\n                  <div className=\"flex gap-2 mt-4\">\r\n                    <button\r\n                      onClick={handleSaveEdit}\r\n                      disabled={updateVideoMutation.isPending}\r\n                      className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm font-medium\"\r\n                    >\r\n                      <FaSave />\r\n                      {updateVideoMutation.isPending ? '저장 중...' : '저장'}\r\n                    </button>\r\n                    <button\r\n                      onClick={handleCancelEdit}\r\n                      disabled={updateVideoMutation.isPending}\r\n                      className=\"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm font-medium\"\r\n                    >\r\n                      <FaTimes />\r\n                      취소\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ) : playlistVideos.length === 0 ? (\r\n            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n              <p className=\"mb-4\">아직 등록된 영상 학습 기록이 없습니다</p>\r\n              {isAuthenticated && (\r\n                <p className=\"text-sm\">관리자 페이지의 재생 목록 수정에서 영상을 추가해주세요</p>\r\n              )}\r\n            </div>\r\n          ) : null}\r\n            </motion.div>\r\n          </div>\r\n          {/* 오른쪽 영역 끝 */}\r\n          \r\n        </div>\r\n        {/* 2단 레이아웃 컨테이너 끝 */}\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nexport default VideoPlaylistDetail\r\n\r\n"],"names":["VideoPlaylistDetail","id","useParams","navigate","useNavigate","location","useLocation","isAuthenticated","useAuth","i18n","useTranslation","language","data","playlist","isLoading","loading","useVideoPlaylist","playlistVideos","usePlaylistVideos","deleteMutation","useDeleteVideoPlaylist","updateVideoMutation","useUpdatePlaylistVideo","skillCategories","useSkills","success","error","useToastHelpers","playerRef","useRef","playerContainerRef","isPlayerReady","setIsPlayerReady","useState","activeVideoId","setActiveVideoId","activeVideoTab","setActiveVideoTab","showVideoTabs","setShowVideoTabs","editingVideoId","setEditingVideoId","editingContent","setEditingContent","useEffect","length","videoId","playlistId","window","YT","tag","document","createElement","src","firstScriptTag","getElementsByTagName","parentNode","insertBefore","initializePlayer","Player","current","playerVars","listType","list","enablejsapi","origin","rel","modestbranding","fs","cc_load_policy","iv_load_policy","showinfo","events","onReady","onYouTubeIframeAPIReady","destroy","_id","linkedSkills","useMemo","skillIds","flatMap","cat","skills","filter","skill","_a","includes","activeVideo","find","v","handleTimestampClick","targetVideoId","seconds","videoIndex","findIndex","playVideoAt","setTimeout","seekTo","playVideo","jsxRuntimeExports","jsx","className","children","jsxs","motion","div","initial","opacity","y","animate","Link","to","state","FaArrowLeft","ref","transition","delay","categoryIds","map","catIdOrObj","catName","name","category","tab","editId","FaEdit","onClick","async","confirm","mutateAsync","disabled","isPending","FaTrash","title","rating","Array","from","_","i","FaStar","FaCalendar","formatDate","watchDate","FaList","purpose","FaBullseye","ReactMarkdown","application","FaRocket","FaCubes","style","backgroundColor","color","FaChevronUp","FaChevronDown","video","index","handleVideoTabClick","createdAt","handleStartEdit","keyTakeaways","Fragment","dangerouslySetInnerHTML","__html","renderHtmlWithTimestamps","e","target","tagName","dataset","parseInt","RichTextEditor","value","onChange","placeholder","rows","order","err","FaSave","FaTimes"],"mappings":"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"}