{"version":3,"file":"VideoLearningDetail-6678ce73.js","sources":["../../src/components/VideoLearningDetail.tsx"],"sourcesContent":["import React, { useState, useMemo, useRef, useEffect } from 'react'\r\nimport { motion } from 'framer-motion'\r\nimport { useParams, Link, useNavigate, useLocation } from 'react-router-dom'\r\nimport { FaArrowLeft, FaVideo, FaStar, FaCalendar, FaEdit, FaTrash, FaCubes, FaBullseye, FaLightbulb, FaRocket, FaSave, FaTimes } from 'react-icons/fa'\r\nimport { useAuth } from '../contexts/AuthContext'\r\nimport { formatDate } from '../utils/dateUtils'\r\nimport { useVideoLearning, useDeleteVideoLearning, useUpdateVideoLearning } from '../hooks/useVideoLearnings'\r\nimport { useSkills } from '../hooks/useSkills'\r\nimport { extractYouTubeId, parseTimestamps, renderHtmlWithTimestamps } from '../utils/videoUtils'\r\nimport ReactMarkdown from 'react-markdown'\r\nimport RichTextEditor from './RichTextEditor'\r\nimport { useToastHelpers } from '../hooks/useToast'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { getLocalizedField } from '@/utils/i18nUtils'\r\n\r\n// 🌟 유튜브 IFrame Player API 타입 정의\r\ndeclare global {\r\n  interface Window {\r\n    YT: any\r\n    onYouTubeIframeAPIReady: () => void\r\n  }\r\n}\r\n\r\nconst VideoLearningDetail: React.FC = () => {\r\n  const { id } = useParams<{ id: string }>()\r\n  const navigate = useNavigate()\r\n  const location = useLocation()\r\n  const { isAuthenticated } = useAuth()\r\n  const { i18n } = useTranslation()\r\n  const currentLang = i18n.language as 'ko' | 'en' | 'ja'\r\n  \r\n  const { data: video, isLoading: loading, isError, error } = useVideoLearning(id)\r\n  const deleteMutation = useDeleteVideoLearning()\r\n  const updateMutation = useUpdateVideoLearning()\r\n  const { skillCategories } = useSkills()\r\n  const { success, error: toastError } = useToastHelpers()\r\n\r\n  // 🌟 유튜브 플레이어 ref 및 상태\r\n  const playerRef = useRef<any>(null)\r\n  const playerContainerRef = useRef<HTMLDivElement>(null)\r\n  const [isPlayerReady, setIsPlayerReady] = useState(false)\r\n  \r\n  // 🌟 핵심 배움 편집 상태\r\n  const [isEditingKeyTakeaways, setIsEditingKeyTakeaways] = useState(false)\r\n  const [editingContent, setEditingContent] = useState('')\r\n  \r\n  const videoId = useMemo(() => {\r\n    if (video?.videoId) return video.videoId\r\n    // 호환성: videoUrl이 있으면 ID 추출\r\n    if ((video as any)?.videoUrl) return extractYouTubeId((video as any).videoUrl)\r\n    return null\r\n  }, [video])\r\n  \r\n  // 🌟 유튜브 IFrame API 스크립트 로드 및 플레이어 초기화\r\n  useEffect(() => {\r\n    if (!videoId) return\r\n    \r\n    // YouTube IFrame API 스크립트 로드\r\n    if (!window.YT) {\r\n      const tag = document.createElement('script')\r\n      tag.src = 'https://www.youtube.com/iframe_api'\r\n      const firstScriptTag = document.getElementsByTagName('script')[0]\r\n      if (firstScriptTag?.parentNode) {\r\n        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag)\r\n      }\r\n    }\r\n    \r\n    // API 준비 완료 후 플레이어 초기화\r\n    const initializePlayer = () => {\r\n      if (window.YT && window.YT.Player && playerContainerRef.current) {\r\n        playerRef.current = new window.YT.Player(playerContainerRef.current, {\r\n          videoId: videoId,\r\n          playerVars: {\r\n            enablejsapi: 1,\r\n            origin: window.location.origin,\r\n            rel: 0,  // 🌟 관련 영상 추천 비활성화 (전문성 유지)\r\n            modestbranding: 1,  // 🌟 유튜브 로고 최소화 & '동영상 더보기' 툴팁 제거\r\n            fs: 1,  // 전체 화면 버튼 표시\r\n            cc_load_policy: 0,  // 자막 자동 로드 비활성화\r\n            iv_load_policy: 3,  // 🌟 영상 주석(annotations) 비활성화\r\n            showinfo: 0,  // 🌟 영상 정보 표시 최소화 (구버전 지원)\r\n            controls: 1,  // 컨트롤러 표시\r\n          },\r\n          events: {\r\n            onReady: () => {\r\n              console.log('✅ 유튜브 플레이어 준비 완료')\r\n              setIsPlayerReady(true)\r\n            },\r\n          },\r\n        })\r\n      }\r\n    }\r\n    \r\n    if (window.YT && window.YT.Player) {\r\n      initializePlayer()\r\n    } else {\r\n      window.onYouTubeIframeAPIReady = initializePlayer\r\n    }\r\n    \r\n    // cleanup\r\n    return () => {\r\n      if (playerRef.current && typeof playerRef.current.destroy === 'function') {\r\n        playerRef.current.destroy()\r\n      }\r\n    }\r\n  }, [videoId])\r\n\r\n  // 🌟 연결된 스킬 필터링\r\n  const linkedSkills = useMemo(() => {\r\n    if (!video?.skillIds || !skillCategories) return []\r\n    const allSkills = skillCategories.flatMap(cat => cat.skills || [])\r\n    return allSkills.filter(skill => skill._id && video.skillIds?.includes(skill._id))\r\n  }, [video, skillCategories])\r\n\r\n  // 🌟 타임스탬프 클릭 핸들러 (유튜브 API 사용)\r\n  const handleTimestampClick = (seconds: number) => {\r\n    console.log(`⏰ 타임스탬프 클릭: ${seconds}초로 이동 + 자동 재생`)\r\n    \r\n    if (!playerRef.current || !isPlayerReady) {\r\n      console.warn('⚠️ 플레이어가 아직 준비되지 않았습니다')\r\n      return\r\n    }\r\n    \r\n    try {\r\n      // 1. 해당 시간으로 이동 (allowSeekAhead: true)\r\n      playerRef.current.seekTo(seconds, true)\r\n      \r\n      // 2. 즉시 재생 시작\r\n      playerRef.current.playVideo()\r\n      \r\n      console.log(`✅ ${seconds}초로 이동 후 재생 시작`)\r\n    } catch (error) {\r\n      console.error('플레이어 제어 오류:', error)\r\n    }\r\n  }\r\n\r\n  // 🌟 타임스탬프가 포함된 텍스트 렌더링\r\n  const renderTextWithTimestamps = (text: string) => {\r\n    if (!text) return null\r\n    \r\n    const timestamps = parseTimestamps(text)\r\n    if (timestamps.length === 0) {\r\n      return <ReactMarkdown>{text}</ReactMarkdown>\r\n    }\r\n\r\n    const result: (string | JSX.Element)[] = []\r\n    let lastIndex = 0\r\n\r\n    timestamps.forEach((ts, idx) => {\r\n      // 타임스탬프 이전 텍스트\r\n      if (ts.position > lastIndex) {\r\n        const beforeText = text.substring(lastIndex, ts.position)\r\n        result.push(\r\n          <span key={`text-${idx}`}>\r\n            <ReactMarkdown>{beforeText}</ReactMarkdown>\r\n          </span>\r\n        )\r\n      }\r\n\r\n      // 타임스탬프 버튼\r\n      result.push(\r\n        <button\r\n          key={`ts-${idx}`}\r\n          onClick={() => handleTimestampClick(ts.seconds)}\r\n          className=\"inline-flex items-center px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded font-mono text-xs font-bold transition-colors mx-1\"\r\n          title={`영상 ${ts.text} 위치로 이동`}\r\n        >\r\n          {ts.text}\r\n        </button>\r\n      )\r\n\r\n      lastIndex = ts.position + ts.text.length\r\n    })\r\n\r\n    // 마지막 텍스트\r\n    if (lastIndex < text.length) {\r\n      const afterText = text.substring(lastIndex)\r\n      result.push(\r\n        <span key=\"text-last\">\r\n          <ReactMarkdown>{afterText}</ReactMarkdown>\r\n        </span>\r\n      )\r\n    }\r\n\r\n    return <div className=\"space-y-2\">{result}</div>\r\n  }\r\n\r\n  // 삭제 핸들러\r\n  const handleDeleteVideo = async () => {\r\n    if (!confirm('이 영상 학습 기록을 삭제하시겠습니까?')) return\r\n\r\n    try {\r\n      await deleteMutation.mutateAsync(id!)\r\n      navigate('/video-learnings')\r\n    } catch (error) {\r\n      console.error('Failed to delete video learning:', error)\r\n    }\r\n  }\r\n\r\n  // 🌟 핵심 배움 편집 시작\r\n  const handleStartEdit = () => {\r\n    setIsEditingKeyTakeaways(true)\r\n    setEditingContent(video?.keyTakeaways || '')\r\n  }\r\n\r\n  // 🌟 핵심 배움 편집 취소\r\n  const handleCancelEdit = () => {\r\n    setIsEditingKeyTakeaways(false)\r\n    setEditingContent('')\r\n  }\r\n\r\n  // 🌟 핵심 배움 저장\r\n  const handleSaveEdit = async () => {\r\n    if (!video || !id) return\r\n\r\n    try {\r\n      // 🌟 skillIds와 categoryIds를 문자열 배열로 확실하게 변환\r\n      const skillIds = (video.skillIds || []).map((skillIdOrObj: any) => \r\n        typeof skillIdOrObj === 'string' ? skillIdOrObj : skillIdOrObj?._id\r\n      ).filter(Boolean)\r\n      \r\n      const categoryIds = (video.categoryIds || []).map((catIdOrObj: any) => \r\n        typeof catIdOrObj === 'string' ? catIdOrObj : catIdOrObj?._id\r\n      ).filter(Boolean)\r\n\r\n      // VideoLearningFormData 타입에 맞게 필요한 필드만 전달\r\n      const updateData = {\r\n        title: video.title,\r\n        videoId: video.videoId,\r\n        category: video.category,\r\n        categoryIds: categoryIds,\r\n        watchDate: video.watchDate,\r\n        purpose: video.purpose,\r\n        keyTakeaways: editingContent,\r\n        application: video.application,\r\n        skillIds: skillIds,\r\n        rating: video.rating,\r\n        order: video.order,\r\n      }\r\n      \r\n      console.log('📤 전송 데이터:', updateData)\r\n      \r\n      await updateMutation.mutateAsync({\r\n        id,\r\n        data: updateData\r\n      })\r\n      success('저장 완료', '핵심 배움이 저장되었습니다.')\r\n      setIsEditingKeyTakeaways(false)\r\n      setEditingContent('')\r\n    } catch (err: any) {\r\n      console.error('핵심 배움 저장 실패:', err)\r\n      console.error('📋 서버 응답 상세:', err.response?.data)\r\n      toastError('저장 실패', err.response?.data?.message || '핵심 배움 저장 중 오류가 발생했습니다.')\r\n    }\r\n  }\r\n  \r\n  const isDeleting = deleteMutation.isPending\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin\"></div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (!video) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <FaVideo className=\"text-6xl text-gray-400 mx-auto mb-4\" />\r\n          <p className=\"text-xl text-gray-600 dark:text-gray-400\">영상 학습 기록을 찾을 수 없습니다</p>\r\n          <Link \r\n            to=\"/video-learnings\" \r\n            state={location.state}\r\n            className=\"text-primary-600 hover:text-primary-700 mt-4 inline-block\"\r\n          >\r\n            목록으로 돌아가기\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <section className=\"min-h-screen bg-white dark:bg-dark-900\">\r\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n        {/* 뒤로가기 버튼 */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"mb-6\"\r\n        >\r\n          <Link\r\n            to=\"/video-learnings\"\r\n            state={location.state}\r\n            className=\"inline-flex items-center gap-2 text-primary-600 hover:text-primary-700\"\r\n          >\r\n            <FaArrowLeft /> 목록으로 돌아가기\r\n          </Link>\r\n        </motion.div>\r\n\r\n        {/* 2단 레이아웃 컨테이너 */}\r\n        <div className=\"flex flex-col lg:flex-row gap-6\">\r\n          \r\n          {/* ========== 왼쪽 영역: 플레이어 + 기본 정보 ========== */}\r\n          <div className=\"w-full lg:w-7/12 lg:sticky lg:top-8 self-start\">\r\n            \r\n            {/* 유튜브 플레이어 */}\r\n            {videoId && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                className=\"mb-6\"\r\n              >\r\n                <div className=\"aspect-video rounded-xl overflow-hidden shadow-2xl bg-black relative\">\r\n                  <div \r\n                    ref={playerContainerRef}\r\n                    className=\"w-full h-full\"\r\n                  />\r\n                  {!isPlayerReady && (\r\n                    <div className=\"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-75\">\r\n                      <div className=\"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {/* 기본 정보 카드 */}\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: 0.1 }}\r\n              className=\"card p-6 mb-6\"\r\n            >\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                {/* 카테고리 배지 (복수 표시) */}\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {video.categoryIds && video.categoryIds.length > 0 ? (\r\n                    (video.categoryIds as any[]).map((catIdOrObj: any) => {\r\n                      const catName = typeof catIdOrObj === 'string' ? catIdOrObj : catIdOrObj?.name\r\n                      return catName ? (\r\n                        <span \r\n                          key={typeof catIdOrObj === 'string' ? catIdOrObj : catIdOrObj?._id}\r\n                          className=\"px-3 py-1 bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 rounded-full text-sm font-medium\"\r\n                        >\r\n                          {catName}\r\n                        </span>\r\n                      ) : null\r\n                    })\r\n                  ) : (\r\n                    // 호환성: categoryIds가 없으면 기존 category 표시\r\n                    video.category && (\r\n                      <span className=\"px-3 py-1 bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 rounded-full text-sm font-medium\">\r\n                        {video.category}\r\n                      </span>\r\n                    )\r\n                  )}\r\n                </div>\r\n                {isAuthenticated && (\r\n                  <div className=\"flex gap-2\">\r\n                    <Link\r\n                      to={`/admin`}\r\n                      state={{ tab: 'videoLearnings', editId: video._id }}\r\n                      className=\"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-blue-600 dark:text-blue-400\"\r\n                      aria-label=\"영상 수정\"\r\n                    >\r\n                      <FaEdit />\r\n                    </Link>\r\n                    <button\r\n                      onClick={handleDeleteVideo}\r\n                      disabled={isDeleting}\r\n                      className={`p-2 rounded-lg text-red-600 dark:text-red-400 transition-colors ${\r\n                        isDeleting \r\n                          ? 'opacity-50 cursor-not-allowed' \r\n                          : 'hover:bg-gray-100 dark:hover:bg-gray-700'\r\n                      }`}\r\n                      aria-label=\"영상 삭제\"\r\n                    >\r\n                      {isDeleting ? (\r\n                        <div className=\"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin\" />\r\n                      ) : (\r\n                        <FaTrash />\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\r\n                {video.title}\r\n              </h1>\r\n\r\n              <div className=\"flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400\">\r\n                {video.rating && (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    {Array.from({ length: 5 }, (_, i) => (\r\n                      <FaStar \r\n                        key={i} \r\n                        className={`text-sm ${i < video.rating! ? 'text-yellow-500' : 'text-gray-300 dark:text-gray-600'}`} \r\n                      />\r\n                    ))}\r\n                    <span className=\"font-medium\">{video.rating}/5</span>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <FaCalendar />\r\n                  <span>{formatDate(video.watchDate)}</span>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n\r\n            {/* 시청 목적 */}\r\n            {video.purpose && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.2 }}\r\n                className=\"card p-6 mb-6\"\r\n              >\r\n                <h3 className=\"text-lg font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2\">\r\n                  <FaBullseye className=\"text-blue-600\" /> 시청 목적\r\n                </h3>\r\n                <div className=\"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 text-sm\">\r\n                  <ReactMarkdown>{video.purpose}</ReactMarkdown>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {/* 통합 적용 계획 */}\r\n            {video.application && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.3 }}\r\n                className=\"card p-6 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-l-4 border-purple-600\"\r\n              >\r\n                <h3 className=\"text-lg font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2\">\r\n                  <FaRocket className=\"text-purple-600\" /> 적용 계획\r\n                </h3>\r\n                <div className=\"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 text-sm\">\r\n                  <ReactMarkdown>{video.application}</ReactMarkdown>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </div>\r\n\r\n          {/* ========== 오른쪽 영역: 학습 기록 ========== */}\r\n          <div className=\"w-full lg:w-5/12 space-y-6\">\r\n\r\n            {/* 연결된 스킬 */}\r\n            {linkedSkills.length > 0 && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.2 }}\r\n                className=\"card p-6\"\r\n              >\r\n                <h3 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\r\n                  <FaCubes className=\"text-primary-600\" /> 학습한 기술\r\n                </h3>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {linkedSkills.map(skill => (\r\n                    <div\r\n                      key={skill._id}\r\n                      className=\"inline-flex items-center px-3 py-1 rounded-lg text-sm font-medium\"\r\n                      style={{\r\n                        backgroundColor: `${skill.color}26`,\r\n                        color: skill.color,\r\n                      }}\r\n                    >\r\n                      {skill.name}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {/* 핵심 배움 */}\r\n            {(video.keyTakeaways || isAuthenticated) && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.3 }}\r\n                className=\"card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-l-4 border-blue-600\"\r\n              >\r\n                <div className=\"mb-4\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <h3 className=\"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                      <FaLightbulb className=\"text-yellow-500\" /> 핵심 배움\r\n                    </h3>\r\n                    {/* 🌟 편집 버튼 - 인증된 사용자에게만 표시 */}\r\n                    {isAuthenticated && !isEditingKeyTakeaways && (\r\n                      <button\r\n                        onClick={handleStartEdit}\r\n                        className=\"p-1.5 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors\"\r\n                        title=\"핵심 배움 편집\"\r\n                      >\r\n                        <FaEdit className=\"text-sm\" />\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                  {video.createdAt && (\r\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                      기록 날짜: {formatDate(video.createdAt)}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* 읽기 모드 */}\r\n                {!isEditingKeyTakeaways && (\r\n                  <>\r\n                    {video.keyTakeaways ? (\r\n                      <>\r\n                        <div \r\n                          className=\"prose dark:prose-invert max-w-none text-gray-700 dark:text-gray-300\"\r\n                          dangerouslySetInnerHTML={{ \r\n                            __html: renderHtmlWithTimestamps(video.keyTakeaways)\r\n                          }}\r\n                          onClick={(e) => {\r\n                            // 타임스탬프 버튼 클릭 처리\r\n                            const target = e.target as HTMLElement\r\n                            if (target.tagName === 'BUTTON' && target.dataset['timestamp']) {\r\n                              const seconds = parseInt(target.dataset['timestamp'], 10)\r\n                              handleTimestampClick(seconds)\r\n                            }\r\n                          }}\r\n                        />\r\n                      </>\r\n                    ) : (\r\n                      <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                        <p className=\"text-sm\">이 영상의 핵심 배움이 아직 기록되지 않았습니다</p>\r\n                        {isAuthenticated && (\r\n                          <p className=\"text-xs mt-2\">위의 연필 버튼을 클릭하여 학습 기록을 추가하세요</p>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </>\r\n                )}\r\n\r\n                {/* 🌟 편집 모드 */}\r\n                {isEditingKeyTakeaways && (\r\n                  <div>\r\n                    <RichTextEditor\r\n                      value={editingContent}\r\n                      onChange={setEditingContent}\r\n                      placeholder=\"영상을 보면서 핵심 배움을 작성하세요. 리치텍스트 에디터를 사용하여 다양한 서식을 적용할 수 있습니다.\"\r\n                      rows={8}\r\n                      className=\"min-h-[250px]\"\r\n                    />\r\n                    <div className=\"flex gap-2 mt-4\">\r\n                      <button\r\n                        onClick={handleSaveEdit}\r\n                        disabled={updateMutation.isPending}\r\n                        className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm font-medium\"\r\n                      >\r\n                        <FaSave />\r\n                        {updateMutation.isPending ? '저장 중...' : '저장'}\r\n                      </button>\r\n                      <button\r\n                        onClick={handleCancelEdit}\r\n                        disabled={updateMutation.isPending}\r\n                        className=\"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm font-medium\"\r\n                      >\r\n                        <FaTimes />\r\n                        취소\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </motion.div>\r\n            )}\r\n          </div>\r\n          {/* 오른쪽 영역 끝 */}\r\n          \r\n        </div>\r\n        {/* 2단 레이아웃 컨테이너 끝 */}\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n\r\nexport default VideoLearningDetail\r\n\r\n"],"names":["VideoLearningDetail","id","useParams","navigate","useNavigate","location","useLocation","isAuthenticated","useAuth","i18n","useTranslation","language","data","video","isLoading","loading","isError","error","useVideoLearning","deleteMutation","useDeleteVideoLearning","updateMutation","useUpdateVideoLearning","skillCategories","useSkills","success","toastError","useToastHelpers","playerRef","useRef","playerContainerRef","isPlayerReady","setIsPlayerReady","useState","isEditingKeyTakeaways","setIsEditingKeyTakeaways","editingContent","setEditingContent","videoId","useMemo","videoUrl","extractYouTubeId","useEffect","window","YT","tag","document","createElement","src","firstScriptTag","getElementsByTagName","parentNode","insertBefore","initializePlayer","Player","current","playerVars","enablejsapi","origin","rel","modestbranding","fs","cc_load_policy","iv_load_policy","showinfo","controls","events","onReady","onYouTubeIframeAPIReady","destroy","linkedSkills","skillIds","flatMap","cat","skills","filter","skill","_id","_a","includes","isDeleting","isPending","jsxRuntimeExports","jsx","className","children","jsxs","motion","div","initial","opacity","y","animate","Link","to","state","FaArrowLeft","ref","transition","delay","categoryIds","length","map","catIdOrObj","catName","name","category","tab","editId","FaEdit","onClick","async","confirm","mutateAsync","disabled","FaTrash","title","rating","Array","from","_","i","FaStar","FaCalendar","formatDate","watchDate","purpose","FaBullseye","ReactMarkdown","application","FaRocket","FaCubes","style","backgroundColor","color","keyTakeaways","FaLightbulb","createdAt","Fragment","dangerouslySetInnerHTML","__html","renderHtmlWithTimestamps","e","target","tagName","dataset","seconds","seekTo","playVideo","handleTimestampClick","parseInt","RichTextEditor","value","onChange","placeholder","rows","skillIdOrObj","Boolean","updateData","order","err","_c","_b","response","message","FaSave","FaTimes","FaVideo"],"mappings":"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"}